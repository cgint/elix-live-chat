<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <title>Ash.Resource - ash v3.5.33</title>
    <meta name="generator" content="ExDoc v0.38.2" />
    <link type="text/css" rel="stylesheet" href="dist/epub-elixir-FNUUKFP7.css" />
    <script src="dist/epub-4WIP524F.js"></script>

  </head>
  <body class="content-inner">

    <h1 id="content">Ash.Resource</h1>
<h2 id="attributes">attributes</h2><p>A section for declaring attributes on the resource.</p><h3 id="nested-dsls">Nested DSLs</h3><ul><li><a href="#attributes-attribute">attribute</a></li><li><a href="#attributes-create_timestamp">create_timestamp</a></li><li><a href="#attributes-update_timestamp">update_timestamp</a></li><li><a href="#attributes-integer_primary_key">integer_primary_key</a></li><li><a href="#attributes-uuid_primary_key">uuid_primary_key</a></li><li><a href="#attributes-uuid_v7_primary_key">uuid_v7_primary_key</a></li></ul><h3 id="examples">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">attributes</span><span class="w"> </span><span class="k" data-group-id="6376877070-1">do</span><span class="w">
  </span><span class="n">uuid_primary_key</span><span class="w"> </span><span class="ss">:id</span><span class="w">

  </span><span class="n">attribute</span><span class="w"> </span><span class="ss">:first_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="w"> </span><span class="k" data-group-id="6376877070-2">do</span><span class="w">
    </span><span class="n">allow_nil?</span><span class="w"> </span><span class="no">false</span><span class="w">
  </span><span class="k" data-group-id="6376877070-2">end</span><span class="w">

  </span><span class="n">attribute</span><span class="w"> </span><span class="ss">:last_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="w"> </span><span class="k" data-group-id="6376877070-3">do</span><span class="w">
    </span><span class="n">allow_nil?</span><span class="w"> </span><span class="no">false</span><span class="w">
  </span><span class="k" data-group-id="6376877070-3">end</span><span class="w">

  </span><span class="n">attribute</span><span class="w"> </span><span class="ss">:email</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="w"> </span><span class="k" data-group-id="6376877070-4">do</span><span class="w">
    </span><span class="n">allow_nil?</span><span class="w"> </span><span class="no">false</span><span class="w">

    </span><span class="n">constraints</span><span class="w"> </span><span class="p" data-group-id="6376877070-5">[</span><span class="w">
      </span><span class="ss">match</span><span class="p">:</span><span class="w"> </span><span class="sr">~r/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+$/</span><span class="w">
    </span><span class="p" data-group-id="6376877070-5">]</span><span class="w">
  </span><span class="k" data-group-id="6376877070-4">end</span><span class="w">

  </span><span class="n">attribute</span><span class="w"> </span><span class="ss">:type</span><span class="p">,</span><span class="w"> </span><span class="ss">:atom</span><span class="w"> </span><span class="k" data-group-id="6376877070-6">do</span><span class="w">
    </span><span class="n">constraints</span><span class="w"> </span><span class="p" data-group-id="6376877070-7">[</span><span class="w">
      </span><span class="ss">one_of</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="6376877070-8">[</span><span class="ss">:admin</span><span class="p">,</span><span class="w"> </span><span class="ss">:teacher</span><span class="p">,</span><span class="w"> </span><span class="ss">:student</span><span class="p" data-group-id="6376877070-8">]</span><span class="w">
    </span><span class="p" data-group-id="6376877070-7">]</span><span class="w">
  </span><span class="k" data-group-id="6376877070-6">end</span><span class="w">

  </span><span class="n">create_timestamp</span><span class="w"> </span><span class="ss">:inserted_at</span><span class="w">
  </span><span class="n">update_timestamp</span><span class="w"> </span><span class="ss">:updated_at</span><span class="w">
</span><span class="k" data-group-id="6376877070-1">end</span><span class="w">
</span></code></pre><h3 id="attributes-attribute">attributes.attribute</h3><pre><code class="makeup elixir" translate="no"><span class="n">attribute</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span></code></pre><p>Declares an attribute on the resource.</p><h3 id="examples-1">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">attribute</span><span class="w"> </span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="w"> </span><span class="k" data-group-id="7714366628-1">do</span><span class="w">
  </span><span class="n">allow_nil?</span><span class="w"> </span><span class="no">false</span><span class="w">
</span><span class="k" data-group-id="7714366628-1">end</span><span class="w">
</span></code></pre><h3 id="arguments">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#attributes-attribute-name" id="attributes-attribute-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the attribute.</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#attributes-attribute-type" id="attributes-attribute-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the attribute. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="options">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#attributes-attribute-constraints" id="attributes-attribute-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"></td><td style="text-align: left;">Constraints to provide to the type when casting the value. For more, see <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a>.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-description" id="attributes-attribute-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the attribute.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-sensitive?" id="attributes-attribute-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the attribute value contains sensitive information, like PII(Personally Identifiable Information). See the <a href="sensitive-data.xhtml">Sensitive Data guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-source" id="attributes-attribute-source"><code class="inline">source</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">If the field should be mapped to a different name in the data layer. Support varies by data layer.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-select_by_default?" id="attributes-attribute-select_by_default?"><code class="inline">select_by_default?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the attribute is selected by default.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-always_select?" id="attributes-attribute-always_select?"><code class="inline">always_select?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not to ensure this attribute is always selected when reading from the database, regardless of applied select statements.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-primary_key?" id="attributes-attribute-primary_key?"><code class="inline">primary_key?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether the attribute is the primary key. Composite primary key is also possible by using <code class="inline">primary_key? true</code> in more than one attribute. If primary_key? is true, allow_nil? must be false.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-allow_nil?" id="attributes-attribute-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the attribute can be set to nil. If nil value is given error is raised.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-generated?" id="attributes-attribute-generated?"><code class="inline">generated?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the value may be generated by the data layer.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-writable?" id="attributes-attribute-writable?"><code class="inline">writable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the value can be written to. Non-writable attributes can still be written with <a href="Ash.Changeset.xhtml#force_change_attribute/3"><code class="inline">Ash.Changeset.force_change_attribute/3</code></a>.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-public?" id="attributes-attribute-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the attribute should be shown over public interfaces. See the <a href="sensitive-data.xhtml">sensitive data guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-default" id="attributes-attribute-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">(-&gt; any) | mfa | any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A value to be set on all creates, unless a value is being provided already.  Note: The default value is casted according to the type's <code class="inline">Ash.Type.*</code> module, before it is saved.  For <code class="inline">:string</code>, for example, if <code class="inline">constraints: [allow_empty?: _]</code> is false, the value <code class="inline">&quot;&quot;</code> will be cast to <code class="inline">nil</code>.  See the <code class="inline">:constraints</code> option, the <code class="inline">:allow_nil?</code> option, and the relevant <code class="inline">Ash.Type.*</code> documentation.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-update_default" id="attributes-attribute-update_default"><code class="inline">update_default</code></a></td><td style="text-align: left;"><code class="inline">(-&gt; any) | mfa | any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A value to be set on all updates, unless a value is being provided already.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-filterable?" id="attributes-attribute-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean | :simple_equality</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the attribute can be referenced in filters.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-sortable?" id="attributes-attribute-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the attribute can be referenced in sorts.</td></tr><tr><td style="text-align: left;"><a href="#attributes-attribute-match_other_defaults?" id="attributes-attribute-match_other_defaults?"><code class="inline">match_other_defaults?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Ensures that other attributes that use the same &quot;lazy&quot; default (a function or an mfa), use the same default value. Has no effect unless <code class="inline">default</code> is a zero argument function.</td></tr></tbody></table><h3 id="introspection">Introspection</h3><p>Target: <a href="Ash.Resource.Attribute.xhtml"><code class="inline">Ash.Resource.Attribute</code></a></p><h3 id="attributes-create_timestamp">attributes.create_timestamp</h3><pre><code class="makeup elixir" translate="no"><span class="n">create_timestamp</span><span class="w"> </span><span class="n">name</span></code></pre><p>Declares a non-writable attribute with a create default of <code class="inline">&amp;DateTime.utc_now/0</code></p><p>Accepts all the same options as <code class="inline">d:Ash.Resource.Dsl.attributes.attribute</code>, except it sets
the following different defaults:</p><pre><code class="makeup elixir" translate="no"><span class="n">writable?</span><span class="w"> </span><span class="no">false</span><span class="w">
</span><span class="n">default</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">DateTime</span><span class="o">.</span><span class="n">utc_now</span><span class="o">/</span><span class="mi">0</span><span class="w">
</span><span class="n">match_other_defaults?</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="n">type</span><span class="w"> </span><span class="nc">Ash.Type.UTCDatetimeUsec</span><span class="w">
</span><span class="n">allow_nil?</span><span class="w"> </span><span class="no">false</span></code></pre><h3 id="examples-2">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">create_timestamp</span><span class="w"> </span><span class="ss">:inserted_at</span></code></pre><h3 id="arguments-1">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#attributes-create_timestamp-name" id="attributes-create_timestamp-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the attribute.</td></tr></tbody></table><h3 id="introspection-1">Introspection</h3><p>Target: <a href="Ash.Resource.Attribute.xhtml"><code class="inline">Ash.Resource.Attribute</code></a></p><h3 id="attributes-update_timestamp">attributes.update_timestamp</h3><pre><code class="makeup elixir" translate="no"><span class="n">update_timestamp</span><span class="w"> </span><span class="n">name</span></code></pre><p>Declares a non-writable attribute with a create and update default of <code class="inline">&amp;DateTime.utc_now/0</code></p><p>Accepts all the same options as <code class="inline">d:Ash.Resource.Dsl.attributes.attribute</code>, except it sets
the following different defaults:</p><pre><code class="makeup elixir" translate="no"><span class="n">writable?</span><span class="w"> </span><span class="no">false</span><span class="w">
</span><span class="n">default</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">DateTime</span><span class="o">.</span><span class="n">utc_now</span><span class="o">/</span><span class="mi">0</span><span class="w">
</span><span class="n">match_other_defaults?</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="n">update_default</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">DateTime</span><span class="o">.</span><span class="n">utc_now</span><span class="o">/</span><span class="mi">0</span><span class="w">
</span><span class="n">type</span><span class="w"> </span><span class="nc">Ash.Type.UTCDatetimeUsec</span><span class="w">
</span><span class="n">allow_nil?</span><span class="w"> </span><span class="no">false</span></code></pre><h3 id="examples-3">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">update_timestamp</span><span class="w"> </span><span class="ss">:updated_at</span></code></pre><h3 id="arguments-2">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#attributes-update_timestamp-name" id="attributes-update_timestamp-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the attribute.</td></tr></tbody></table><h3 id="introspection-2">Introspection</h3><p>Target: <a href="Ash.Resource.Attribute.xhtml"><code class="inline">Ash.Resource.Attribute</code></a></p><h3 id="attributes-integer_primary_key">attributes.integer_primary_key</h3><pre><code class="makeup elixir" translate="no"><span class="n">integer_primary_key</span><span class="w"> </span><span class="n">name</span></code></pre><p>Declares a generated, non writable, non-nil, primary key column of type integer.</p><p>Generated integer primary keys must be supported by the data layer.</p><p>Accepts all the same options as <code class="inline">d:Ash.Resource.Dsl.attributes.attribute</code>, except for <code class="inline">allow_nil?</code>, but it sets
the following different defaults:</p><pre><code class="makeup elixir" translate="no"><span class="n">public?</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="n">writable?</span><span class="w"> </span><span class="no">false</span><span class="w">
</span><span class="n">primary_key?</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="n">generated?</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="n">type</span><span class="w"> </span><span class="ss">:integer</span></code></pre><h3 id="examples-4">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">integer_primary_key</span><span class="w"> </span><span class="ss">:id</span></code></pre><h3 id="arguments-3">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#attributes-integer_primary_key-name" id="attributes-integer_primary_key-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the attribute.</td></tr></tbody></table><h3 id="introspection-3">Introspection</h3><p>Target: <a href="Ash.Resource.Attribute.xhtml"><code class="inline">Ash.Resource.Attribute</code></a></p><h3 id="attributes-uuid_primary_key">attributes.uuid_primary_key</h3><pre><code class="makeup elixir" translate="no"><span class="n">uuid_primary_key</span><span class="w"> </span><span class="n">name</span></code></pre><p>Declares a non writable, non-nil, primary key column of type <code class="inline">uuid</code>, which defaults to <a href="Ash.UUID.xhtml#generate/0"><code class="inline">Ash.UUID.generate/0</code></a>.</p><p>Accepts all the same options as <code class="inline">d:Ash.Resource.Dsl.attributes.attribute</code>, except for <code class="inline">allow_nil?</code>, but it sets
the following different defaults:</p><pre><code class="makeup elixir" translate="no"><span class="n">writable?</span><span class="w"> </span><span class="no">false</span><span class="w">
</span><span class="n">public?</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="n">default</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">Ash.UUID</span><span class="o">.</span><span class="n">generate</span><span class="o">/</span><span class="mi">0</span><span class="w">
</span><span class="n">primary_key?</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="n">type</span><span class="w"> </span><span class="ss">:uuid</span></code></pre><h3 id="examples-5">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">uuid_primary_key</span><span class="w"> </span><span class="ss">:id</span></code></pre><h3 id="arguments-4">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#attributes-uuid_primary_key-name" id="attributes-uuid_primary_key-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the attribute.</td></tr></tbody></table><h3 id="introspection-4">Introspection</h3><p>Target: <a href="Ash.Resource.Attribute.xhtml"><code class="inline">Ash.Resource.Attribute</code></a></p><h3 id="attributes-uuid_v7_primary_key">attributes.uuid_v7_primary_key</h3><pre><code class="makeup elixir" translate="no"><span class="n">uuid_v7_primary_key</span><span class="w"> </span><span class="n">name</span></code></pre><p>Declares a non writable, non-nil, primary key column of type <code class="inline">uuid_v7</code>, which defaults to <a href="Ash.UUIDv7.xhtml#generate/0"><code class="inline">Ash.UUIDv7.generate/0</code></a>.</p><p>Accepts all the same options as <code class="inline">d:Ash.Resource.Dsl.attributes.attribute</code>, except for <code class="inline">allow_nil?</code>, but it sets
the following different defaults:</p><pre><code class="makeup elixir" translate="no"><span class="n">writable?</span><span class="w"> </span><span class="no">false</span><span class="w">
</span><span class="n">public?</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="n">default</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">Ash.UUIDv7</span><span class="o">.</span><span class="n">generate</span><span class="o">/</span><span class="mi">0</span><span class="w">
</span><span class="n">primary_key?</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="n">type</span><span class="w"> </span><span class="ss">:uuid_v7</span></code></pre><h3 id="examples-6">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">uuid_v7_primary_key</span><span class="w"> </span><span class="ss">:id</span></code></pre><h3 id="arguments-5">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#attributes-uuid_v7_primary_key-name" id="attributes-uuid_v7_primary_key-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the attribute.</td></tr></tbody></table><h3 id="introspection-5">Introspection</h3><p>Target: <a href="Ash.Resource.Attribute.xhtml"><code class="inline">Ash.Resource.Attribute</code></a></p><h2 id="relationships">relationships</h2><p>A section for declaring relationships on the resource.</p><p>Relationships are a core component of resource oriented design. Many components of Ash
will use these relationships. A simple use case is loading relationships (done via the <a href="Ash.Query.xhtml#load/2"><code class="inline">Ash.Query.load/2</code></a>).</p><p>See the <a href="relationships.xhtml">relationships guide</a> for more.</p><h3 id="nested-dsls-1">Nested DSLs</h3><ul><li><a href="#relationships-has_one">has_one</a><ul><li>filter</li></ul></li><li><a href="#relationships-has_many">has_many</a><ul><li>filter</li></ul></li><li><a href="#relationships-many_to_many">many_to_many</a><ul><li>filter</li></ul></li><li><a href="#relationships-belongs_to">belongs_to</a><ul><li>filter</li></ul></li></ul><h3 id="examples-7">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">relationships</span><span class="w"> </span><span class="k" data-group-id="1631905108-1">do</span><span class="w">
  </span><span class="n">belongs_to</span><span class="w"> </span><span class="ss">:post</span><span class="p">,</span><span class="w"> </span><span class="nc">MyApp.Post</span><span class="w"> </span><span class="k" data-group-id="1631905108-2">do</span><span class="w">
    </span><span class="n">primary_key?</span><span class="w"> </span><span class="no">true</span><span class="w">
  </span><span class="k" data-group-id="1631905108-2">end</span><span class="w">

  </span><span class="n">belongs_to</span><span class="w"> </span><span class="ss">:category</span><span class="p">,</span><span class="w"> </span><span class="nc">MyApp.Category</span><span class="w"> </span><span class="k" data-group-id="1631905108-3">do</span><span class="w">
    </span><span class="n">primary_key?</span><span class="w"> </span><span class="no">true</span><span class="w">
  </span><span class="k" data-group-id="1631905108-3">end</span><span class="w">
</span><span class="k" data-group-id="1631905108-1">end</span><span class="w">
</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">relationships</span><span class="w"> </span><span class="k" data-group-id="3392627006-1">do</span><span class="w">
  </span><span class="n">belongs_to</span><span class="w"> </span><span class="ss">:author</span><span class="p">,</span><span class="w"> </span><span class="nc">MyApp.Author</span><span class="w">

  </span><span class="n">many_to_many</span><span class="w"> </span><span class="ss">:categories</span><span class="p">,</span><span class="w"> </span><span class="nc">MyApp.Category</span><span class="w"> </span><span class="k" data-group-id="3392627006-2">do</span><span class="w">
    </span><span class="n">through</span><span class="w"> </span><span class="nc">MyApp.PostCategory</span><span class="w">
    </span><span class="n">destination_attribute_on_join_resource</span><span class="w"> </span><span class="ss">:category_id</span><span class="w">
    </span><span class="n">source_attribute_on_join_resource</span><span class="w"> </span><span class="ss">:post_id</span><span class="w">
  </span><span class="k" data-group-id="3392627006-2">end</span><span class="w">
</span><span class="k" data-group-id="3392627006-1">end</span><span class="w">
</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">relationships</span><span class="w"> </span><span class="k" data-group-id="1727647869-1">do</span><span class="w">
  </span><span class="n">has_many</span><span class="w"> </span><span class="ss">:posts</span><span class="p">,</span><span class="w"> </span><span class="nc">MyApp.Post</span><span class="w"> </span><span class="k" data-group-id="1727647869-2">do</span><span class="w">
    </span><span class="n">destination_attribute</span><span class="w"> </span><span class="ss">:author_id</span><span class="w">
  </span><span class="k" data-group-id="1727647869-2">end</span><span class="w">

  </span><span class="n">has_many</span><span class="w"> </span><span class="ss">:composite_key_posts</span><span class="p">,</span><span class="w"> </span><span class="nc">MyApp.CompositeKeyPost</span><span class="w"> </span><span class="k" data-group-id="1727647869-3">do</span><span class="w">
    </span><span class="n">destination_attribute</span><span class="w"> </span><span class="ss">:author_id</span><span class="w">
  </span><span class="k" data-group-id="1727647869-3">end</span><span class="w">
</span><span class="k" data-group-id="1727647869-1">end</span><span class="w">
</span></code></pre><h3 id="relationships-has_one">relationships.has_one</h3><pre><code class="makeup elixir" translate="no"><span class="n">has_one</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span></code></pre><p>Declares a <code class="inline">has_one</code> relationship. In a relational database, the foreign key would be on the <em>other</em> table.</p><p>Generally speaking, a <code class="inline">has_one</code> also implies that the destination table is unique on that foreign key.</p><p>See the <a href="relationships.xhtml">relationships guide</a> for more.</p><h3 id="nested-dsls-2">Nested DSLs</h3><ul><li><a href="#relationships-has_one-filter">filter</a></li></ul><h3 id="examples-8">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="c1"># In a resource called `Word`</span><span class="w">
</span><span class="n">has_one</span><span class="w"> </span><span class="ss">:dictionary_entry</span><span class="p">,</span><span class="w"> </span><span class="nc">DictionaryEntry</span><span class="w"> </span><span class="k" data-group-id="3788624683-1">do</span><span class="w">
  </span><span class="n">source_attribute</span><span class="w"> </span><span class="ss">:text</span><span class="w">
  </span><span class="n">destination_attribute</span><span class="w"> </span><span class="ss">:word_text</span><span class="w">
</span><span class="k" data-group-id="3788624683-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-6">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#relationships-has_one-name" id="relationships-has_one-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the relationship</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-destination" id="relationships-has_one-destination"><code class="inline">destination</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The destination resource</td></tr></tbody></table><h3 id="options-1">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#relationships-has_one-manual" id="relationships-has_one-manual"><code class="inline">manual</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">A module that implements <a href="Ash.Resource.ManualRelationship.xhtml"><code class="inline">Ash.Resource.ManualRelationship</code></a>. Also accepts a 2 argument function that takes the source records and the context.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-no_attributes?" id="relationships-has_one-no_attributes?"><code class="inline">no_attributes?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"></td><td style="text-align: left;">All existing entities are considered related, i.e this relationship is not based on any fields, and <code class="inline">source_attribute</code> and <code class="inline">destination_attribute</code> are ignored. See the See the <a href="relationships.xhtml">relationships guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-allow_nil?" id="relationships-has_one-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Marks the relationship as required. Has no effect on validations, but can inform extensions that there will always be a related entity.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-from_many?" id="relationships-has_one-from_many?"><code class="inline">from_many?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Signal that this relationship is actually a <code class="inline">has_many</code> where the first record is given via the <code class="inline">sort</code>. This will allow data layers to properly deduplicate when necessary.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-description" id="relationships-has_one-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the relationship</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-destination_attribute" id="relationships-has_one-destination_attribute"><code class="inline">destination_attribute</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The attribute on the related resource that should match the <code class="inline">source_attribute</code> configured on this resource.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-validate_destination_attribute?" id="relationships-has_one-validate_destination_attribute?"><code class="inline">validate_destination_attribute?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not to validate that the destination field exists on the destination resource</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-source_attribute" id="relationships-has_one-source_attribute"><code class="inline">source_attribute</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"><code class="inline">:id</code></td><td style="text-align: left;">The field on this resource that should match the <code class="inline">destination_attribute</code> on the related resource.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-relationship_context" id="relationships-has_one-relationship_context"><code class="inline">relationship_context</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">Context to be set on any queries or changesets generated for managing or querying this relationship.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-public?" id="relationships-has_one-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the relationship will appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-not_found_message" id="relationships-has_one-not_found_message"><code class="inline">not_found_message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">A message to show if there is a conflict with this relationship in the database on update or create, or when managing relationships.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-writable?" id="relationships-has_one-writable?"><code class="inline">writable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the relationship may be managed.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-read_action" id="relationships-has_one-read_action"><code class="inline">read_action</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The read action on the destination resource to use when loading data and filtering.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-domain" id="relationships-has_one-domain"><code class="inline">domain</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The domain module to use when working with the related entity.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-filterable?" id="relationships-has_one-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">If set to <code class="inline">false</code>, the relationship will not be usable in filters.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-sortable?" id="relationships-has_one-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">If set to <code class="inline">false</code>, the relationship will not be usable in sorts.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-sort" id="relationships-has_one-sort"><code class="inline">sort</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A sort statement to be applied when loading the relationship.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-default_sort" id="relationships-has_one-default_sort"><code class="inline">default_sort</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default sort statement to be applied when loading the relationship.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-could_be_related_at_creation?" id="relationships-has_one-could_be_related_at_creation?"><code class="inline">could_be_related_at_creation?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not related values may exist for this relationship at creation.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-violation_message" id="relationships-has_one-violation_message"><code class="inline">violation_message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">A message to show if there is a conflict with this relationship in the database on destroy.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-authorize_read_with" id="relationships-has_one-authorize_read_with"><code class="inline">authorize_read_with</code></a></td><td style="text-align: left;"><code class="inline">:error | :filter</code></td><td style="text-align: left;"></td><td style="text-align: left;">If set to <code class="inline">:error</code>, any authorization filter added to the relationship will result in an error if any record matches the filter in the database.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_one-allow_forbidden_field?" id="relationships-has_one-allow_forbidden_field?"><code class="inline">allow_forbidden_field?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If set to <code class="inline">true</code>, the relationship will be set to <code class="inline">%Ash.ForbiddenField{}</code> if its query produces a forbidden error.</td></tr></tbody></table><h3 id="relationships-has_one-filter">relationships.has_one.filter</h3><pre><code class="makeup elixir" translate="no"><span class="n">filter</span><span class="w"> </span><span class="n">filter</span></code></pre><p>Applies a filter. Can use <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^arg/1</code></a>, <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^context/1</code></a> and <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^actor/1</code></a> templates. Multiple filters are combined with <em>and</em>.</p><h3 id="examples-9">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">filter</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="2462014151-1">(</span><span class="n">first_name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;fred&quot;</span><span class="p" data-group-id="2462014151-1">)</span><span class="w">
</span><span class="n">filter</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="2462014151-2">(</span><span class="n">last_name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;weasley&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">magician</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="2462014151-2">)</span><span class="w">
</span></code></pre><h3 id="arguments-7">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#relationships-has_one-filter-filter" id="relationships-has_one-filter-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The filter to apply. Can use <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^arg/1</code></a>, <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^context/1</code></a> and <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^actor/1</code></a> templates. Multiple filters are combined with <em>and</em>.</td></tr></tbody></table><h3 id="introspection-6">Introspection</h3><p>Target: <a href="Ash.Resource.Dsl.Filter.xhtml"><code class="inline">Ash.Resource.Dsl.Filter</code></a></p><h3 id="introspection-7">Introspection</h3><p>Target: <a href="Ash.Resource.Relationships.HasOne.xhtml"><code class="inline">Ash.Resource.Relationships.HasOne</code></a></p><h3 id="relationships-has_many">relationships.has_many</h3><pre><code class="makeup elixir" translate="no"><span class="n">has_many</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span></code></pre><p>Declares a <code class="inline">has_many</code> relationship. There can be any number of related entities.</p><p>See the <a href="relationships.xhtml">relationships guide</a> for more.</p><h3 id="nested-dsls-3">Nested DSLs</h3><ul><li><a href="#relationships-has_many-filter">filter</a></li></ul><h3 id="examples-10">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="c1"># In a resource called `Word`</span><span class="w">
</span><span class="n">has_many</span><span class="w"> </span><span class="ss">:definitions</span><span class="p">,</span><span class="w"> </span><span class="nc">DictionaryDefinition</span><span class="w"> </span><span class="k" data-group-id="9720123527-1">do</span><span class="w">
  </span><span class="n">source_attribute</span><span class="w"> </span><span class="ss">:text</span><span class="w">
  </span><span class="n">destination_attribute</span><span class="w"> </span><span class="ss">:word_text</span><span class="w">
</span><span class="k" data-group-id="9720123527-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-8">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#relationships-has_many-name" id="relationships-has_many-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the relationship</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-destination" id="relationships-has_many-destination"><code class="inline">destination</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The destination resource</td></tr></tbody></table><h3 id="options-2">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#relationships-has_many-manual" id="relationships-has_many-manual"><code class="inline">manual</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">A module that implements <a href="Ash.Resource.ManualRelationship.xhtml"><code class="inline">Ash.Resource.ManualRelationship</code></a>. Also accepts a 2 argument function that takes the source records and the context.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-no_attributes?" id="relationships-has_many-no_attributes?"><code class="inline">no_attributes?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"></td><td style="text-align: left;">All existing entities are considered related, i.e this relationship is not based on any fields, and <code class="inline">source_attribute</code> and <code class="inline">destination_attribute</code> are ignored. See the See the <a href="relationships.xhtml">relationships guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-limit" id="relationships-has_many-limit"><code class="inline">limit</code></a></td><td style="text-align: left;"><code class="inline">integer</code></td><td style="text-align: left;"></td><td style="text-align: left;">An integer to limit entries from loaded relationship.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-description" id="relationships-has_many-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the relationship</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-destination_attribute" id="relationships-has_many-destination_attribute"><code class="inline">destination_attribute</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The attribute on the related resource that should match the <code class="inline">source_attribute</code> configured on this resource.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-validate_destination_attribute?" id="relationships-has_many-validate_destination_attribute?"><code class="inline">validate_destination_attribute?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not to validate that the destination field exists on the destination resource</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-source_attribute" id="relationships-has_many-source_attribute"><code class="inline">source_attribute</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"><code class="inline">:id</code></td><td style="text-align: left;">The field on this resource that should match the <code class="inline">destination_attribute</code> on the related resource.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-relationship_context" id="relationships-has_many-relationship_context"><code class="inline">relationship_context</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">Context to be set on any queries or changesets generated for managing or querying this relationship.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-public?" id="relationships-has_many-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the relationship will appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-not_found_message" id="relationships-has_many-not_found_message"><code class="inline">not_found_message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">A message to show if there is a conflict with this relationship in the database on update or create, or when managing relationships.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-writable?" id="relationships-has_many-writable?"><code class="inline">writable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the relationship may be managed.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-read_action" id="relationships-has_many-read_action"><code class="inline">read_action</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The read action on the destination resource to use when loading data and filtering.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-domain" id="relationships-has_many-domain"><code class="inline">domain</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The domain module to use when working with the related entity.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-filterable?" id="relationships-has_many-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">If set to <code class="inline">false</code>, the relationship will not be usable in filters.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-sortable?" id="relationships-has_many-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">If set to <code class="inline">false</code>, the relationship will not be usable in sorts.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-sort" id="relationships-has_many-sort"><code class="inline">sort</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A sort statement to be applied when loading the relationship.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-default_sort" id="relationships-has_many-default_sort"><code class="inline">default_sort</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default sort statement to be applied when loading the relationship.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-could_be_related_at_creation?" id="relationships-has_many-could_be_related_at_creation?"><code class="inline">could_be_related_at_creation?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not related values may exist for this relationship at creation.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-violation_message" id="relationships-has_many-violation_message"><code class="inline">violation_message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">A message to show if there is a conflict with this relationship in the database on destroy.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-authorize_read_with" id="relationships-has_many-authorize_read_with"><code class="inline">authorize_read_with</code></a></td><td style="text-align: left;"><code class="inline">:error | :filter</code></td><td style="text-align: left;"></td><td style="text-align: left;">If set to <code class="inline">:error</code>, any authorization filter added to the relationship will result in an error if any record matches the filter in the database.</td></tr><tr><td style="text-align: left;"><a href="#relationships-has_many-allow_forbidden_field?" id="relationships-has_many-allow_forbidden_field?"><code class="inline">allow_forbidden_field?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If set to <code class="inline">true</code>, the relationship will be set to <code class="inline">%Ash.ForbiddenField{}</code> if its query produces a forbidden error.</td></tr></tbody></table><h3 id="relationships-has_many-filter">relationships.has_many.filter</h3><pre><code class="makeup elixir" translate="no"><span class="n">filter</span><span class="w"> </span><span class="n">filter</span></code></pre><p>Applies a filter. Can use <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^arg/1</code></a>, <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^context/1</code></a> and <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^actor/1</code></a> templates. Multiple filters are combined with <em>and</em>.</p><h3 id="examples-11">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">filter</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="7352713697-1">(</span><span class="n">first_name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;fred&quot;</span><span class="p" data-group-id="7352713697-1">)</span><span class="w">
</span><span class="n">filter</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="7352713697-2">(</span><span class="n">last_name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;weasley&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">magician</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="7352713697-2">)</span><span class="w">
</span></code></pre><h3 id="arguments-9">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#relationships-has_many-filter-filter" id="relationships-has_many-filter-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The filter to apply. Can use <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^arg/1</code></a>, <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^context/1</code></a> and <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^actor/1</code></a> templates. Multiple filters are combined with <em>and</em>.</td></tr></tbody></table><h3 id="introspection-8">Introspection</h3><p>Target: <a href="Ash.Resource.Dsl.Filter.xhtml"><code class="inline">Ash.Resource.Dsl.Filter</code></a></p><h3 id="introspection-9">Introspection</h3><p>Target: <a href="Ash.Resource.Relationships.HasMany.xhtml"><code class="inline">Ash.Resource.Relationships.HasMany</code></a></p><h3 id="relationships-many_to_many">relationships.many_to_many</h3><pre><code class="makeup elixir" translate="no"><span class="n">many_to_many</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span></code></pre><p>Declares a <code class="inline">many_to_many</code> relationship. Many to many relationships require a join resource.</p><p>A join resource is a resource that consists of a relationship to the source and destination of the many to many.</p><p>See the <a href="relationships.xhtml">relationships guide</a> for more.</p><h3 id="nested-dsls-4">Nested DSLs</h3><ul><li><a href="#relationships-many_to_many-filter">filter</a></li></ul><h3 id="examples-12">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="c1"># In a resource called `Word`</span><span class="w">
</span><span class="n">many_to_many</span><span class="w"> </span><span class="ss">:books</span><span class="p">,</span><span class="w"> </span><span class="nc">Book</span><span class="w"> </span><span class="k" data-group-id="3126637839-1">do</span><span class="w">
  </span><span class="n">through</span><span class="w"> </span><span class="nc">BookWord</span><span class="w">
  </span><span class="n">source_attribute</span><span class="w"> </span><span class="ss">:text</span><span class="w">
  </span><span class="n">source_attribute_on_join_resource</span><span class="w"> </span><span class="ss">:word_text</span><span class="w">
  </span><span class="n">destination_attribute</span><span class="w"> </span><span class="ss">:id</span><span class="w">
  </span><span class="n">destination_attribute_on_join_resource</span><span class="w"> </span><span class="ss">:book_id</span><span class="w">
</span><span class="k" data-group-id="3126637839-1">end</span><span class="w">

</span><span class="c1"># And in `BookWord` (the join resource)</span><span class="w">
</span><span class="n">belongs_to</span><span class="w"> </span><span class="ss">:book</span><span class="p">,</span><span class="w"> </span><span class="nc">Book</span><span class="p">,</span><span class="w"> </span><span class="ss">primary_key?</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w"> </span><span class="ss">allow_nil?</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
</span><span class="n">belongs_to</span><span class="w"> </span><span class="ss">:word</span><span class="p">,</span><span class="w"> </span><span class="nc">Word</span><span class="p">,</span><span class="w"> </span><span class="ss">primary_key?</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w"> </span><span class="ss">allow_nil?</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
</span></code></pre><h3 id="arguments-10">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#relationships-many_to_many-name" id="relationships-many_to_many-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the relationship</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-destination" id="relationships-many_to_many-destination"><code class="inline">destination</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The destination resource</td></tr></tbody></table><h3 id="options-3">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#relationships-many_to_many-source_attribute_on_join_resource" id="relationships-many_to_many-source_attribute_on_join_resource"><code class="inline">source_attribute_on_join_resource</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The attribute on the join resource that should line up with <code class="inline">source_attribute</code> on this resource. Defaults to <code class="inline">&lt;snake_cased_last_part_of_source_module_name&gt;_id</code>.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-destination_attribute_on_join_resource" id="relationships-many_to_many-destination_attribute_on_join_resource"><code class="inline">destination_attribute_on_join_resource</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The attribute on the join resource that should line up with <code class="inline">destination_attribute</code> on the related resource. Defaults to <code class="inline">&lt;snake_cased_last_part_of_destination_module_name&gt;_id</code>.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-through" id="relationships-many_to_many-through"><code class="inline">through</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The resource to use as the join resource.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-join_relationship" id="relationships-many_to_many-join_relationship"><code class="inline">join_relationship</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The has_many relationship to the join resource. Defaults to <code class="inline">&lt;relationship_name&gt;_join_assoc</code>.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-description" id="relationships-many_to_many-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the relationship</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-destination_attribute" id="relationships-many_to_many-destination_attribute"><code class="inline">destination_attribute</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"><code class="inline">:id</code></td><td style="text-align: left;">The attribute on the related resource that should match the <code class="inline">source_attribute</code> configured on this resource.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-validate_destination_attribute?" id="relationships-many_to_many-validate_destination_attribute?"><code class="inline">validate_destination_attribute?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not to validate that the destination field exists on the destination resource</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-source_attribute" id="relationships-many_to_many-source_attribute"><code class="inline">source_attribute</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"><code class="inline">:id</code></td><td style="text-align: left;">The field on this resource that should match the <code class="inline">destination_attribute</code> on the related resource.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-relationship_context" id="relationships-many_to_many-relationship_context"><code class="inline">relationship_context</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">Context to be set on any queries or changesets generated for managing or querying this relationship.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-public?" id="relationships-many_to_many-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the relationship will appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-not_found_message" id="relationships-many_to_many-not_found_message"><code class="inline">not_found_message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">A message to show if there is a conflict with this relationship in the database on update or create, or when managing relationships.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-writable?" id="relationships-many_to_many-writable?"><code class="inline">writable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the relationship may be managed.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-read_action" id="relationships-many_to_many-read_action"><code class="inline">read_action</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The read action on the destination resource to use when loading data and filtering.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-domain" id="relationships-many_to_many-domain"><code class="inline">domain</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The domain module to use when working with the related entity.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-filterable?" id="relationships-many_to_many-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">If set to <code class="inline">false</code>, the relationship will not be usable in filters.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-sortable?" id="relationships-many_to_many-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">If set to <code class="inline">false</code>, the relationship will not be usable in sorts.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-sort" id="relationships-many_to_many-sort"><code class="inline">sort</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A sort statement to be applied when loading the relationship.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-default_sort" id="relationships-many_to_many-default_sort"><code class="inline">default_sort</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default sort statement to be applied when loading the relationship.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-could_be_related_at_creation?" id="relationships-many_to_many-could_be_related_at_creation?"><code class="inline">could_be_related_at_creation?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not related values may exist for this relationship at creation.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-violation_message" id="relationships-many_to_many-violation_message"><code class="inline">violation_message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">A message to show if there is a conflict with this relationship in the database on destroy.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-authorize_read_with" id="relationships-many_to_many-authorize_read_with"><code class="inline">authorize_read_with</code></a></td><td style="text-align: left;"><code class="inline">:error | :filter</code></td><td style="text-align: left;"></td><td style="text-align: left;">If set to <code class="inline">:error</code>, any authorization filter added to the relationship will result in an error if any record matches the filter in the database.</td></tr><tr><td style="text-align: left;"><a href="#relationships-many_to_many-allow_forbidden_field?" id="relationships-many_to_many-allow_forbidden_field?"><code class="inline">allow_forbidden_field?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If set to <code class="inline">true</code>, the relationship will be set to <code class="inline">%Ash.ForbiddenField{}</code> if its query produces a forbidden error.</td></tr></tbody></table><h3 id="relationships-many_to_many-filter">relationships.many_to_many.filter</h3><pre><code class="makeup elixir" translate="no"><span class="n">filter</span><span class="w"> </span><span class="n">filter</span></code></pre><p>Applies a filter. Can use <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^arg/1</code></a>, <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^context/1</code></a> and <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^actor/1</code></a> templates. Multiple filters are combined with <em>and</em>.</p><h3 id="examples-13">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">filter</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="9519642559-1">(</span><span class="n">first_name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;fred&quot;</span><span class="p" data-group-id="9519642559-1">)</span><span class="w">
</span><span class="n">filter</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="9519642559-2">(</span><span class="n">last_name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;weasley&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">magician</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="9519642559-2">)</span><span class="w">
</span></code></pre><h3 id="arguments-11">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#relationships-many_to_many-filter-filter" id="relationships-many_to_many-filter-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The filter to apply. Can use <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^arg/1</code></a>, <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^context/1</code></a> and <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^actor/1</code></a> templates. Multiple filters are combined with <em>and</em>.</td></tr></tbody></table><h3 id="introspection-10">Introspection</h3><p>Target: <a href="Ash.Resource.Dsl.Filter.xhtml"><code class="inline">Ash.Resource.Dsl.Filter</code></a></p><h3 id="introspection-11">Introspection</h3><p>Target: <a href="Ash.Resource.Relationships.ManyToMany.xhtml"><code class="inline">Ash.Resource.Relationships.ManyToMany</code></a></p><h3 id="relationships-belongs_to">relationships.belongs_to</h3><pre><code class="makeup elixir" translate="no"><span class="n">belongs_to</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">destination</span></code></pre><p>Declares a <code class="inline">belongs_to</code> relationship. In a relational database, the foreign key would be on the <em>source</em> table.</p><p>This creates a field on the resource with the corresponding name and type, unless <code class="inline">define_attribute?: false</code> is provided.</p><p>See the <a href="relationships.xhtml">relationships guide</a> for more.</p><h3 id="nested-dsls-5">Nested DSLs</h3><ul><li><a href="#relationships-belongs_to-filter">filter</a></li></ul><h3 id="examples-14">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="c1"># In a resource called `Word`</span><span class="w">
</span><span class="n">belongs_to</span><span class="w"> </span><span class="ss">:dictionary_entry</span><span class="p">,</span><span class="w"> </span><span class="nc">DictionaryEntry</span><span class="w"> </span><span class="k" data-group-id="6997296937-1">do</span><span class="w">
  </span><span class="n">source_attribute</span><span class="w"> </span><span class="ss">:text</span><span class="p">,</span><span class="w">
  </span><span class="n">destination_attribute</span><span class="w"> </span><span class="ss">:word_text</span><span class="w">
</span><span class="k" data-group-id="6997296937-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-12">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#relationships-belongs_to-name" id="relationships-belongs_to-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the relationship</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-destination" id="relationships-belongs_to-destination"><code class="inline">destination</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The destination resource</td></tr></tbody></table><h3 id="options-4">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#relationships-belongs_to-primary_key?" id="relationships-belongs_to-primary_key?"><code class="inline">primary_key?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether the generated attribute is, or is part of, the primary key of a resource.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-allow_nil?" id="relationships-belongs_to-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether this relationship must always be present, e.g: must be included on creation, and never removed (it may be modified). The generated attribute will not allow nil values.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-attribute_writable?" id="relationships-belongs_to-attribute_writable?"><code class="inline">attribute_writable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"></td><td style="text-align: left;">Whether the generated attribute will be marked as writable. If not set, it will default to the relationship's <code class="inline">writable?</code> setting.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-attribute_public?" id="relationships-belongs_to-attribute_public?"><code class="inline">attribute_public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"></td><td style="text-align: left;">Whether or not the generated attribute will be public. If not set, it will default to the relationship's <code class="inline">public?</code> setting.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-define_attribute?" id="relationships-belongs_to-define_attribute?"><code class="inline">define_attribute?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">If set to <code class="inline">false</code> an attribute is not created on the resource for this relationship, and one must be manually added in <code class="inline">attributes</code>, invalidating many other options.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-attribute_type" id="relationships-belongs_to-attribute_type"><code class="inline">attribute_type</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"><code class="inline">:uuid</code></td><td style="text-align: left;">The type of the generated created attribute. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-description" id="relationships-belongs_to-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the relationship</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-destination_attribute" id="relationships-belongs_to-destination_attribute"><code class="inline">destination_attribute</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"><code class="inline">:id</code></td><td style="text-align: left;">The attribute on the related resource that should match the <code class="inline">source_attribute</code> configured on this resource.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-validate_destination_attribute?" id="relationships-belongs_to-validate_destination_attribute?"><code class="inline">validate_destination_attribute?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not to validate that the destination field exists on the destination resource</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-source_attribute" id="relationships-belongs_to-source_attribute"><code class="inline">source_attribute</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field on this resource that should match the <code class="inline">destination_attribute</code> on the related resource. - Defaults to &lt;name&gt;_id</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-relationship_context" id="relationships-belongs_to-relationship_context"><code class="inline">relationship_context</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">Context to be set on any queries or changesets generated for managing or querying this relationship.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-public?" id="relationships-belongs_to-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the relationship will appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-not_found_message" id="relationships-belongs_to-not_found_message"><code class="inline">not_found_message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">A message to show if there is a conflict with this relationship in the database on update or create, or when managing relationships.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-writable?" id="relationships-belongs_to-writable?"><code class="inline">writable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the relationship may be managed.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-read_action" id="relationships-belongs_to-read_action"><code class="inline">read_action</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The read action on the destination resource to use when loading data and filtering.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-domain" id="relationships-belongs_to-domain"><code class="inline">domain</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The domain module to use when working with the related entity.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-filterable?" id="relationships-belongs_to-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">If set to <code class="inline">false</code>, the relationship will not be usable in filters.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-sortable?" id="relationships-belongs_to-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">If set to <code class="inline">false</code>, the relationship will not be usable in sorts.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-sort" id="relationships-belongs_to-sort"><code class="inline">sort</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A sort statement to be applied when loading the relationship.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-default_sort" id="relationships-belongs_to-default_sort"><code class="inline">default_sort</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default sort statement to be applied when loading the relationship.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-violation_message" id="relationships-belongs_to-violation_message"><code class="inline">violation_message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">A message to show if there is a conflict with this relationship in the database on destroy.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-authorize_read_with" id="relationships-belongs_to-authorize_read_with"><code class="inline">authorize_read_with</code></a></td><td style="text-align: left;"><code class="inline">:error | :filter</code></td><td style="text-align: left;"></td><td style="text-align: left;">If set to <code class="inline">:error</code>, any authorization filter added to the relationship will result in an error if any record matches the filter in the database.</td></tr><tr><td style="text-align: left;"><a href="#relationships-belongs_to-allow_forbidden_field?" id="relationships-belongs_to-allow_forbidden_field?"><code class="inline">allow_forbidden_field?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If set to <code class="inline">true</code>, the relationship will be set to <code class="inline">%Ash.ForbiddenField{}</code> if its query produces a forbidden error.</td></tr></tbody></table><h3 id="relationships-belongs_to-filter">relationships.belongs_to.filter</h3><pre><code class="makeup elixir" translate="no"><span class="n">filter</span><span class="w"> </span><span class="n">filter</span></code></pre><p>Applies a filter. Can use <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^arg/1</code></a>, <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^context/1</code></a> and <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^actor/1</code></a> templates. Multiple filters are combined with <em>and</em>.</p><h3 id="examples-15">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">filter</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="2446892680-1">(</span><span class="n">first_name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;fred&quot;</span><span class="p" data-group-id="2446892680-1">)</span><span class="w">
</span><span class="n">filter</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="2446892680-2">(</span><span class="n">last_name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;weasley&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">magician</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="2446892680-2">)</span><span class="w">
</span></code></pre><h3 id="arguments-13">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#relationships-belongs_to-filter-filter" id="relationships-belongs_to-filter-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The filter to apply. Can use <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^arg/1</code></a>, <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^context/1</code></a> and <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^actor/1</code></a> templates. Multiple filters are combined with <em>and</em>.</td></tr></tbody></table><h3 id="introspection-12">Introspection</h3><p>Target: <a href="Ash.Resource.Dsl.Filter.xhtml"><code class="inline">Ash.Resource.Dsl.Filter</code></a></p><h3 id="introspection-13">Introspection</h3><p>Target: <a href="Ash.Resource.Relationships.BelongsTo.xhtml"><code class="inline">Ash.Resource.Relationships.BelongsTo</code></a></p><h2 id="actions">actions</h2><p>A section for declaring resource actions.</p><p>All manipulation of data through the underlying data layer happens through actions.
There are four types of action: <code class="inline">create</code>, <code class="inline">read</code>, <code class="inline">update</code>, and <code class="inline">destroy</code>. You may
recognize these from the acronym <code class="inline">CRUD</code>. You can have multiple actions of the same
type, as long as they have different names. This is the primary mechanism for customizing
your resources to conform to your business logic. It is normal and expected to have
multiple actions of each type in a large application.</p><h3 id="nested-dsls-6">Nested DSLs</h3><ul><li><a href="#actions-action">action</a><ul><li>argument</li><li>prepare</li><li>validate</li></ul></li><li><a href="#actions-create">create</a><ul><li>change</li><li>validate</li><li>argument</li><li>metadata</li></ul></li><li><a href="#actions-read">read</a><ul><li>argument</li><li>prepare</li><li>validate</li><li>pagination</li><li>metadata</li><li>filter</li></ul></li><li><a href="#actions-update">update</a><ul><li>change</li><li>validate</li><li>metadata</li><li>argument</li></ul></li><li><a href="#actions-destroy">destroy</a><ul><li>change</li><li>validate</li><li>metadata</li><li>argument</li></ul></li></ul><h3 id="examples-16">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">actions</span><span class="w"> </span><span class="k" data-group-id="6189077036-1">do</span><span class="w">
  </span><span class="n">create</span><span class="w"> </span><span class="ss">:signup</span><span class="w"> </span><span class="k" data-group-id="6189077036-2">do</span><span class="w">
    </span><span class="n">argument</span><span class="w"> </span><span class="ss">:password</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="w">
    </span><span class="n">argument</span><span class="w"> </span><span class="ss">:password_confirmation</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="w">
    </span><span class="n">validate</span><span class="w"> </span><span class="n">confirm</span><span class="p" data-group-id="6189077036-3">(</span><span class="ss">:password</span><span class="p">,</span><span class="w"> </span><span class="ss">:password_confirmation</span><span class="p" data-group-id="6189077036-3">)</span><span class="w">
    </span><span class="n">change</span><span class="w"> </span><span class="p" data-group-id="6189077036-4">{</span><span class="nc">MyApp.HashPassword</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6189077036-5">[</span><span class="p" data-group-id="6189077036-5">]</span><span class="p" data-group-id="6189077036-4">}</span><span class="w"> </span><span class="c1"># A custom implemented Change</span><span class="w">
  </span><span class="k" data-group-id="6189077036-2">end</span><span class="w">

  </span><span class="n">read</span><span class="w"> </span><span class="ss">:me</span><span class="w"> </span><span class="k" data-group-id="6189077036-6">do</span><span class="w">
    </span><span class="c1"># An action that auto filters to only return the user for the current user</span><span class="w">
    </span><span class="n">filter</span><span class="w"> </span><span class="p" data-group-id="6189077036-7">[</span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="n">actor</span><span class="p" data-group-id="6189077036-8">(</span><span class="ss">:id</span><span class="p" data-group-id="6189077036-8">)</span><span class="p" data-group-id="6189077036-7">]</span><span class="w">
  </span><span class="k" data-group-id="6189077036-6">end</span><span class="w">

  </span><span class="n">update</span><span class="w"> </span><span class="ss">:update</span><span class="w"> </span><span class="k" data-group-id="6189077036-9">do</span><span class="w">
    </span><span class="n">accept</span><span class="w"> </span><span class="p" data-group-id="6189077036-10">[</span><span class="ss">:first_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:last_name</span><span class="p" data-group-id="6189077036-10">]</span><span class="w">
  </span><span class="k" data-group-id="6189077036-9">end</span><span class="w">

  </span><span class="n">destroy</span><span class="w"> </span><span class="k" data-group-id="6189077036-11">do</span><span class="w">
    </span><span class="n">change</span><span class="w"> </span><span class="n">set_attribute</span><span class="p" data-group-id="6189077036-12">(</span><span class="ss">:deleted_at</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">DateTime</span><span class="o">.</span><span class="n">utc_now</span><span class="o">/</span><span class="mi">0</span><span class="p" data-group-id="6189077036-12">)</span><span class="w">
    </span><span class="c1"># This tells it that even though this is a delete action, it</span><span class="w">
    </span><span class="c1"># should be treated like an update because `deleted_at` is set.</span><span class="w">
    </span><span class="c1"># This should be coupled with a `base_filter` on the resource</span><span class="w">
    </span><span class="c1"># or with the read actions having a `filter` for `is_nil: :deleted_at`</span><span class="w">
    </span><span class="n">soft?</span><span class="w"> </span><span class="no">true</span><span class="w">
  </span><span class="k" data-group-id="6189077036-11">end</span><span class="w">
</span><span class="k" data-group-id="6189077036-1">end</span><span class="w">
</span></code></pre><h3 id="options-5">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-defaults" id="actions-defaults"><code class="inline">defaults</code></a></td><td style="text-align: left;"><code class="inline">list(:create | :read | :update | :destroy | {atom, atom | list(atom)})</code></td><td style="text-align: left;"></td><td style="text-align: left;">Creates a simple action of each specified type, with the same name as the type. These will be <code class="inline">primary?</code> unless one already exists for that type. Embedded resources, however, have a default of all resource types.</td></tr><tr><td style="text-align: left;"><a href="#actions-default_accept" id="actions-default_accept"><code class="inline">default_accept</code></a></td><td style="text-align: left;"><code class="inline">list(atom) | :*</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default value for the <code class="inline">accept</code> option for each action. Use <code class="inline">:*</code> to accept all public attributes.</td></tr></tbody></table><h3 id="actions-action">actions.action</h3><pre><code class="makeup elixir" translate="no"><span class="n">action</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="o">\\</span><span class="w"> </span><span class="no">nil</span></code></pre><p>Declares a generic action. A combination of arguments, a return type and a run function.</p><p>For calling this action, see the <a href="Ash.Domain.xhtml"><code class="inline">Ash.Domain</code></a> documentation.</p><h3 id="nested-dsls-7">Nested DSLs</h3><ul><li><a href="#actions-action-argument">argument</a></li><li><a href="#actions-action-prepare">prepare</a></li><li><a href="#actions-action-validate">validate</a></li></ul><h3 id="examples-17">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">action</span><span class="w"> </span><span class="ss">:top_user_emails</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5214758808-1">{</span><span class="ss">:array</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p" data-group-id="5214758808-1">}</span><span class="w"> </span><span class="k" data-group-id="5214758808-2">do</span><span class="w">
  </span><span class="n">argument</span><span class="w"> </span><span class="ss">:limit</span><span class="p">,</span><span class="w"> </span><span class="ss">:integer</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="ss">allow_nil?</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
  </span><span class="n">run</span><span class="w"> </span><span class="k" data-group-id="5214758808-3">fn</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="k">with</span><span class="w"> </span><span class="p" data-group-id="5214758808-4">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">top_users</span><span class="p" data-group-id="5214758808-4">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">top_users</span><span class="p" data-group-id="5214758808-5">(</span><span class="n">input</span><span class="o">.</span><span class="n">arguments</span><span class="o">.</span><span class="n">limit</span><span class="p" data-group-id="5214758808-5">)</span><span class="w"> </span><span class="k" data-group-id="5214758808-6">do</span><span class="w">
      </span><span class="p" data-group-id="5214758808-7">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="5214758808-8">(</span><span class="n">top_users</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="p" data-group-id="5214758808-9">(</span><span class="ni">&amp;1</span><span class="o">.</span><span class="n">email</span><span class="p" data-group-id="5214758808-9">)</span><span class="p" data-group-id="5214758808-8">)</span><span class="p" data-group-id="5214758808-7">}</span><span class="w">
    </span><span class="k" data-group-id="5214758808-6">end</span><span class="w">
  </span><span class="k" data-group-id="5214758808-3">end</span><span class="w">
</span><span class="k" data-group-id="5214758808-2">end</span><span class="w">
</span></code></pre><h3 id="arguments-14">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-action-name" id="actions-action-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the action</td></tr><tr><td style="text-align: left;"><a href="#actions-action-returns" id="actions-action-returns"><code class="inline">returns</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The return type of the action. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="options-6">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-action-constraints" id="actions-action-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"></td><td style="text-align: left;">Constraints for the return type. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-action-allow_nil?" id="actions-action-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the action can return nil. Unlike attributes &amp; arguments, this defaults to <code class="inline">false</code>.</td></tr><tr><td style="text-align: left;"><a href="#actions-action-run" id="actions-action-run"><code class="inline">run</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">Module may be an <a href="Ash.Resource.Actions.Implementation.xhtml"><code class="inline">Ash.Resource.Actions.Implementation</code></a> or <a href="https://hexdocs.pm/reactor/0.15.6/Reactor.html"><code class="inline">Reactor</code></a>.</td></tr><tr><td style="text-align: left;"><a href="#actions-action-primary?" id="actions-action-primary?"><code class="inline">primary?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not this action should be used when no action is specified by the caller.</td></tr><tr><td style="text-align: left;"><a href="#actions-action-description" id="actions-action-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the action</td></tr><tr><td style="text-align: left;"><a href="#actions-action-transaction?" id="actions-action-transaction?"><code class="inline">transaction?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"></td><td style="text-align: left;">Whether or not the action should be run in transactions. Reads default to false, while create/update/destroy actions default to <code class="inline">true</code>.</td></tr><tr><td style="text-align: left;"><a href="#actions-action-touches_resources" id="actions-action-touches_resources"><code class="inline">touches_resources</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A list of resources that the action may touch, used when building transactions.</td></tr><tr><td style="text-align: left;"><a href="#actions-action-skip_unknown_inputs" id="actions-action-skip_unknown_inputs"><code class="inline">skip_unknown_inputs</code></a></td><td style="text-align: left;"><code class="inline">atom | String.t | list(atom | String.t)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A list of unknown fields to skip, or <code class="inline">:*</code> to skip all unknown fields.</td></tr></tbody></table><h3 id="actions-action-argument">actions.action.argument</h3><pre><code class="makeup elixir" translate="no"><span class="n">argument</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span></code></pre><p>Declares an argument on the action</p><h3 id="examples-18">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">argument</span><span class="w"> </span><span class="ss">:password_confirmation</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span></code></pre><h3 id="arguments-15">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-action-argument-name" id="actions-action-argument-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the argument</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#actions-action-argument-type" id="actions-action-argument-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the argument. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="options-7">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-action-argument-description" id="actions-action-argument-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the argument.</td></tr><tr><td style="text-align: left;"><a href="#actions-action-argument-constraints" id="actions-action-argument-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Constraints to provide to the type when casting the value. For more information, see <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a>.</td></tr><tr><td style="text-align: left;"><a href="#actions-action-argument-allow_nil?" id="actions-action-argument-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the argument value may be nil (or may be not provided). If nil value is given error is raised.</td></tr><tr><td style="text-align: left;"><a href="#actions-action-argument-public?" id="actions-action-argument-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the argument should appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#actions-action-argument-sensitive?" id="actions-action-argument-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the argument value contains sensitive information, like PII(Personally Identifiable Information). See the <a href="sensitive-data.xhtml">security guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-action-argument-default" id="actions-action-argument-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The default value for the argument to take. It can be a zero argument function e.g <code class="inline">&amp;MyMod.my_fun/0</code> or a value</td></tr></tbody></table><h3 id="introspection-14">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Argument.xhtml"><code class="inline">Ash.Resource.Actions.Argument</code></a></p><h3 id="actions-action-prepare">actions.action.prepare</h3><pre><code class="makeup elixir" translate="no"><span class="n">prepare</span><span class="w"> </span><span class="n">preparation</span></code></pre><p>Declares a preparation, which can be used to prepare a query for a read action.</p><h3 id="examples-19">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">prepare</span><span class="w"> </span><span class="n">build</span><span class="p" data-group-id="9107069480-1">(</span><span class="ss">sort</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9107069480-2">[</span><span class="ss">:foo</span><span class="p">,</span><span class="w"> </span><span class="ss">:bar</span><span class="p" data-group-id="9107069480-2">]</span><span class="p" data-group-id="9107069480-1">)</span><span class="w">
</span></code></pre><h3 id="arguments-16">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-action-prepare-preparation" id="actions-action-prepare-preparation"><code class="inline">preparation</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The module and options for a preparation. Also accepts functions take the query and the context.</td></tr></tbody></table><h3 id="options-8">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-action-prepare-on" id="actions-action-prepare-on"><code class="inline">on</code></a></td><td style="text-align: left;"><code class="inline">:read | :action | list(:read | :action)</code></td><td style="text-align: left;"><code class="inline">[:read]</code></td><td style="text-align: left;">The action types the preparation should run on. By default, preparations only run on read actions. Use <code class="inline">:action</code> to run on generic actions.</td></tr><tr><td style="text-align: left;"><a href="#actions-action-prepare-where" id="actions-action-prepare-where"><code class="inline">where</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | list((any, any -&gt; any) | module)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Validations that should pass in order for this preparation to apply. Any of these validations failing will result in this preparation being ignored.</td></tr><tr><td style="text-align: left;"><a href="#actions-action-prepare-only_when_valid?" id="actions-action-prepare-only_when_valid?"><code class="inline">only_when_valid?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If the preparation should only run on valid queries.</td></tr></tbody></table><h3 id="introspection-15">Introspection</h3><p>Target: <a href="Ash.Resource.Preparation.xhtml"><code class="inline">Ash.Resource.Preparation</code></a></p><h3 id="actions-action-validate">actions.action.validate</h3><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="n">validation</span></code></pre><p>Declares a validation for creates and updates.</p><p>See <a href="Ash.Resource.Validation.Builtins.xhtml"><code class="inline">Ash.Resource.Validation.Builtins</code></a> or <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a> for more.</p><h3 id="examples-20">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="p" data-group-id="1605722827-1">{</span><span class="nc">Mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1605722827-2">[</span><span class="ss">foo</span><span class="p">:</span><span class="w"> </span><span class="ss">:bar</span><span class="p" data-group-id="1605722827-2">]</span><span class="p" data-group-id="1605722827-1">}</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="n">present</span><span class="p" data-group-id="5219340950-1">(</span><span class="p" data-group-id="5219340950-2">[</span><span class="ss">:first_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:last_name</span><span class="p" data-group-id="5219340950-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">at_least</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="5219340950-1">)</span></code></pre><h3 id="arguments-17">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-action-validate-validation" id="actions-action-validate-validation"><code class="inline">validation</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The module (or module and opts) that implements the <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a> behaviour. Also accepts a function that receives the changeset and its context.</td></tr></tbody></table><h3 id="options-9">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-action-validate-where" id="actions-action-validate-where"><code class="inline">where</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | list((any, any -&gt; any) | module)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Validations that should pass in order for this validation to apply. Any of these validations failing will result in this validation being ignored.</td></tr><tr><td style="text-align: left;"><a href="#actions-action-validate-only_when_valid?" id="actions-action-validate-only_when_valid?"><code class="inline">only_when_valid?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If the validation should only run on valid changesets. Useful for expensive validations or validations that depend on valid data.</td></tr><tr><td style="text-align: left;"><a href="#actions-action-validate-message" id="actions-action-validate-message"><code class="inline">message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">If provided, overrides any message set by the validation error</td></tr><tr><td style="text-align: left;"><a href="#actions-action-validate-description" id="actions-action-validate-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the validation</td></tr><tr><td style="text-align: left;"><a href="#actions-action-validate-before_action?" id="actions-action-validate-before_action?"><code class="inline">before_action?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If set to <code class="inline">true</code>, the validation will be run in a before_action hook</td></tr></tbody></table><h3 id="introspection-16">Introspection</h3><p>Target: <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a></p><h3 id="introspection-17">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Action.xhtml"><code class="inline">Ash.Resource.Actions.Action</code></a></p><h3 id="actions-create">actions.create</h3><pre><code class="makeup elixir" translate="no"><span class="n">create</span><span class="w"> </span><span class="n">name</span></code></pre><p>Declares a <code class="inline">create</code> action. For calling this action, see the <a href="Ash.Domain.xhtml"><code class="inline">Ash.Domain</code></a> documentation.</p><h3 id="nested-dsls-8">Nested DSLs</h3><ul><li><a href="#actions-create-change">change</a></li><li><a href="#actions-create-validate">validate</a></li><li><a href="#actions-create-argument">argument</a></li><li><a href="#actions-create-metadata">metadata</a></li></ul><h3 id="examples-21">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">create</span><span class="w"> </span><span class="ss">:register</span><span class="w"> </span><span class="k" data-group-id="9006546422-1">do</span><span class="w">
  </span><span class="n">primary?</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="k" data-group-id="9006546422-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-18">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-create-name" id="actions-create-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the action</td></tr></tbody></table><h3 id="options-10">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-create-manual" id="actions-create-manual"><code class="inline">manual</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">Override the creation behavior. Accepts a module or module and opts, or a function that takes the changeset and context. See the <a href="manual-actions.xhtml">manual actions guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-upsert?" id="actions-create-upsert?"><code class="inline">upsert?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Forces all uses of this action to be treated as an upsert.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-upsert_identity" id="actions-create-upsert_identity"><code class="inline">upsert_identity</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The identity to use for the upsert. Cannot be overridden by the caller. Ignored  if <code class="inline">upsert?</code> is not set to <code class="inline">true</code>.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-upsert_fields" id="actions-create-upsert_fields"><code class="inline">upsert_fields</code></a></td><td style="text-align: left;"><code class="inline">:replace_all | {:replace, atom | list(atom)} | {:replace_all_except, atom | list(atom)} | atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The fields to overwrite in the case of an upsert. If not provided, all fields except for fields set by defaults will be overwritten.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-upsert_condition" id="actions-create-upsert_condition"><code class="inline">upsert_condition</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">An expression to check if the record should be updated when there's a conflict.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-return_skipped_upsert?" id="actions-create-return_skipped_upsert?"><code class="inline">return_skipped_upsert?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"></td><td style="text-align: left;">Returns the record that would have been upserted against but was skipped due to a filter or no fields being changed. How this works depends on the data layer. Keep in mind that read policies <em>are not applied</em> to the read of the record in question.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-primary?" id="actions-create-primary?"><code class="inline">primary?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not this action should be used when no action is specified by the caller.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-description" id="actions-create-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the action</td></tr><tr><td style="text-align: left;"><a href="#actions-create-transaction?" id="actions-create-transaction?"><code class="inline">transaction?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"></td><td style="text-align: left;">Whether or not the action should be run in transactions. Reads default to false, while create/update/destroy actions default to <code class="inline">true</code>.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-touches_resources" id="actions-create-touches_resources"><code class="inline">touches_resources</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A list of resources that the action may touch, used when building transactions.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-skip_unknown_inputs" id="actions-create-skip_unknown_inputs"><code class="inline">skip_unknown_inputs</code></a></td><td style="text-align: left;"><code class="inline">atom | String.t | list(atom | String.t)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A list of unknown fields to skip, or <code class="inline">:*</code> to skip all unknown fields.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-accept" id="actions-create-accept"><code class="inline">accept</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom) | :*</code></td><td style="text-align: left;"></td><td style="text-align: left;">The list of attributes to accept. Use <code class="inline">:*</code> to accept all public attributes.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-action_select" id="actions-create-action_select"><code class="inline">action_select</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A list of attributes that the action requires to do its work. Defaults to all attributes except those with <code class="inline">select_by_default? false</code>. On actions with no changes/notifiers, it defaults to the externally selected attributes. Keep in mind that action_select is applied <em>before</em> notifiers.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-require_attributes" id="actions-create-require_attributes"><code class="inline">require_attributes</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A list of attributes that would normally <code class="inline">allow_nil?</code>, to require for this action. No need to include attributes that already do not allow nil?</td></tr><tr><td style="text-align: left;"><a href="#actions-create-allow_nil_input" id="actions-create-allow_nil_input"><code class="inline">allow_nil_input</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A list of attributes that would normally be required, but should not be for this action. They will still be validated just before the data layer step.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-delay_global_validations?" id="actions-create-delay_global_validations?"><code class="inline">delay_global_validations?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If true, global validations will be done in a <code class="inline">before_action</code> hook, regardless of their configuration on the resource.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-skip_global_validations?" id="actions-create-skip_global_validations?"><code class="inline">skip_global_validations?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If true, global validations will be skipped. Useful for manual actions.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-error_handler" id="actions-create-error_handler"><code class="inline">error_handler</code></a></td><td style="text-align: left;"><code class="inline">mfa | (any, any -&gt; any)</code></td><td style="text-align: left;"></td><td style="text-align: left;">Sets the error handler on the changeset. See <a href="Ash.Changeset.xhtml#handle_errors/2"><code class="inline">Ash.Changeset.handle_errors/2</code></a> for more</td></tr><tr><td style="text-align: left;"><a href="#actions-create-notifiers" id="actions-create-notifiers"><code class="inline">notifiers</code></a></td><td style="text-align: left;"><code class="inline">list(module)</code></td><td style="text-align: left;"></td><td style="text-align: left;">Notifiers that will be called specifically for this action.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-manual?" id="actions-create-manual?"><code class="inline">manual?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"></td><td style="text-align: left;">Instructs Ash to <em>skip</em> the actual update/create/destroy step at the data layer. See the <a href="manual-actions.xhtml">manual actions guide</a> for more.</td></tr></tbody></table><h3 id="actions-create-change">actions.create.change</h3><pre><code class="makeup elixir" translate="no"><span class="n">change</span><span class="w"> </span><span class="n">change</span></code></pre><p>A change to be applied to the changeset.</p><p>See <a href="Ash.Resource.Change.xhtml"><code class="inline">Ash.Resource.Change</code></a> for more.</p><h3 id="examples-22">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">change</span><span class="w"> </span><span class="n">relate_actor</span><span class="p" data-group-id="7356160400-1">(</span><span class="ss">:reporter</span><span class="p" data-group-id="7356160400-1">)</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">change</span><span class="w"> </span><span class="p" data-group-id="1264648280-1">{</span><span class="nc">MyCustomChange</span><span class="p">,</span><span class="w"> </span><span class="ss">:foo</span><span class="p" data-group-id="1264648280-1">}</span></code></pre><h3 id="arguments-19">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-create-change-change" id="actions-create-change-change"><code class="inline">change</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The module and options for a change. Also accepts a function that takes the changeset and the context. See <a href="Ash.Resource.Change.Builtins.xhtml"><code class="inline">Ash.Resource.Change.Builtins</code></a> for builtin changes.</td></tr></tbody></table><h3 id="options-11">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-create-change-only_when_valid?" id="actions-create-change-only_when_valid?"><code class="inline">only_when_valid?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If the change should only be run on valid changes. By default, all changes are run unless stated otherwise here.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-change-description" id="actions-create-change-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the change</td></tr><tr><td style="text-align: left;"><a href="#actions-create-change-where" id="actions-create-change-where"><code class="inline">where</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | list((any, any -&gt; any) | module)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Validations that should pass in order for this change to apply. These validations failing will result in this change being ignored.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-change-always_atomic?" id="actions-create-change-always_atomic?"><code class="inline">always_atomic?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">By default, changes are only run atomically if all changes will be run atomically or if there is no <code class="inline">change/3</code> callback defined. Set this to <code class="inline">true</code> to run it atomically always.</td></tr></tbody></table><h3 id="introspection-18">Introspection</h3><p>Target: <a href="Ash.Resource.Change.xhtml"><code class="inline">Ash.Resource.Change</code></a></p><h3 id="actions-create-validate">actions.create.validate</h3><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="n">validation</span></code></pre><p>Declares a validation to be applied to the changeset.</p><p>See <a href="Ash.Resource.Validation.Builtins.xhtml"><code class="inline">Ash.Resource.Validation.Builtins</code></a> or <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a> for more.</p><h3 id="examples-23">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="n">changing</span><span class="p" data-group-id="0402005306-1">(</span><span class="ss">:email</span><span class="p" data-group-id="0402005306-1">)</span></code></pre><h3 id="arguments-20">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-create-validate-validation" id="actions-create-validate-validation"><code class="inline">validation</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The module (or module and opts) that implements the <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a> behaviour. Also accepts a function that receives the changeset and its context.</td></tr></tbody></table><h3 id="options-12">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-create-validate-where" id="actions-create-validate-where"><code class="inline">where</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | list((any, any -&gt; any) | module)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Validations that should pass in order for this validation to apply. Any of these validations failing will result in this validation being ignored.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-validate-only_when_valid?" id="actions-create-validate-only_when_valid?"><code class="inline">only_when_valid?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If the validation should only run on valid changesets. Useful for expensive validations or validations that depend on valid data.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-validate-message" id="actions-create-validate-message"><code class="inline">message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">If provided, overrides any message set by the validation error</td></tr><tr><td style="text-align: left;"><a href="#actions-create-validate-description" id="actions-create-validate-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the validation</td></tr><tr><td style="text-align: left;"><a href="#actions-create-validate-before_action?" id="actions-create-validate-before_action?"><code class="inline">before_action?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If set to <code class="inline">true</code>, the validation will be run in a before_action hook</td></tr><tr><td style="text-align: left;"><a href="#actions-create-validate-always_atomic?" id="actions-create-validate-always_atomic?"><code class="inline">always_atomic?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">By default, validations are only run atomically if all changes will be run atomically or if there is no <code class="inline">validate/3</code> callback defined. Set this to <code class="inline">true</code> to run it atomically always.</td></tr></tbody></table><h3 id="introspection-19">Introspection</h3><p>Target: <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a></p><h3 id="actions-create-argument">actions.create.argument</h3><pre><code class="makeup elixir" translate="no"><span class="n">argument</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span></code></pre><p>Declares an argument on the action</p><h3 id="examples-24">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">argument</span><span class="w"> </span><span class="ss">:password_confirmation</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span></code></pre><h3 id="arguments-21">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-create-argument-name" id="actions-create-argument-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the argument</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#actions-create-argument-type" id="actions-create-argument-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the argument. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="options-13">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-create-argument-description" id="actions-create-argument-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the argument.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-argument-constraints" id="actions-create-argument-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Constraints to provide to the type when casting the value. For more information, see <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a>.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-argument-allow_nil?" id="actions-create-argument-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the argument value may be nil (or may be not provided). If nil value is given error is raised.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-argument-public?" id="actions-create-argument-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the argument should appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#actions-create-argument-sensitive?" id="actions-create-argument-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the argument value contains sensitive information, like PII(Personally Identifiable Information). See the <a href="sensitive-data.xhtml">security guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-argument-default" id="actions-create-argument-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The default value for the argument to take. It can be a zero argument function e.g <code class="inline">&amp;MyMod.my_fun/0</code> or a value</td></tr></tbody></table><h3 id="introspection-20">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Argument.xhtml"><code class="inline">Ash.Resource.Actions.Argument</code></a></p><h3 id="actions-create-metadata">actions.create.metadata</h3><pre><code class="makeup elixir" translate="no"><span class="n">metadata</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span></code></pre><p>A special kind of attribute that is only added to specific actions. Nothing sets this value, it must be set in a custom
change after_action hook via <a href="Ash.Resource.xhtml#put_metadata/3"><code class="inline">Ash.Resource.put_metadata/3</code></a>.</p><h3 id="examples-25">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">metadata</span><span class="w"> </span><span class="ss">:api_token</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">allow_nil?</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">metadata</span><span class="w"> </span><span class="ss">:operation_id</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">allow_nil?</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
</span></code></pre><h3 id="arguments-22">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-create-metadata-name" id="actions-create-metadata-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the metadata</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#actions-create-metadata-type" id="actions-create-metadata-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the metadata. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="options-14">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-create-metadata-constraints" id="actions-create-metadata-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Type constraints on the metadata</td></tr><tr><td style="text-align: left;"><a href="#actions-create-metadata-description" id="actions-create-metadata-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the metadata.</td></tr><tr><td style="text-align: left;"><a href="#actions-create-metadata-allow_nil?" id="actions-create-metadata-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the metadata may return <code class="inline">nil</code></td></tr><tr><td style="text-align: left;"><a href="#actions-create-metadata-default" id="actions-create-metadata-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The default value for the metadata to take. It can be a zero argument function e.g <code class="inline">&amp;MyMod.my_fun/0</code> or a value</td></tr></tbody></table><h3 id="introspection-21">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Metadata.xhtml"><code class="inline">Ash.Resource.Actions.Metadata</code></a></p><h3 id="introspection-22">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Create.xhtml"><code class="inline">Ash.Resource.Actions.Create</code></a></p><h3 id="actions-read">actions.read</h3><pre><code class="makeup elixir" translate="no"><span class="n">read</span><span class="w"> </span><span class="n">name</span></code></pre><p>Declares a <code class="inline">read</code> action. For calling this action, see the <a href="Ash.Domain.xhtml"><code class="inline">Ash.Domain</code></a> documentation.</p><h3 id="nested-dsls-9">Nested DSLs</h3><ul><li><a href="#actions-read-argument">argument</a></li><li><a href="#actions-read-prepare">prepare</a></li><li><a href="#actions-read-validate">validate</a></li><li><a href="#actions-read-pagination">pagination</a></li><li><a href="#actions-read-metadata">metadata</a></li><li><a href="#actions-read-filter">filter</a></li></ul><h3 id="examples-26">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">read</span><span class="w"> </span><span class="ss">:read_all</span><span class="w"> </span><span class="k" data-group-id="6999514749-1">do</span><span class="w">
  </span><span class="n">primary?</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="k" data-group-id="6999514749-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-23">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-read-name" id="actions-read-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the action</td></tr></tbody></table><h3 id="options-15">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-read-manual" id="actions-read-manual"><code class="inline">manual</code></a></td><td style="text-align: left;"><code class="inline">(any, any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">Delegates running of the query to the provided module. Accepts a module or module and opts, or a function that takes the ash query, the data layer query, and context. See the <a href="manual-actions.xhtml">manual actions guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-get?" id="actions-read-get?"><code class="inline">get?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Expresses that this action innately only returns a single result. Used by extensions to validate and/or modify behavior. Causes code interfaces to return a single value instead of a list. See the <a href="code-interfaces.xhtml">code interface guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-modify_query" id="actions-read-modify_query"><code class="inline">modify_query</code></a></td><td style="text-align: left;"><code class="inline">mfa | (any, any -&gt; any)</code></td><td style="text-align: left;"></td><td style="text-align: left;">Allows direct manipulation of the data layer query via an MFA. The ash query and the data layer query will be provided as additional arguments. The result must be <code class="inline">{:ok, new_data_layer_query} | {:error, error}</code>.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-get_by" id="actions-read-get_by"><code class="inline">get_by</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A helper to automatically generate a &quot;get by X&quot; action. Sets <code class="inline">get?</code> to true, add args for each of the specified fields, and adds a filter for each of the arguments.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-timeout" id="actions-read-timeout"><code class="inline">timeout</code></a></td><td style="text-align: left;"><code class="inline">pos_integer</code></td><td style="text-align: left;"></td><td style="text-align: left;">The maximum amount of time, in milliseconds, that the action is allowed to run for. Ignored if the data layer doesn't support transactions <em>and</em> async is disabled.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-multitenancy" id="actions-read-multitenancy"><code class="inline">multitenancy</code></a></td><td style="text-align: left;"><code class="inline">:enforce | :allow_global | :bypass | :bypass_all</code></td><td style="text-align: left;"><code class="inline">:enforce</code></td><td style="text-align: left;">This setting defines how this action handles multitenancy. <code class="inline">:enforce</code> requires a tenant to be set (the default behavior), <code class="inline">:allow_global</code> allows using this action both with and without a tenant, <code class="inline">:bypass</code> completely ignores the tenant even if it's set, <code class="inline">:bypass_all</code> like <code class="inline">:bypass</code> but also bypasses the tenancy requirement for the nested resources. This is useful to change the behaviour of selected read action without the need of marking the whole resource with <code class="inline">global? true</code>.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-skip_global_validations?" id="actions-read-skip_global_validations?"><code class="inline">skip_global_validations?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If true, global validations will be skipped. Useful for manual actions.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-primary?" id="actions-read-primary?"><code class="inline">primary?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not this action should be used when no action is specified by the caller.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-description" id="actions-read-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the action</td></tr><tr><td style="text-align: left;"><a href="#actions-read-transaction?" id="actions-read-transaction?"><code class="inline">transaction?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"></td><td style="text-align: left;">Whether or not the action should be run in transactions. Reads default to false, while create/update/destroy actions default to <code class="inline">true</code>.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-touches_resources" id="actions-read-touches_resources"><code class="inline">touches_resources</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A list of resources that the action may touch, used when building transactions.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-skip_unknown_inputs" id="actions-read-skip_unknown_inputs"><code class="inline">skip_unknown_inputs</code></a></td><td style="text-align: left;"><code class="inline">atom | String.t | list(atom | String.t)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A list of unknown fields to skip, or <code class="inline">:*</code> to skip all unknown fields.</td></tr></tbody></table><h3 id="actions-read-argument">actions.read.argument</h3><pre><code class="makeup elixir" translate="no"><span class="n">argument</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span></code></pre><p>Declares an argument on the action</p><h3 id="examples-27">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">argument</span><span class="w"> </span><span class="ss">:password_confirmation</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span></code></pre><h3 id="arguments-24">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-read-argument-name" id="actions-read-argument-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the argument</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#actions-read-argument-type" id="actions-read-argument-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the argument. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="options-16">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-read-argument-description" id="actions-read-argument-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the argument.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-argument-constraints" id="actions-read-argument-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Constraints to provide to the type when casting the value. For more information, see <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a>.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-argument-allow_nil?" id="actions-read-argument-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the argument value may be nil (or may be not provided). If nil value is given error is raised.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-argument-public?" id="actions-read-argument-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the argument should appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#actions-read-argument-sensitive?" id="actions-read-argument-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the argument value contains sensitive information, like PII(Personally Identifiable Information). See the <a href="sensitive-data.xhtml">security guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-argument-default" id="actions-read-argument-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The default value for the argument to take. It can be a zero argument function e.g <code class="inline">&amp;MyMod.my_fun/0</code> or a value</td></tr></tbody></table><h3 id="introspection-23">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Argument.xhtml"><code class="inline">Ash.Resource.Actions.Argument</code></a></p><h3 id="actions-read-prepare">actions.read.prepare</h3><pre><code class="makeup elixir" translate="no"><span class="n">prepare</span><span class="w"> </span><span class="n">preparation</span></code></pre><p>Declares a preparation, which can be used to prepare a query for a read action.</p><h3 id="examples-28">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">prepare</span><span class="w"> </span><span class="n">build</span><span class="p" data-group-id="0006146358-1">(</span><span class="ss">sort</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="0006146358-2">[</span><span class="ss">:foo</span><span class="p">,</span><span class="w"> </span><span class="ss">:bar</span><span class="p" data-group-id="0006146358-2">]</span><span class="p" data-group-id="0006146358-1">)</span><span class="w">
</span></code></pre><h3 id="arguments-25">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-read-prepare-preparation" id="actions-read-prepare-preparation"><code class="inline">preparation</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The module and options for a preparation. Also accepts functions take the query and the context.</td></tr></tbody></table><h3 id="options-17">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-read-prepare-on" id="actions-read-prepare-on"><code class="inline">on</code></a></td><td style="text-align: left;"><code class="inline">:read | :action | list(:read | :action)</code></td><td style="text-align: left;"><code class="inline">[:read]</code></td><td style="text-align: left;">The action types the preparation should run on. By default, preparations only run on read actions. Use <code class="inline">:action</code> to run on generic actions.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-prepare-where" id="actions-read-prepare-where"><code class="inline">where</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | list((any, any -&gt; any) | module)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Validations that should pass in order for this preparation to apply. Any of these validations failing will result in this preparation being ignored.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-prepare-only_when_valid?" id="actions-read-prepare-only_when_valid?"><code class="inline">only_when_valid?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If the preparation should only run on valid queries.</td></tr></tbody></table><h3 id="introspection-24">Introspection</h3><p>Target: <a href="Ash.Resource.Preparation.xhtml"><code class="inline">Ash.Resource.Preparation</code></a></p><h3 id="actions-read-validate">actions.read.validate</h3><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="n">validation</span></code></pre><p>Declares a validation for creates and updates.</p><p>See <a href="Ash.Resource.Validation.Builtins.xhtml"><code class="inline">Ash.Resource.Validation.Builtins</code></a> or <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a> for more.</p><h3 id="examples-29">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="p" data-group-id="3524566321-1">{</span><span class="nc">Mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3524566321-2">[</span><span class="ss">foo</span><span class="p">:</span><span class="w"> </span><span class="ss">:bar</span><span class="p" data-group-id="3524566321-2">]</span><span class="p" data-group-id="3524566321-1">}</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="n">present</span><span class="p" data-group-id="8105406739-1">(</span><span class="p" data-group-id="8105406739-2">[</span><span class="ss">:first_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:last_name</span><span class="p" data-group-id="8105406739-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">at_least</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="8105406739-1">)</span></code></pre><h3 id="arguments-26">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-read-validate-validation" id="actions-read-validate-validation"><code class="inline">validation</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The module (or module and opts) that implements the <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a> behaviour. Also accepts a function that receives the changeset and its context.</td></tr></tbody></table><h3 id="options-18">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-read-validate-where" id="actions-read-validate-where"><code class="inline">where</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | list((any, any -&gt; any) | module)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Validations that should pass in order for this validation to apply. Any of these validations failing will result in this validation being ignored.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-validate-only_when_valid?" id="actions-read-validate-only_when_valid?"><code class="inline">only_when_valid?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If the validation should only run on valid changesets. Useful for expensive validations or validations that depend on valid data.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-validate-message" id="actions-read-validate-message"><code class="inline">message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">If provided, overrides any message set by the validation error</td></tr><tr><td style="text-align: left;"><a href="#actions-read-validate-description" id="actions-read-validate-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the validation</td></tr><tr><td style="text-align: left;"><a href="#actions-read-validate-before_action?" id="actions-read-validate-before_action?"><code class="inline">before_action?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If set to <code class="inline">true</code>, the validation will be run in a before_action hook</td></tr></tbody></table><h3 id="introspection-25">Introspection</h3><p>Target: <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a></p><h3 id="actions-read-pagination">actions.read.pagination</h3><p>Adds pagination options to a resource</p><h3 id="options-19">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-read-pagination-keyset?" id="actions-read-pagination-keyset?"><code class="inline">keyset?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not keyset based pagination is supported</td></tr><tr><td style="text-align: left;"><a href="#actions-read-pagination-offset?" id="actions-read-pagination-offset?"><code class="inline">offset?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not offset based pagination is supported</td></tr><tr><td style="text-align: left;"><a href="#actions-read-pagination-default_limit" id="actions-read-pagination-default_limit"><code class="inline">default_limit</code></a></td><td style="text-align: left;"><code class="inline">pos_integer</code></td><td style="text-align: left;"></td><td style="text-align: left;">The default page size to apply, if one is not supplied</td></tr><tr><td style="text-align: left;"><a href="#actions-read-pagination-countable" id="actions-read-pagination-countable"><code class="inline">countable</code></a></td><td style="text-align: left;"><code class="inline">true | false | :by_default</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether not a returned page will have a full count of all records. Use <code class="inline">:by_default</code> to do it automatically.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-pagination-max_page_size" id="actions-read-pagination-max_page_size"><code class="inline">max_page_size</code></a></td><td style="text-align: left;"><code class="inline">pos_integer</code></td><td style="text-align: left;"><code class="inline">250</code></td><td style="text-align: left;">The maximum amount of records that can be requested in a single page</td></tr><tr><td style="text-align: left;"><a href="#actions-read-pagination-stable_sort" id="actions-read-pagination-stable_sort"><code class="inline">stable_sort</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A stable sort statement to add to a query (after any existing sorts). Only added if the sort does not already contain a stable sort (sorting on fields that uniquely identify a record). Defaults to the primary key.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-pagination-required?" id="actions-read-pagination-required?"><code class="inline">required?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not pagination can be disabled (by passing <code class="inline">page: false</code> to <code class="inline">Ash.Api.read!/2</code>, or by having <code class="inline">required?: false, default_limit: nil</code> set). Only relevant if some pagination configuration is supplied.</td></tr></tbody></table><h3 id="introspection-26">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Read.Pagination.xhtml"><code class="inline">Ash.Resource.Actions.Read.Pagination</code></a></p><h3 id="actions-read-metadata">actions.read.metadata</h3><pre><code class="makeup elixir" translate="no"><span class="n">metadata</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span></code></pre><p>A special kind of attribute that is only added to specific actions. Nothing sets this value, it must be set in a custom
change after_action hook via <a href="Ash.Resource.xhtml#put_metadata/3"><code class="inline">Ash.Resource.put_metadata/3</code></a>.</p><h3 id="examples-30">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">metadata</span><span class="w"> </span><span class="ss">:api_token</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">allow_nil?</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">metadata</span><span class="w"> </span><span class="ss">:operation_id</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">allow_nil?</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
</span></code></pre><h3 id="arguments-27">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-read-metadata-name" id="actions-read-metadata-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the metadata</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#actions-read-metadata-type" id="actions-read-metadata-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the metadata. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="options-20">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-read-metadata-constraints" id="actions-read-metadata-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Type constraints on the metadata</td></tr><tr><td style="text-align: left;"><a href="#actions-read-metadata-description" id="actions-read-metadata-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the metadata.</td></tr><tr><td style="text-align: left;"><a href="#actions-read-metadata-allow_nil?" id="actions-read-metadata-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the metadata may return <code class="inline">nil</code></td></tr><tr><td style="text-align: left;"><a href="#actions-read-metadata-default" id="actions-read-metadata-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The default value for the metadata to take. It can be a zero argument function e.g <code class="inline">&amp;MyMod.my_fun/0</code> or a value</td></tr></tbody></table><h3 id="introspection-27">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Metadata.xhtml"><code class="inline">Ash.Resource.Actions.Metadata</code></a></p><h3 id="actions-read-filter">actions.read.filter</h3><pre><code class="makeup elixir" translate="no"><span class="n">filter</span><span class="w"> </span><span class="n">filter</span></code></pre><p>Applies a filter. Can use <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^arg/1</code></a>, <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^context/1</code></a> and <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^actor/1</code></a> templates. Multiple filters are combined with <em>and</em>.</p><h3 id="examples-31">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">filter</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="7821204996-1">(</span><span class="n">first_name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;fred&quot;</span><span class="p" data-group-id="7821204996-1">)</span><span class="w">
</span><span class="n">filter</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="7821204996-2">(</span><span class="n">last_name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;weasley&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">magician</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="7821204996-2">)</span><span class="w">
</span></code></pre><h3 id="arguments-28">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-read-filter-filter" id="actions-read-filter-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The filter to apply. Can use <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^arg/1</code></a>, <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^context/1</code></a> and <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#%5E/1"><code class="inline">^actor/1</code></a> templates. Multiple filters are combined with <em>and</em>.</td></tr></tbody></table><h3 id="introspection-28">Introspection</h3><p>Target: <a href="Ash.Resource.Dsl.Filter.xhtml"><code class="inline">Ash.Resource.Dsl.Filter</code></a></p><h3 id="introspection-29">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Read.xhtml"><code class="inline">Ash.Resource.Actions.Read</code></a></p><h3 id="actions-update">actions.update</h3><pre><code class="makeup elixir" translate="no"><span class="n">update</span><span class="w"> </span><span class="n">name</span></code></pre><p>Declares a <code class="inline">update</code> action. For calling this action, see the <a href="Ash.Domain.xhtml"><code class="inline">Ash.Domain</code></a> documentation.</p><h3 id="nested-dsls-10">Nested DSLs</h3><ul><li><a href="#actions-update-change">change</a></li><li><a href="#actions-update-validate">validate</a></li><li><a href="#actions-update-metadata">metadata</a></li><li><a href="#actions-update-argument">argument</a></li></ul><h3 id="examples-32">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">update</span><span class="w"> </span><span class="ss">:flag_for_review</span><span class="p">,</span><span class="w"> </span><span class="ss">primary?</span><span class="p">:</span><span class="w"> </span><span class="no">true</span></code></pre><h3 id="arguments-29">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-update-name" id="actions-update-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the action</td></tr></tbody></table><h3 id="options-21">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-update-manual" id="actions-update-manual"><code class="inline">manual</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">Override the update behavior. Accepts a module or module and opts, or a function that takes the changeset and context. See the <a href="manual-actions.xhtml">manual actions guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-require_atomic?" id="actions-update-require_atomic?"><code class="inline">require_atomic?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Require that the update be atomic. This means that all changes and validations implement the <code class="inline">atomic</code> callback. See the guide on atomic updates for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-atomic_upgrade?" id="actions-update-atomic_upgrade?"><code class="inline">atomic_upgrade?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If set to <code class="inline">true</code>, atomic upgrades will be performed. Ignored if <code class="inline">required_atomic?</code> is <code class="inline">true</code>. See the update actions guide for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-atomic_upgrade_with" id="actions-update-atomic_upgrade_with"><code class="inline">atomic_upgrade_with</code></a></td><td style="text-align: left;"><code class="inline">atom | nil</code></td><td style="text-align: left;"></td><td style="text-align: left;">Configure the read action used when performing atomic upgrades. Defaults to the primary read action.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-primary?" id="actions-update-primary?"><code class="inline">primary?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not this action should be used when no action is specified by the caller.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-description" id="actions-update-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the action</td></tr><tr><td style="text-align: left;"><a href="#actions-update-transaction?" id="actions-update-transaction?"><code class="inline">transaction?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"></td><td style="text-align: left;">Whether or not the action should be run in transactions. Reads default to false, while create/update/destroy actions default to <code class="inline">true</code>.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-touches_resources" id="actions-update-touches_resources"><code class="inline">touches_resources</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A list of resources that the action may touch, used when building transactions.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-skip_unknown_inputs" id="actions-update-skip_unknown_inputs"><code class="inline">skip_unknown_inputs</code></a></td><td style="text-align: left;"><code class="inline">atom | String.t | list(atom | String.t)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A list of unknown fields to skip, or <code class="inline">:*</code> to skip all unknown fields.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-accept" id="actions-update-accept"><code class="inline">accept</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom) | :*</code></td><td style="text-align: left;"></td><td style="text-align: left;">The list of attributes to accept. Use <code class="inline">:*</code> to accept all public attributes.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-action_select" id="actions-update-action_select"><code class="inline">action_select</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A list of attributes that the action requires to do its work. Defaults to all attributes except those with <code class="inline">select_by_default? false</code>. On actions with no changes/notifiers, it defaults to the externally selected attributes. Keep in mind that action_select is applied <em>before</em> notifiers.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-require_attributes" id="actions-update-require_attributes"><code class="inline">require_attributes</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A list of attributes that would normally <code class="inline">allow_nil?</code>, to require for this action. No need to include attributes that already do not allow nil?</td></tr><tr><td style="text-align: left;"><a href="#actions-update-allow_nil_input" id="actions-update-allow_nil_input"><code class="inline">allow_nil_input</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A list of attributes that would normally be required, but should not be for this action. They will still be validated just before the data layer step.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-delay_global_validations?" id="actions-update-delay_global_validations?"><code class="inline">delay_global_validations?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If true, global validations will be done in a <code class="inline">before_action</code> hook, regardless of their configuration on the resource.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-skip_global_validations?" id="actions-update-skip_global_validations?"><code class="inline">skip_global_validations?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If true, global validations will be skipped. Useful for manual actions.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-error_handler" id="actions-update-error_handler"><code class="inline">error_handler</code></a></td><td style="text-align: left;"><code class="inline">mfa | (any, any -&gt; any)</code></td><td style="text-align: left;"></td><td style="text-align: left;">Sets the error handler on the changeset. See <a href="Ash.Changeset.xhtml#handle_errors/2"><code class="inline">Ash.Changeset.handle_errors/2</code></a> for more</td></tr><tr><td style="text-align: left;"><a href="#actions-update-notifiers" id="actions-update-notifiers"><code class="inline">notifiers</code></a></td><td style="text-align: left;"><code class="inline">list(module)</code></td><td style="text-align: left;"></td><td style="text-align: left;">Notifiers that will be called specifically for this action.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-manual?" id="actions-update-manual?"><code class="inline">manual?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"></td><td style="text-align: left;">Instructs Ash to <em>skip</em> the actual update/create/destroy step at the data layer. See the <a href="manual-actions.xhtml">manual actions guide</a> for more.</td></tr></tbody></table><h3 id="actions-update-change">actions.update.change</h3><pre><code class="makeup elixir" translate="no"><span class="n">change</span><span class="w"> </span><span class="n">change</span></code></pre><p>A change to be applied to the changeset.</p><p>See <a href="Ash.Resource.Change.xhtml"><code class="inline">Ash.Resource.Change</code></a> for more.</p><h3 id="examples-33">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">change</span><span class="w"> </span><span class="n">relate_actor</span><span class="p" data-group-id="0543833735-1">(</span><span class="ss">:reporter</span><span class="p" data-group-id="0543833735-1">)</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">change</span><span class="w"> </span><span class="p" data-group-id="3808845011-1">{</span><span class="nc">MyCustomChange</span><span class="p">,</span><span class="w"> </span><span class="ss">:foo</span><span class="p" data-group-id="3808845011-1">}</span></code></pre><h3 id="arguments-30">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-update-change-change" id="actions-update-change-change"><code class="inline">change</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The module and options for a change. Also accepts a function that takes the changeset and the context. See <a href="Ash.Resource.Change.Builtins.xhtml"><code class="inline">Ash.Resource.Change.Builtins</code></a> for builtin changes.</td></tr></tbody></table><h3 id="options-22">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-update-change-only_when_valid?" id="actions-update-change-only_when_valid?"><code class="inline">only_when_valid?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If the change should only be run on valid changes. By default, all changes are run unless stated otherwise here.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-change-description" id="actions-update-change-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the change</td></tr><tr><td style="text-align: left;"><a href="#actions-update-change-where" id="actions-update-change-where"><code class="inline">where</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | list((any, any -&gt; any) | module)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Validations that should pass in order for this change to apply. These validations failing will result in this change being ignored.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-change-always_atomic?" id="actions-update-change-always_atomic?"><code class="inline">always_atomic?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">By default, changes are only run atomically if all changes will be run atomically or if there is no <code class="inline">change/3</code> callback defined. Set this to <code class="inline">true</code> to run it atomically always.</td></tr></tbody></table><h3 id="introspection-30">Introspection</h3><p>Target: <a href="Ash.Resource.Change.xhtml"><code class="inline">Ash.Resource.Change</code></a></p><h3 id="actions-update-validate">actions.update.validate</h3><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="n">validation</span></code></pre><p>Declares a validation to be applied to the changeset.</p><p>See <a href="Ash.Resource.Validation.Builtins.xhtml"><code class="inline">Ash.Resource.Validation.Builtins</code></a> or <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a> for more.</p><h3 id="examples-34">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="n">changing</span><span class="p" data-group-id="2962282161-1">(</span><span class="ss">:email</span><span class="p" data-group-id="2962282161-1">)</span></code></pre><h3 id="arguments-31">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-update-validate-validation" id="actions-update-validate-validation"><code class="inline">validation</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The module (or module and opts) that implements the <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a> behaviour. Also accepts a function that receives the changeset and its context.</td></tr></tbody></table><h3 id="options-23">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-update-validate-where" id="actions-update-validate-where"><code class="inline">where</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | list((any, any -&gt; any) | module)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Validations that should pass in order for this validation to apply. Any of these validations failing will result in this validation being ignored.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-validate-only_when_valid?" id="actions-update-validate-only_when_valid?"><code class="inline">only_when_valid?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If the validation should only run on valid changesets. Useful for expensive validations or validations that depend on valid data.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-validate-message" id="actions-update-validate-message"><code class="inline">message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">If provided, overrides any message set by the validation error</td></tr><tr><td style="text-align: left;"><a href="#actions-update-validate-description" id="actions-update-validate-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the validation</td></tr><tr><td style="text-align: left;"><a href="#actions-update-validate-before_action?" id="actions-update-validate-before_action?"><code class="inline">before_action?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If set to <code class="inline">true</code>, the validation will be run in a before_action hook</td></tr><tr><td style="text-align: left;"><a href="#actions-update-validate-always_atomic?" id="actions-update-validate-always_atomic?"><code class="inline">always_atomic?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">By default, validations are only run atomically if all changes will be run atomically or if there is no <code class="inline">validate/3</code> callback defined. Set this to <code class="inline">true</code> to run it atomically always.</td></tr></tbody></table><h3 id="introspection-31">Introspection</h3><p>Target: <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a></p><h3 id="actions-update-metadata">actions.update.metadata</h3><pre><code class="makeup elixir" translate="no"><span class="n">metadata</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span></code></pre><p>A special kind of attribute that is only added to specific actions. Nothing sets this value, it must be set in a custom
change after_action hook via <a href="Ash.Resource.xhtml#put_metadata/3"><code class="inline">Ash.Resource.put_metadata/3</code></a>.</p><h3 id="examples-35">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">metadata</span><span class="w"> </span><span class="ss">:api_token</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">allow_nil?</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">metadata</span><span class="w"> </span><span class="ss">:operation_id</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">allow_nil?</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
</span></code></pre><h3 id="arguments-32">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-update-metadata-name" id="actions-update-metadata-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the metadata</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#actions-update-metadata-type" id="actions-update-metadata-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the metadata. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="options-24">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-update-metadata-constraints" id="actions-update-metadata-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Type constraints on the metadata</td></tr><tr><td style="text-align: left;"><a href="#actions-update-metadata-description" id="actions-update-metadata-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the metadata.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-metadata-allow_nil?" id="actions-update-metadata-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the metadata may return <code class="inline">nil</code></td></tr><tr><td style="text-align: left;"><a href="#actions-update-metadata-default" id="actions-update-metadata-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The default value for the metadata to take. It can be a zero argument function e.g <code class="inline">&amp;MyMod.my_fun/0</code> or a value</td></tr></tbody></table><h3 id="introspection-32">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Metadata.xhtml"><code class="inline">Ash.Resource.Actions.Metadata</code></a></p><h3 id="actions-update-argument">actions.update.argument</h3><pre><code class="makeup elixir" translate="no"><span class="n">argument</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span></code></pre><p>Declares an argument on the action</p><h3 id="examples-36">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">argument</span><span class="w"> </span><span class="ss">:password_confirmation</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span></code></pre><h3 id="arguments-33">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-update-argument-name" id="actions-update-argument-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the argument</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#actions-update-argument-type" id="actions-update-argument-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the argument. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="options-25">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-update-argument-description" id="actions-update-argument-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the argument.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-argument-constraints" id="actions-update-argument-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Constraints to provide to the type when casting the value. For more information, see <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a>.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-argument-allow_nil?" id="actions-update-argument-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the argument value may be nil (or may be not provided). If nil value is given error is raised.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-argument-public?" id="actions-update-argument-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the argument should appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#actions-update-argument-sensitive?" id="actions-update-argument-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the argument value contains sensitive information, like PII(Personally Identifiable Information). See the <a href="sensitive-data.xhtml">security guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-update-argument-default" id="actions-update-argument-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The default value for the argument to take. It can be a zero argument function e.g <code class="inline">&amp;MyMod.my_fun/0</code> or a value</td></tr></tbody></table><h3 id="introspection-33">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Argument.xhtml"><code class="inline">Ash.Resource.Actions.Argument</code></a></p><h3 id="introspection-34">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Update.xhtml"><code class="inline">Ash.Resource.Actions.Update</code></a></p><h3 id="actions-destroy">actions.destroy</h3><pre><code class="makeup elixir" translate="no"><span class="n">destroy</span><span class="w"> </span><span class="n">name</span></code></pre><p>Declares a <code class="inline">destroy</code> action. For calling this action, see the <a href="Ash.Domain.xhtml"><code class="inline">Ash.Domain</code></a> documentation.</p><p>See <a href="Ash.Resource.Change.Builtins.xhtml#cascade_destroy/2"><code class="inline">Ash.Resource.Change.Builtins.cascade_destroy/2</code></a> for cascading destroy operations.</p><h3 id="nested-dsls-11">Nested DSLs</h3><ul><li><a href="#actions-destroy-change">change</a></li><li><a href="#actions-destroy-validate">validate</a></li><li><a href="#actions-destroy-metadata">metadata</a></li><li><a href="#actions-destroy-argument">argument</a></li></ul><h3 id="examples-37">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">destroy</span><span class="w"> </span><span class="ss">:destroy</span><span class="w"> </span><span class="k" data-group-id="0377844218-1">do</span><span class="w">
  </span><span class="n">primary?</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="k" data-group-id="0377844218-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-34">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-destroy-name" id="actions-destroy-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the action</td></tr></tbody></table><h3 id="options-26">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-destroy-soft?" id="actions-destroy-soft?"><code class="inline">soft?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If specified, the destroy action behaves as an update internally</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-manual" id="actions-destroy-manual"><code class="inline">manual</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">Override the update behavior. Accepts a module or module and opts, or a function that takes the changeset and context. See the <a href="manual-actions.xhtml">manual actions guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-require_atomic?" id="actions-destroy-require_atomic?"><code class="inline">require_atomic?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Require that the update be atomic. Only relevant if <code class="inline">soft?</code> is set to <code class="inline">true</code>. This means that all changes and validations implement the <code class="inline">atomic</code> callback. See the guide on atomic updates for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-atomic_upgrade?" id="actions-destroy-atomic_upgrade?"><code class="inline">atomic_upgrade?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If set to <code class="inline">true</code>, atomic upgrades will be performed. See the update actions guide for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-atomic_upgrade_with" id="actions-destroy-atomic_upgrade_with"><code class="inline">atomic_upgrade_with</code></a></td><td style="text-align: left;"><code class="inline">atom | nil</code></td><td style="text-align: left;"></td><td style="text-align: left;">Configure the read action used when performing atomic upgrades. Defaults to the primary read action.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-primary?" id="actions-destroy-primary?"><code class="inline">primary?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not this action should be used when no action is specified by the caller.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-description" id="actions-destroy-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the action</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-transaction?" id="actions-destroy-transaction?"><code class="inline">transaction?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"></td><td style="text-align: left;">Whether or not the action should be run in transactions. Reads default to false, while create/update/destroy actions default to <code class="inline">true</code>.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-touches_resources" id="actions-destroy-touches_resources"><code class="inline">touches_resources</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A list of resources that the action may touch, used when building transactions.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-skip_unknown_inputs" id="actions-destroy-skip_unknown_inputs"><code class="inline">skip_unknown_inputs</code></a></td><td style="text-align: left;"><code class="inline">atom | String.t | list(atom | String.t)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A list of unknown fields to skip, or <code class="inline">:*</code> to skip all unknown fields.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-accept" id="actions-destroy-accept"><code class="inline">accept</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom) | :*</code></td><td style="text-align: left;"></td><td style="text-align: left;">The list of attributes to accept. Use <code class="inline">:*</code> to accept all public attributes.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-action_select" id="actions-destroy-action_select"><code class="inline">action_select</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A list of attributes that the action requires to do its work. Defaults to all attributes except those with <code class="inline">select_by_default? false</code>. On actions with no changes/notifiers, it defaults to the externally selected attributes. Keep in mind that action_select is applied <em>before</em> notifiers.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-require_attributes" id="actions-destroy-require_attributes"><code class="inline">require_attributes</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A list of attributes that would normally <code class="inline">allow_nil?</code>, to require for this action. No need to include attributes that already do not allow nil?</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-allow_nil_input" id="actions-destroy-allow_nil_input"><code class="inline">allow_nil_input</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A list of attributes that would normally be required, but should not be for this action. They will still be validated just before the data layer step.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-delay_global_validations?" id="actions-destroy-delay_global_validations?"><code class="inline">delay_global_validations?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If true, global validations will be done in a <code class="inline">before_action</code> hook, regardless of their configuration on the resource.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-skip_global_validations?" id="actions-destroy-skip_global_validations?"><code class="inline">skip_global_validations?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If true, global validations will be skipped. Useful for manual actions.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-error_handler" id="actions-destroy-error_handler"><code class="inline">error_handler</code></a></td><td style="text-align: left;"><code class="inline">mfa | (any, any -&gt; any)</code></td><td style="text-align: left;"></td><td style="text-align: left;">Sets the error handler on the changeset. See <a href="Ash.Changeset.xhtml#handle_errors/2"><code class="inline">Ash.Changeset.handle_errors/2</code></a> for more</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-notifiers" id="actions-destroy-notifiers"><code class="inline">notifiers</code></a></td><td style="text-align: left;"><code class="inline">list(module)</code></td><td style="text-align: left;"></td><td style="text-align: left;">Notifiers that will be called specifically for this action.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-manual?" id="actions-destroy-manual?"><code class="inline">manual?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"></td><td style="text-align: left;">Instructs Ash to <em>skip</em> the actual update/create/destroy step at the data layer. See the <a href="manual-actions.xhtml">manual actions guide</a> for more.</td></tr></tbody></table><h3 id="actions-destroy-change">actions.destroy.change</h3><pre><code class="makeup elixir" translate="no"><span class="n">change</span><span class="w"> </span><span class="n">change</span></code></pre><p>A change to be applied to the changeset.</p><p>See <a href="Ash.Resource.Change.xhtml"><code class="inline">Ash.Resource.Change</code></a> for more.</p><h3 id="examples-38">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">change</span><span class="w"> </span><span class="n">relate_actor</span><span class="p" data-group-id="5931590213-1">(</span><span class="ss">:reporter</span><span class="p" data-group-id="5931590213-1">)</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">change</span><span class="w"> </span><span class="p" data-group-id="7528143953-1">{</span><span class="nc">MyCustomChange</span><span class="p">,</span><span class="w"> </span><span class="ss">:foo</span><span class="p" data-group-id="7528143953-1">}</span></code></pre><h3 id="arguments-35">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-destroy-change-change" id="actions-destroy-change-change"><code class="inline">change</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The module and options for a change. Also accepts a function that takes the changeset and the context. See <a href="Ash.Resource.Change.Builtins.xhtml"><code class="inline">Ash.Resource.Change.Builtins</code></a> for builtin changes.</td></tr></tbody></table><h3 id="options-27">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-destroy-change-only_when_valid?" id="actions-destroy-change-only_when_valid?"><code class="inline">only_when_valid?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If the change should only be run on valid changes. By default, all changes are run unless stated otherwise here.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-change-description" id="actions-destroy-change-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the change</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-change-where" id="actions-destroy-change-where"><code class="inline">where</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | list((any, any -&gt; any) | module)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Validations that should pass in order for this change to apply. These validations failing will result in this change being ignored.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-change-always_atomic?" id="actions-destroy-change-always_atomic?"><code class="inline">always_atomic?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">By default, changes are only run atomically if all changes will be run atomically or if there is no <code class="inline">change/3</code> callback defined. Set this to <code class="inline">true</code> to run it atomically always.</td></tr></tbody></table><h3 id="introspection-35">Introspection</h3><p>Target: <a href="Ash.Resource.Change.xhtml"><code class="inline">Ash.Resource.Change</code></a></p><h3 id="actions-destroy-validate">actions.destroy.validate</h3><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="n">validation</span></code></pre><p>Declares a validation to be applied to the changeset.</p><p>See <a href="Ash.Resource.Validation.Builtins.xhtml"><code class="inline">Ash.Resource.Validation.Builtins</code></a> or <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a> for more.</p><h3 id="examples-39">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="n">changing</span><span class="p" data-group-id="3736947139-1">(</span><span class="ss">:email</span><span class="p" data-group-id="3736947139-1">)</span></code></pre><h3 id="arguments-36">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-destroy-validate-validation" id="actions-destroy-validate-validation"><code class="inline">validation</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The module (or module and opts) that implements the <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a> behaviour. Also accepts a function that receives the changeset and its context.</td></tr></tbody></table><h3 id="options-28">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-destroy-validate-where" id="actions-destroy-validate-where"><code class="inline">where</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | list((any, any -&gt; any) | module)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Validations that should pass in order for this validation to apply. Any of these validations failing will result in this validation being ignored.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-validate-only_when_valid?" id="actions-destroy-validate-only_when_valid?"><code class="inline">only_when_valid?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If the validation should only run on valid changesets. Useful for expensive validations or validations that depend on valid data.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-validate-message" id="actions-destroy-validate-message"><code class="inline">message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">If provided, overrides any message set by the validation error</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-validate-description" id="actions-destroy-validate-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the validation</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-validate-before_action?" id="actions-destroy-validate-before_action?"><code class="inline">before_action?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If set to <code class="inline">true</code>, the validation will be run in a before_action hook</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-validate-always_atomic?" id="actions-destroy-validate-always_atomic?"><code class="inline">always_atomic?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">By default, validations are only run atomically if all changes will be run atomically or if there is no <code class="inline">validate/3</code> callback defined. Set this to <code class="inline">true</code> to run it atomically always.</td></tr></tbody></table><h3 id="introspection-36">Introspection</h3><p>Target: <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a></p><h3 id="actions-destroy-metadata">actions.destroy.metadata</h3><pre><code class="makeup elixir" translate="no"><span class="n">metadata</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span></code></pre><p>A special kind of attribute that is only added to specific actions. Nothing sets this value, it must be set in a custom
change after_action hook via <a href="Ash.Resource.xhtml#put_metadata/3"><code class="inline">Ash.Resource.put_metadata/3</code></a>.</p><h3 id="examples-40">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">metadata</span><span class="w"> </span><span class="ss">:api_token</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">allow_nil?</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">metadata</span><span class="w"> </span><span class="ss">:operation_id</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">allow_nil?</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
</span></code></pre><h3 id="arguments-37">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-destroy-metadata-name" id="actions-destroy-metadata-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the metadata</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#actions-destroy-metadata-type" id="actions-destroy-metadata-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the metadata. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="options-29">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-destroy-metadata-constraints" id="actions-destroy-metadata-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Type constraints on the metadata</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-metadata-description" id="actions-destroy-metadata-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the metadata.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-metadata-allow_nil?" id="actions-destroy-metadata-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the metadata may return <code class="inline">nil</code></td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-metadata-default" id="actions-destroy-metadata-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The default value for the metadata to take. It can be a zero argument function e.g <code class="inline">&amp;MyMod.my_fun/0</code> or a value</td></tr></tbody></table><h3 id="introspection-37">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Metadata.xhtml"><code class="inline">Ash.Resource.Actions.Metadata</code></a></p><h3 id="actions-destroy-argument">actions.destroy.argument</h3><pre><code class="makeup elixir" translate="no"><span class="n">argument</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span></code></pre><p>Declares an argument on the action</p><h3 id="examples-41">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">argument</span><span class="w"> </span><span class="ss">:password_confirmation</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span></code></pre><h3 id="arguments-38">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#actions-destroy-argument-name" id="actions-destroy-argument-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the argument</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#actions-destroy-argument-type" id="actions-destroy-argument-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the argument. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="options-30">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#actions-destroy-argument-description" id="actions-destroy-argument-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the argument.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-argument-constraints" id="actions-destroy-argument-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Constraints to provide to the type when casting the value. For more information, see <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a>.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-argument-allow_nil?" id="actions-destroy-argument-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the argument value may be nil (or may be not provided). If nil value is given error is raised.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-argument-public?" id="actions-destroy-argument-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the argument should appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-argument-sensitive?" id="actions-destroy-argument-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the argument value contains sensitive information, like PII(Personally Identifiable Information). See the <a href="sensitive-data.xhtml">security guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#actions-destroy-argument-default" id="actions-destroy-argument-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The default value for the argument to take. It can be a zero argument function e.g <code class="inline">&amp;MyMod.my_fun/0</code> or a value</td></tr></tbody></table><h3 id="introspection-38">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Argument.xhtml"><code class="inline">Ash.Resource.Actions.Argument</code></a></p><h3 id="introspection-39">Introspection</h3><p>Target: <a href="Ash.Resource.Actions.Destroy.xhtml"><code class="inline">Ash.Resource.Actions.Destroy</code></a></p><h2 id="code_interface">code_interface</h2><p>Functions that will be defined on the resource. See the <a href="code-interfaces.xhtml">code interface guide</a> for more.</p><h3 id="nested-dsls-12">Nested DSLs</h3><ul><li><a href="#code_interface-define">define</a><ul><li>custom_input<ul><li>transform</li></ul></li></ul></li><li><a href="#code_interface-define_calculation">define_calculation</a><ul><li>custom_input<ul><li>transform</li></ul></li></ul></li></ul><h3 id="examples-42">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">code_interface</span><span class="w"> </span><span class="k" data-group-id="9247181718-1">do</span><span class="w">
  </span><span class="n">define</span><span class="w"> </span><span class="ss">:create_user</span><span class="p">,</span><span class="w"> </span><span class="ss">action</span><span class="p">:</span><span class="w"> </span><span class="ss">:create</span><span class="w">
  </span><span class="n">define</span><span class="w"> </span><span class="ss">:get_user_by_id</span><span class="p">,</span><span class="w"> </span><span class="ss">action</span><span class="p">:</span><span class="w"> </span><span class="ss">:get_by_id</span><span class="p">,</span><span class="w"> </span><span class="ss">args</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9247181718-2">[</span><span class="ss">:id</span><span class="p" data-group-id="9247181718-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">get?</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="k" data-group-id="9247181718-1">end</span><span class="w">
</span></code></pre><h3 id="options-31">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#code_interface-domain" id="code_interface-domain"><code class="inline">domain</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Use the provided Domain instead of the resources configured domain when calling actions.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define?" id="code_interface-define?"><code class="inline">define?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"></td><td style="text-align: left;">Whether or not to define the code interface in the resource.</td></tr></tbody></table><h3 id="code_interface-define">code_interface.define</h3><pre><code class="makeup elixir" translate="no"><span class="n">define</span><span class="w"> </span><span class="n">name</span></code></pre><p>Defines a function with the corresponding name and arguments. See the <a href="code-interfaces.xhtml">code interface guide</a> for more.</p><h3 id="nested-dsls-13">Nested DSLs</h3><ul><li><a href="#code_interface-define-custom_input">custom_input</a><ul><li>transform</li></ul></li></ul><h3 id="examples-43">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">define</span><span class="w"> </span><span class="ss">:get_user_by_id</span><span class="p">,</span><span class="w"> </span><span class="ss">action</span><span class="p">:</span><span class="w"> </span><span class="ss">:get_by_id</span><span class="p">,</span><span class="w"> </span><span class="ss">args</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1603546571-1">[</span><span class="ss">:id</span><span class="p" data-group-id="1603546571-1">]</span><span class="p">,</span><span class="w"> </span><span class="ss">get?</span><span class="p">:</span><span class="w"> </span><span class="no">true</span></code></pre><h3 id="arguments-39">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#code_interface-define-name" id="code_interface-define-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the function that will be defined</td></tr></tbody></table><h3 id="options-32">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#code_interface-define-action" id="code_interface-define-action"><code class="inline">action</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the action that will be called. Defaults to the same name as the function.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define-args" id="code_interface-define-args"><code class="inline">args</code></a></td><td style="text-align: left;"><code class="inline">list(atom | {:optional, atom})</code></td><td style="text-align: left;"></td><td style="text-align: left;">Map specific arguments to named inputs. Can provide any argument/attributes that the action allows.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define-not_found_error?" id="code_interface-define-not_found_error?"><code class="inline">not_found_error?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">If the action or interface is configured with <code class="inline">get?: true</code>, this determines whether or not an error is raised or <code class="inline">nil</code> is returned.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define-require_reference?" id="code_interface-define-require_reference?"><code class="inline">require_reference?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">For update and destroy actions, require a resource or identifier to be passed in as the first argument. Not relevant for other action types.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define-exclude_inputs" id="code_interface-define-exclude_inputs"><code class="inline">exclude_inputs</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A list of action inputs to not accept in the defined interface</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define-get?" id="code_interface-define-get?"><code class="inline">get?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Expects to only receive a single result from a read action or a bulk update/destroy, and returns a single result instead of a list. Sets <code class="inline">require_reference?</code> to false automatically.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define-get_by" id="code_interface-define-get_by"><code class="inline">get_by</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">Takes a list of fields and adds those fields as arguments, which will then be used to filter. Sets <code class="inline">get?</code> to true and <code class="inline">require_reference?</code> to false automatically. Adds filters for read, update and destroy actions, replacing the <code class="inline">record</code> first argument.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define-get_by_identity" id="code_interface-define-get_by_identity"><code class="inline">get_by_identity</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">Takes an identity, gets its field list, and performs the same logic as <code class="inline">get_by</code> with those fields. Adds filters for read, update and destroy actions, replacing the <code class="inline">record</code> first argument.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define-default_options" id="code_interface-define-default_options"><code class="inline">default_options</code></a></td><td style="text-align: left;"><code class="inline">keyword | (-&gt; any)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Default options to be merged with client-provided options. These can override domain or action defaults. <code class="inline">:load</code>, <code class="inline">:bulk_options</code>, and <code class="inline">:page</code> options will be deep merged. Can be a keyword list or a zero-arity function that returns a keyword list.</td></tr></tbody></table><h3 id="code_interface-define-custom_input">code_interface.define.custom_input</h3><pre><code class="makeup elixir" translate="no"><span class="n">custom_input</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span></code></pre><p>Define or customize an input to the action.</p><p>See the <a href="code-interfaces.xhtml">code interface guide</a> for more.</p><h3 id="nested-dsls-14">Nested DSLs</h3><ul><li><a href="#code_interface-define-custom_input-transform">transform</a></li></ul><h3 id="examples-44">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">custom_input</span><span class="w"> </span><span class="ss">:artist</span><span class="p">,</span><span class="w"> </span><span class="ss">:struct</span><span class="w"> </span><span class="k" data-group-id="1324731726-1">do</span><span class="w">
  </span><span class="n">transform</span><span class="w"> </span><span class="ss">to</span><span class="p">:</span><span class="w"> </span><span class="ss">:artist_id</span><span class="p">,</span><span class="w"> </span><span class="ss">using</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="p" data-group-id="1324731726-2">(</span><span class="ni">&amp;1</span><span class="o">.</span><span class="n">id</span><span class="p" data-group-id="1324731726-2">)</span><span class="w">

  </span><span class="n">constraints</span><span class="w"> </span><span class="ss">instance_of</span><span class="p">:</span><span class="w"> </span><span class="nc">Artist</span><span class="w">
</span><span class="k" data-group-id="1324731726-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-40">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#code_interface-define-custom_input-name" id="code_interface-define-custom_input-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the argument</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#code_interface-define-custom_input-type" id="code_interface-define-custom_input-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the argument. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="options-33">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#code_interface-define-custom_input-description" id="code_interface-define-custom_input-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the argument.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define-custom_input-constraints" id="code_interface-define-custom_input-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Constraints to provide to the type when casting the value. For more information, see <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a>.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define-custom_input-allow_nil?" id="code_interface-define-custom_input-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the argument value may be nil (or may be not provided). If nil value is given error is raised.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define-custom_input-sensitive?" id="code_interface-define-custom_input-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the argument value contains sensitive information, like PII(Personally Identifiable Information). See the <a href="sensitive-data.xhtml">security guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define-custom_input-default" id="code_interface-define-custom_input-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The default value for the argument to take. It can be a zero argument function e.g <code class="inline">&amp;MyMod.my_fun/0</code> or a value</td></tr></tbody></table><h3 id="code_interface-define-custom_input-transform">code_interface.define.custom_input.transform</h3><p>A transformation to be applied to the custom input.</p><h3 id="examples-45">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">transform</span><span class="w"> </span><span class="k" data-group-id="9607221655-1">do</span><span class="w">
  </span><span class="n">to</span><span class="w"> </span><span class="ss">:artist_id</span><span class="w">
  </span><span class="n">using</span><span class="w"> </span><span class="o">&amp;</span><span class="p" data-group-id="9607221655-2">(</span><span class="ni">&amp;1</span><span class="o">.</span><span class="n">id</span><span class="p" data-group-id="9607221655-2">)</span><span class="w">
</span><span class="k" data-group-id="9607221655-1">end</span><span class="w">
</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">transform</span><span class="w"> </span><span class="k" data-group-id="7465227806-1">do</span><span class="w">
  </span><span class="n">to</span><span class="w"> </span><span class="ss">:points</span><span class="w">
  </span><span class="n">using</span><span class="w"> </span><span class="o">&amp;</span><span class="n">try_parse_integer</span><span class="o">/</span><span class="mi">1</span><span class="w">
</span><span class="k" data-group-id="7465227806-1">end</span><span class="w">
</span></code></pre><h3 id="options-34">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#code_interface-define-custom_input-transform-to" id="code_interface-define-custom_input-transform-to"><code class="inline">to</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">A key to rewrite the argument to. If the custom input is also a required positional argument, then the <code class="inline">to</code> is automatically added to the <code class="inline">exclude_inputs</code> list.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define-custom_input-transform-using" id="code_interface-define-custom_input-transform-using"><code class="inline">using</code></a></td><td style="text-align: left;"><code class="inline">(any -&gt; any)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A function to use to transform the value. Must return <code class="inline">value</code> or <code class="inline">nil</code></td></tr></tbody></table><h3 id="introspection-40">Introspection</h3><p>Target: <a href="Ash.Resource.Interface.CustomInput.Transform.xhtml"><code class="inline">Ash.Resource.Interface.CustomInput.Transform</code></a></p><h3 id="introspection-41">Introspection</h3><p>Target: <a href="Ash.Resource.Interface.CustomInput.xhtml"><code class="inline">Ash.Resource.Interface.CustomInput</code></a></p><h3 id="introspection-42">Introspection</h3><p>Target: <a href="Ash.Resource.Interface.xhtml"><code class="inline">Ash.Resource.Interface</code></a></p><h3 id="code_interface-define_calculation">code_interface.define_calculation</h3><pre><code class="makeup elixir" translate="no"><span class="n">define_calculation</span><span class="w"> </span><span class="n">name</span></code></pre><p>Defines a function with the corresponding name and arguments, that evaluates a calculation. Use <code class="inline">:_record</code> to take an instance of a record. See the <a href="code-interfaces.xhtml">code interface guide</a> for more.</p><h3 id="nested-dsls-15">Nested DSLs</h3><ul><li><a href="#code_interface-define_calculation-custom_input">custom_input</a><ul><li>transform</li></ul></li></ul><h3 id="examples-46">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">define_calculation</span><span class="w"> </span><span class="ss">:referral_link</span><span class="p">,</span><span class="w"> </span><span class="ss">args</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1197244028-1">[</span><span class="ss">:id</span><span class="p" data-group-id="1197244028-1">]</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">define_calculation</span><span class="w"> </span><span class="ss">:referral_link</span><span class="p">,</span><span class="w"> </span><span class="ss">args</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4891132789-1">[</span><span class="p" data-group-id="4891132789-2">{</span><span class="ss">:arg</span><span class="p">,</span><span class="w"> </span><span class="ss">:id</span><span class="p" data-group-id="4891132789-2">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4891132789-3">{</span><span class="ss">:ref</span><span class="p">,</span><span class="w"> </span><span class="ss">:id</span><span class="p" data-group-id="4891132789-3">}</span><span class="p" data-group-id="4891132789-1">]</span></code></pre><h3 id="arguments-41">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#code_interface-define_calculation-name" id="code_interface-define_calculation-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the function that will be defined</td></tr></tbody></table><h3 id="options-35">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#code_interface-define_calculation-calculation" id="code_interface-define_calculation-calculation"><code class="inline">calculation</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the calculation that will be evaluated. Defaults to the same name as the function.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define_calculation-exclude_inputs" id="code_interface-define_calculation-exclude_inputs"><code class="inline">exclude_inputs</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A list of calculation inputs to not accept in the defined interface</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define_calculation-args" id="code_interface-define_calculation-args"><code class="inline">args</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Supply field or argument values referenced by the calculation, in the form of :name, <code class="inline">{:arg, :name}</code> and/or <code class="inline">{:ref, :name}</code>. See the <a href="code-interfaces.xhtml">code interface guide</a> for more.</td></tr></tbody></table><h3 id="code_interface-define_calculation-custom_input">code_interface.define_calculation.custom_input</h3><pre><code class="makeup elixir" translate="no"><span class="n">custom_input</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span></code></pre><p>Define or customize an input to the action.</p><p>See the <a href="code-interfaces.xhtml">code interface guide</a> for more.</p><h3 id="nested-dsls-16">Nested DSLs</h3><ul><li><a href="#code_interface-define_calculation-custom_input-transform">transform</a></li></ul><h3 id="examples-47">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">custom_input</span><span class="w"> </span><span class="ss">:artist</span><span class="p">,</span><span class="w"> </span><span class="ss">:struct</span><span class="w"> </span><span class="k" data-group-id="7846931016-1">do</span><span class="w">
  </span><span class="n">transform</span><span class="w"> </span><span class="ss">to</span><span class="p">:</span><span class="w"> </span><span class="ss">:artist_id</span><span class="p">,</span><span class="w"> </span><span class="ss">using</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="p" data-group-id="7846931016-2">(</span><span class="ni">&amp;1</span><span class="o">.</span><span class="n">id</span><span class="p" data-group-id="7846931016-2">)</span><span class="w">

  </span><span class="n">constraints</span><span class="w"> </span><span class="ss">instance_of</span><span class="p">:</span><span class="w"> </span><span class="nc">Artist</span><span class="w">
</span><span class="k" data-group-id="7846931016-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-42">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#code_interface-define_calculation-custom_input-name" id="code_interface-define_calculation-custom_input-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the argument</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#code_interface-define_calculation-custom_input-type" id="code_interface-define_calculation-custom_input-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the argument. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="options-36">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#code_interface-define_calculation-custom_input-description" id="code_interface-define_calculation-custom_input-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the argument.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define_calculation-custom_input-constraints" id="code_interface-define_calculation-custom_input-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Constraints to provide to the type when casting the value. For more information, see <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a>.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define_calculation-custom_input-allow_nil?" id="code_interface-define_calculation-custom_input-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the argument value may be nil (or may be not provided). If nil value is given error is raised.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define_calculation-custom_input-sensitive?" id="code_interface-define_calculation-custom_input-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the argument value contains sensitive information, like PII(Personally Identifiable Information). See the <a href="sensitive-data.xhtml">security guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define_calculation-custom_input-default" id="code_interface-define_calculation-custom_input-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The default value for the argument to take. It can be a zero argument function e.g <code class="inline">&amp;MyMod.my_fun/0</code> or a value</td></tr></tbody></table><h3 id="code_interface-define_calculation-custom_input-transform">code_interface.define_calculation.custom_input.transform</h3><p>A transformation to be applied to the custom input.</p><h3 id="examples-48">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">transform</span><span class="w"> </span><span class="k" data-group-id="3434885953-1">do</span><span class="w">
  </span><span class="n">to</span><span class="w"> </span><span class="ss">:artist_id</span><span class="w">
  </span><span class="n">using</span><span class="w"> </span><span class="o">&amp;</span><span class="p" data-group-id="3434885953-2">(</span><span class="ni">&amp;1</span><span class="o">.</span><span class="n">id</span><span class="p" data-group-id="3434885953-2">)</span><span class="w">
</span><span class="k" data-group-id="3434885953-1">end</span><span class="w">
</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">transform</span><span class="w"> </span><span class="k" data-group-id="0380362333-1">do</span><span class="w">
  </span><span class="n">to</span><span class="w"> </span><span class="ss">:points</span><span class="w">
  </span><span class="n">using</span><span class="w"> </span><span class="o">&amp;</span><span class="n">try_parse_integer</span><span class="o">/</span><span class="mi">1</span><span class="w">
</span><span class="k" data-group-id="0380362333-1">end</span><span class="w">
</span></code></pre><h3 id="options-37">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#code_interface-define_calculation-custom_input-transform-to" id="code_interface-define_calculation-custom_input-transform-to"><code class="inline">to</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">A key to rewrite the argument to. If the custom input is also a required positional argument, then the <code class="inline">to</code> is automatically added to the <code class="inline">exclude_inputs</code> list.</td></tr><tr><td style="text-align: left;"><a href="#code_interface-define_calculation-custom_input-transform-using" id="code_interface-define_calculation-custom_input-transform-using"><code class="inline">using</code></a></td><td style="text-align: left;"><code class="inline">(any -&gt; any)</code></td><td style="text-align: left;"></td><td style="text-align: left;">A function to use to transform the value. Must return <code class="inline">value</code> or <code class="inline">nil</code></td></tr></tbody></table><h3 id="introspection-43">Introspection</h3><p>Target: <a href="Ash.Resource.Interface.CustomInput.Transform.xhtml"><code class="inline">Ash.Resource.Interface.CustomInput.Transform</code></a></p><h3 id="introspection-44">Introspection</h3><p>Target: <a href="Ash.Resource.Interface.CustomInput.xhtml"><code class="inline">Ash.Resource.Interface.CustomInput</code></a></p><h3 id="introspection-45">Introspection</h3><p>Target: <a href="Ash.Resource.CalculationInterface.xhtml"><code class="inline">Ash.Resource.CalculationInterface</code></a></p><h2 id="resource">resource</h2><p>General resource configuration</p><h3 id="examples-49">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">resource</span><span class="w"> </span><span class="k" data-group-id="2742324752-1">do</span><span class="w">
  </span><span class="n">description</span><span class="w"> </span><span class="s">&quot;A description of this resource&quot;</span><span class="w">
  </span><span class="n">base_filter</span><span class="w"> </span><span class="p" data-group-id="2742324752-2">[</span><span class="ss">is_nil</span><span class="p">:</span><span class="w"> </span><span class="ss">:deleted_at</span><span class="p" data-group-id="2742324752-2">]</span><span class="w">
</span><span class="k" data-group-id="2742324752-1">end</span><span class="w">
</span></code></pre><h3 id="options-38">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#resource-description" id="resource-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">A human readable description of the resource, to be used in generated documentation</td></tr><tr><td style="text-align: left;"><a href="#resource-base_filter" id="resource-base_filter"><code class="inline">base_filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A filter statement to be applied to any queries on the resource</td></tr><tr><td style="text-align: left;"><a href="#resource-default_context" id="resource-default_context"><code class="inline">default_context</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">Default context to apply to any queries/changesets generated for this resource.</td></tr><tr><td style="text-align: left;"><a href="#resource-trace_name" id="resource-trace_name"><code class="inline">trace_name</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name to use in traces. Defaults to the short_name stringified. See the <a href="monitoring.xhtml">monitoring guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#resource-short_name" id="resource-short_name"><code class="inline">short_name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">A short identifier for the resource, which should be unique. See the <a href="monitoring.xhtml">monitoring guide</a> for more.</td></tr><tr><td style="text-align: left;"><a href="#resource-inspect_private_fields?" id="resource-inspect_private_fields?"><code class="inline">inspect_private_fields?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether to include private fields in the inspect output. <code class="inline">show_inspect_fields</code> takes precedence over this option.</td></tr><tr><td style="text-align: left;"><a href="#resource-hide_inspect_fields" id="resource-hide_inspect_fields"><code class="inline">hide_inspect_fields</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A deny-list of fields to hide from the inspect output. Takes precedence over <code class="inline">show_inspect_fields</code>.</td></tr><tr><td style="text-align: left;"><a href="#resource-show_inspect_fields" id="resource-show_inspect_fields"><code class="inline">show_inspect_fields</code></a></td><td style="text-align: left;"><code class="inline">list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">An allow-list of fields to show in the inspect output. Sensitive fields are <em>always</em> hidden.</td></tr><tr><td style="text-align: left;"><a href="#resource-plural_name" id="resource-plural_name"><code class="inline">plural_name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">A pluralized version of the resource short_name. May be used by generators or automated tooling.</td></tr><tr><td style="text-align: left;"><a href="#resource-require_primary_key?" id="resource-require_primary_key?"><code class="inline">require_primary_key?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Allow the resource to be used without any primary key fields. Warning: this option is experimental, and should not be used unless you know what you're doing.</td></tr></tbody></table><h2 id="identities">identities</h2><p>Unique identifiers for the resource</p><h3 id="nested-dsls-17">Nested DSLs</h3><ul><li><a href="#identities-identity">identity</a></li></ul><h3 id="examples-50">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">identities</span><span class="w"> </span><span class="k" data-group-id="1558581750-1">do</span><span class="w">
  </span><span class="n">identity</span><span class="w"> </span><span class="ss">:full_name</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1558581750-2">[</span><span class="ss">:first_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:last_name</span><span class="p" data-group-id="1558581750-2">]</span><span class="w">
  </span><span class="n">identity</span><span class="w"> </span><span class="ss">:email</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1558581750-3">[</span><span class="ss">:email</span><span class="p" data-group-id="1558581750-3">]</span><span class="w">
</span><span class="k" data-group-id="1558581750-1">end</span><span class="w">
</span></code></pre><h3 id="identities-identity">identities.identity</h3><pre><code class="makeup elixir" translate="no"><span class="n">identity</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">keys</span></code></pre><p>Represents a unique constraint on the resource.</p><p>See the <a href="identities.xhtml">identities guide</a> for more.</p><h3 id="examples-51">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">identity</span><span class="w"> </span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8547106520-1">[</span><span class="ss">:name</span><span class="p" data-group-id="8547106520-1">]</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">identity</span><span class="w"> </span><span class="ss">:full_name</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6912498827-1">[</span><span class="ss">:first_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:last_name</span><span class="p" data-group-id="6912498827-1">]</span></code></pre><h3 id="arguments-43">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#identities-identity-name" id="identities-identity-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the identity.</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#identities-identity-keys" id="identities-identity-keys"><code class="inline">keys</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The names of the attributes that uniquely identify this resource.</td></tr></tbody></table><h3 id="options-39">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#identities-identity-where" id="identities-identity-where"><code class="inline">where</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A filter that expresses only matching records are unique on the provided keys. Ignored on embedded resources.</td></tr><tr><td style="text-align: left;"><a href="#identities-identity-nils_distinct?" id="identities-identity-nils_distinct?"><code class="inline">nils_distinct?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not <code class="inline">nil</code> values are considered always distinct from eachother. <code class="inline">nil</code> values won't conflict with eachother unless you set this option to <code class="inline">false</code>.</td></tr><tr><td style="text-align: left;"><a href="#identities-identity-eager_check?" id="identities-identity-eager_check?"><code class="inline">eager_check?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not this identity is validated to be unique at validation time.</td></tr><tr><td style="text-align: left;"><a href="#identities-identity-eager_check_with" id="identities-identity-eager_check_with"><code class="inline">eager_check_with</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">Validates that the unique identity provided is unique at validation time, outside of any transactions, using the domain module provided. Will default to resource's domain.</td></tr><tr><td style="text-align: left;"><a href="#identities-identity-pre_check?" id="identities-identity-pre_check?"><code class="inline">pre_check?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not this identity is validated to be unique in a before_action hook.</td></tr><tr><td style="text-align: left;"><a href="#identities-identity-pre_check_with" id="identities-identity-pre_check_with"><code class="inline">pre_check_with</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">Validates that the unique identity provided is unique in a before_action hook.</td></tr><tr><td style="text-align: left;"><a href="#identities-identity-description" id="identities-identity-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the identity</td></tr><tr><td style="text-align: left;"><a href="#identities-identity-field_names" id="identities-identity-field_names"><code class="inline">field_names</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field names to hold errors when unique identity is violated.</td></tr><tr><td style="text-align: left;"><a href="#identities-identity-message" id="identities-identity-message"><code class="inline">message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An error message to use when the unique identity would be violated</td></tr><tr><td style="text-align: left;"><a href="#identities-identity-all_tenants?" id="identities-identity-all_tenants?"><code class="inline">all_tenants?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not this identity is unique across all tenants. If the resource is not multitenant, has no effect.</td></tr></tbody></table><h3 id="introspection-46">Introspection</h3><p>Target: <a href="Ash.Resource.Identity.xhtml"><code class="inline">Ash.Resource.Identity</code></a></p><h2 id="changes">changes</h2><p>Declare changes that occur on create/update/destroy actions against the resource</p><p>See <a href="Ash.Resource.Change.xhtml"><code class="inline">Ash.Resource.Change</code></a> for more.</p><h3 id="nested-dsls-18">Nested DSLs</h3><ul><li><a href="#changes-change">change</a></li></ul><h3 id="examples-52">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">changes</span><span class="w"> </span><span class="k" data-group-id="9885490019-1">do</span><span class="w">
  </span><span class="n">change</span><span class="w"> </span><span class="p" data-group-id="9885490019-2">{</span><span class="nc">Mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9885490019-3">[</span><span class="ss">foo</span><span class="p">:</span><span class="w"> </span><span class="ss">:bar</span><span class="p" data-group-id="9885490019-3">]</span><span class="p" data-group-id="9885490019-2">}</span><span class="w">
  </span><span class="n">change</span><span class="w"> </span><span class="n">set_context</span><span class="p" data-group-id="9885490019-4">(</span><span class="p" data-group-id="9885490019-5">%{</span><span class="ss">some</span><span class="p">:</span><span class="w"> </span><span class="ss">:context</span><span class="p" data-group-id="9885490019-5">}</span><span class="p" data-group-id="9885490019-4">)</span><span class="w">
</span><span class="k" data-group-id="9885490019-1">end</span><span class="w">
</span></code></pre><h3 id="changes-change">changes.change</h3><pre><code class="makeup elixir" translate="no"><span class="n">change</span><span class="w"> </span><span class="n">change</span></code></pre><p>A change to be applied to the changeset.</p><p>See <a href="Ash.Resource.Change.xhtml"><code class="inline">Ash.Resource.Change</code></a> for more.</p><h3 id="examples-53">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">change</span><span class="w"> </span><span class="n">relate_actor</span><span class="p" data-group-id="7194845972-1">(</span><span class="ss">:reporter</span><span class="p" data-group-id="7194845972-1">)</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">change</span><span class="w"> </span><span class="p" data-group-id="4873182542-1">{</span><span class="nc">MyCustomChange</span><span class="p">,</span><span class="w"> </span><span class="ss">:foo</span><span class="p" data-group-id="4873182542-1">}</span></code></pre><h3 id="arguments-44">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#changes-change-change" id="changes-change-change"><code class="inline">change</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The module and options for a change. Also accepts a function that takes the changeset and the context. See <a href="Ash.Resource.Change.Builtins.xhtml"><code class="inline">Ash.Resource.Change.Builtins</code></a> for builtin changes.</td></tr></tbody></table><h3 id="options-40">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#changes-change-on" id="changes-change-on"><code class="inline">on</code></a></td><td style="text-align: left;"><code class="inline">:create | :update | :destroy | list(:create | :update | :destroy)</code></td><td style="text-align: left;"><code class="inline">[:create, :update]</code></td><td style="text-align: left;">The action types the change should run on. Destroy actions are omitted by default as most changes don't make sense for a destroy.</td></tr><tr><td style="text-align: left;"><a href="#changes-change-only_when_valid?" id="changes-change-only_when_valid?"><code class="inline">only_when_valid?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If the change should only be run on valid changes. By default, all changes are run unless stated otherwise here.</td></tr><tr><td style="text-align: left;"><a href="#changes-change-description" id="changes-change-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the change</td></tr><tr><td style="text-align: left;"><a href="#changes-change-where" id="changes-change-where"><code class="inline">where</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | list((any, any -&gt; any) | module)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Validations that should pass in order for this change to apply. These validations failing will result in this change being ignored.</td></tr><tr><td style="text-align: left;"><a href="#changes-change-always_atomic?" id="changes-change-always_atomic?"><code class="inline">always_atomic?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">By default, changes are only run atomically if all changes will be run atomically or if there is no <code class="inline">change/3</code> callback defined. Set this to <code class="inline">true</code> to run it atomically always.</td></tr></tbody></table><h3 id="introspection-47">Introspection</h3><p>Target: <a href="Ash.Resource.Change.xhtml"><code class="inline">Ash.Resource.Change</code></a></p><h2 id="preparations">preparations</h2><p>Declare preparations that occur on all read actions for a given resource</p><h3 id="nested-dsls-19">Nested DSLs</h3><ul><li><a href="#preparations-prepare">prepare</a></li></ul><h3 id="examples-54">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">preparations</span><span class="w"> </span><span class="k" data-group-id="5786447098-1">do</span><span class="w">
  </span><span class="n">prepare</span><span class="w"> </span><span class="p" data-group-id="5786447098-2">{</span><span class="nc">Mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5786447098-3">[</span><span class="ss">foo</span><span class="p">:</span><span class="w"> </span><span class="ss">:bar</span><span class="p" data-group-id="5786447098-3">]</span><span class="p" data-group-id="5786447098-2">}</span><span class="w">
  </span><span class="n">prepare</span><span class="w"> </span><span class="n">set_context</span><span class="p" data-group-id="5786447098-4">(</span><span class="p" data-group-id="5786447098-5">%{</span><span class="ss">some</span><span class="p">:</span><span class="w"> </span><span class="ss">:context</span><span class="p" data-group-id="5786447098-5">}</span><span class="p" data-group-id="5786447098-4">)</span><span class="w">
</span><span class="k" data-group-id="5786447098-1">end</span><span class="w">
</span></code></pre><h3 id="preparations-prepare">preparations.prepare</h3><pre><code class="makeup elixir" translate="no"><span class="n">prepare</span><span class="w"> </span><span class="n">preparation</span></code></pre><p>Declares a preparation, which can be used to prepare a query for a read action.</p><h3 id="examples-55">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">prepare</span><span class="w"> </span><span class="n">build</span><span class="p" data-group-id="9859333239-1">(</span><span class="ss">sort</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9859333239-2">[</span><span class="ss">:foo</span><span class="p">,</span><span class="w"> </span><span class="ss">:bar</span><span class="p" data-group-id="9859333239-2">]</span><span class="p" data-group-id="9859333239-1">)</span><span class="w">
</span></code></pre><h3 id="arguments-45">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#preparations-prepare-preparation" id="preparations-prepare-preparation"><code class="inline">preparation</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The module and options for a preparation. Also accepts functions take the query and the context.</td></tr></tbody></table><h3 id="options-41">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#preparations-prepare-on" id="preparations-prepare-on"><code class="inline">on</code></a></td><td style="text-align: left;"><code class="inline">:read | :action | list(:read | :action)</code></td><td style="text-align: left;"><code class="inline">[:read]</code></td><td style="text-align: left;">The action types the preparation should run on. By default, preparations only run on read actions. Use <code class="inline">:action</code> to run on generic actions.</td></tr><tr><td style="text-align: left;"><a href="#preparations-prepare-where" id="preparations-prepare-where"><code class="inline">where</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | list((any, any -&gt; any) | module)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Validations that should pass in order for this preparation to apply. Any of these validations failing will result in this preparation being ignored.</td></tr><tr><td style="text-align: left;"><a href="#preparations-prepare-only_when_valid?" id="preparations-prepare-only_when_valid?"><code class="inline">only_when_valid?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If the preparation should only run on valid queries.</td></tr></tbody></table><h3 id="introspection-48">Introspection</h3><p>Target: <a href="Ash.Resource.Preparation.xhtml"><code class="inline">Ash.Resource.Preparation</code></a></p><h2 id="validations">validations</h2><p>Declare validations prior to performing actions against the resource</p><h3 id="nested-dsls-20">Nested DSLs</h3><ul><li><a href="#validations-validate">validate</a></li></ul><h3 id="examples-56">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">validations</span><span class="w"> </span><span class="k" data-group-id="7839214063-1">do</span><span class="w">
  </span><span class="n">validate</span><span class="w"> </span><span class="p" data-group-id="7839214063-2">{</span><span class="nc">Mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7839214063-3">[</span><span class="ss">foo</span><span class="p">:</span><span class="w"> </span><span class="ss">:bar</span><span class="p" data-group-id="7839214063-3">]</span><span class="p" data-group-id="7839214063-2">}</span><span class="w">
  </span><span class="n">validate</span><span class="w"> </span><span class="n">present</span><span class="p" data-group-id="7839214063-4">(</span><span class="p" data-group-id="7839214063-5">[</span><span class="ss">:first_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:last_name</span><span class="p" data-group-id="7839214063-5">]</span><span class="p">,</span><span class="w"> </span><span class="ss">at_least</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="7839214063-4">)</span><span class="w">
</span><span class="k" data-group-id="7839214063-1">end</span><span class="w">
</span></code></pre><h3 id="validations-validate">validations.validate</h3><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="n">validation</span></code></pre><p>Declares a validation for creates and updates.</p><p>See <a href="Ash.Resource.Validation.Builtins.xhtml"><code class="inline">Ash.Resource.Validation.Builtins</code></a> or <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a> for more.</p><h3 id="examples-57">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="p" data-group-id="4279238650-1">{</span><span class="nc">Mod</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4279238650-2">[</span><span class="ss">foo</span><span class="p">:</span><span class="w"> </span><span class="ss">:bar</span><span class="p" data-group-id="4279238650-2">]</span><span class="p" data-group-id="4279238650-1">}</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">validate</span><span class="w"> </span><span class="n">present</span><span class="p" data-group-id="9514688102-1">(</span><span class="p" data-group-id="9514688102-2">[</span><span class="ss">:first_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:last_name</span><span class="p" data-group-id="9514688102-2">]</span><span class="p">,</span><span class="w"> </span><span class="ss">at_least</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="9514688102-1">)</span></code></pre><h3 id="arguments-46">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#validations-validate-validation" id="validations-validate-validation"><code class="inline">validation</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The module (or module and opts) that implements the <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a> behaviour. Also accepts a function that receives the changeset and its context.</td></tr></tbody></table><h3 id="options-42">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#validations-validate-where" id="validations-validate-where"><code class="inline">where</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | list((any, any -&gt; any) | module)</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Validations that should pass in order for this validation to apply. Any of these validations failing will result in this validation being ignored.</td></tr><tr><td style="text-align: left;"><a href="#validations-validate-on" id="validations-validate-on"><code class="inline">on</code></a></td><td style="text-align: left;"><code class="inline">:create | :update | :destroy | :read | :action | list(:create | :update | :destroy | :read | :action)</code></td><td style="text-align: left;"><code class="inline">[:create, :update]</code></td><td style="text-align: left;">The action types the validation should run on. Many validations don't make sense in the context of destroy, read, or generic actions, so by default they are not included.</td></tr><tr><td style="text-align: left;"><a href="#validations-validate-only_when_valid?" id="validations-validate-only_when_valid?"><code class="inline">only_when_valid?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If the validation should only run on valid changesets. Useful for expensive validations or validations that depend on valid data.</td></tr><tr><td style="text-align: left;"><a href="#validations-validate-message" id="validations-validate-message"><code class="inline">message</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">If provided, overrides any message set by the validation error</td></tr><tr><td style="text-align: left;"><a href="#validations-validate-description" id="validations-validate-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the validation</td></tr><tr><td style="text-align: left;"><a href="#validations-validate-before_action?" id="validations-validate-before_action?"><code class="inline">before_action?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">If set to <code class="inline">true</code>, the validation will be run in a before_action hook</td></tr><tr><td style="text-align: left;"><a href="#validations-validate-always_atomic?" id="validations-validate-always_atomic?"><code class="inline">always_atomic?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">By default, validations are only run atomically if all changes will be run atomically or if there is no <code class="inline">validate/3</code> callback defined. Set this to <code class="inline">true</code> to run it atomically always.</td></tr></tbody></table><h3 id="introspection-49">Introspection</h3><p>Target: <a href="Ash.Resource.Validation.xhtml"><code class="inline">Ash.Resource.Validation</code></a></p><h2 id="aggregates">aggregates</h2><p>Declare named aggregates on the resource.</p><p>These are aggregates that can be loaded only by name using <a href="Ash.Query.xhtml#load/2"><code class="inline">Ash.Query.load/2</code></a>.
They are also available as top level fields on the resource.</p><p>See the <a href="aggregates.xhtml">aggregates guide</a> for more.</p><h3 id="nested-dsls-21">Nested DSLs</h3><ul><li><a href="#aggregates-count">count</a><ul><li>join_filter</li></ul></li><li><a href="#aggregates-exists">exists</a><ul><li>join_filter</li></ul></li><li><a href="#aggregates-first">first</a><ul><li>join_filter</li></ul></li><li><a href="#aggregates-sum">sum</a><ul><li>join_filter</li></ul></li><li><a href="#aggregates-list">list</a><ul><li>join_filter</li></ul></li><li><a href="#aggregates-max">max</a><ul><li>join_filter</li></ul></li><li><a href="#aggregates-min">min</a><ul><li>join_filter</li></ul></li><li><a href="#aggregates-avg">avg</a><ul><li>join_filter</li></ul></li><li><a href="#aggregates-custom">custom</a><ul><li>join_filter</li></ul></li></ul><h3 id="examples-58">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">aggregates</span><span class="w"> </span><span class="k" data-group-id="2125578833-1">do</span><span class="w">
  </span><span class="n">count</span><span class="w"> </span><span class="ss">:assigned_ticket_count</span><span class="p">,</span><span class="w"> </span><span class="ss">:reported_tickets</span><span class="w"> </span><span class="k" data-group-id="2125578833-2">do</span><span class="w">
    </span><span class="n">filter</span><span class="w"> </span><span class="p" data-group-id="2125578833-3">[</span><span class="ss">active</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="2125578833-3">]</span><span class="w">
  </span><span class="k" data-group-id="2125578833-2">end</span><span class="w">
</span><span class="k" data-group-id="2125578833-1">end</span><span class="w">
</span></code></pre><h3 id="aggregates-count">aggregates.count</h3><pre><code class="makeup elixir" translate="no"><span class="n">count</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">relationship_path</span></code></pre><p>Declares a named count aggregate on the resource</p><p>Supports <code class="inline">filter</code>, but not <code class="inline">sort</code> (because that wouldn't affect the count)</p><p>See the <a href="aggregates.xhtml">aggregates guide</a> for more.</p><h3 id="nested-dsls-22">Nested DSLs</h3><ul><li><a href="#aggregates-count-join_filter">join_filter</a></li></ul><h3 id="examples-59">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">count</span><span class="w"> </span><span class="ss">:assigned_ticket_count</span><span class="p">,</span><span class="w"> </span><span class="ss">:assigned_tickets</span><span class="w"> </span><span class="k" data-group-id="5230615306-1">do</span><span class="w">
  </span><span class="n">filter</span><span class="w"> </span><span class="p" data-group-id="5230615306-2">[</span><span class="ss">active</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="5230615306-2">]</span><span class="w">
</span><span class="k" data-group-id="5230615306-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-47">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-count-name" id="aggregates-count-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to place the aggregate in</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-count-relationship_path" id="aggregates-count-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship or relationship path to use for the aggregate</td></tr></tbody></table><h3 id="options-43">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-count-uniq?" id="aggregates-count-uniq?"><code class="inline">uniq?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not to count unique values only</td></tr><tr><td style="text-align: left;"><a href="#aggregates-count-read_action" id="aggregates-count-read_action"><code class="inline">read_action</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The read action to use when building the aggregate. Defaults to the primary read action. Keep in mind this action must not have any required arguments.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-count-field" id="aggregates-count-field"><code class="inline">field</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to aggregate. Defaults to the first field in the primary key of the resource</td></tr><tr><td style="text-align: left;"><a href="#aggregates-count-filter" id="aggregates-count-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A filter to apply to the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-count-description" id="aggregates-count-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-count-default" id="aggregates-count-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default value to use in cases where nil would be used. Count defaults to <code class="inline">0</code>.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-count-public?" id="aggregates-count-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate will appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#aggregates-count-filterable?" id="aggregates-count-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean | :simple_equality</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in filters.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-count-sortable?" id="aggregates-count-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in sorts.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-count-sensitive?" id="aggregates-count-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate should be considered sensitive.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-count-authorize?" id="aggregates-count-authorize?"><code class="inline">authorize?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate query should authorize based on the target action, if the parent query is authorized. Requires filter checks on the target action.</td></tr></tbody></table><h3 id="aggregates-count-join_filter">aggregates.count.join_filter</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">filter</span></code></pre><p>Declares a join filter on an aggregate. See the aggregates guide for more.</p><h3 id="examples-60">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="p" data-group-id="7817551698-1">[</span><span class="ss">:comments</span><span class="p">,</span><span class="w"> </span><span class="ss">:author</span><span class="p" data-group-id="7817551698-1">]</span><span class="p">,</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="7817551698-2">(</span><span class="n">active</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="7817551698-2">)</span><span class="w">
</span></code></pre><h3 id="arguments-48">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-count-join_filter-relationship_path" id="aggregates-count-join_filter-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship path on which to apply the join filter</td></tr><tr><td style="text-align: left;"><a href="#aggregates-count-join_filter-filter" id="aggregates-count-join_filter-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The filter to apply. Can be an expression or a filter template.</td></tr></tbody></table><h3 id="introspection-50">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.JoinFilter.xhtml"><code class="inline">Ash.Resource.Aggregate.JoinFilter</code></a></p><h3 id="introspection-51">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.xhtml"><code class="inline">Ash.Resource.Aggregate</code></a></p><h3 id="aggregates-exists">aggregates.exists</h3><pre><code class="makeup elixir" translate="no"><span class="n">exists</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">relationship_path</span></code></pre><p>Declares a named <code class="inline">exists</code> aggregate on the resource</p><p>Supports <code class="inline">filter</code>, but not <code class="inline">sort</code> (because that wouldn't affect if something exists)</p><p>See the <a href="aggregates.xhtml">aggregates guide</a> for more.</p><h3 id="nested-dsls-23">Nested DSLs</h3><ul><li><a href="#aggregates-exists-join_filter">join_filter</a></li></ul><h3 id="examples-61">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">exists</span><span class="w"> </span><span class="ss">:has_ticket</span><span class="p">,</span><span class="w"> </span><span class="ss">:assigned_tickets</span><span class="w">
</span></code></pre><h3 id="arguments-49">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-exists-name" id="aggregates-exists-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to place the aggregate in</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-exists-relationship_path" id="aggregates-exists-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship or relationship path to use for the aggregate</td></tr></tbody></table><h3 id="options-44">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-exists-read_action" id="aggregates-exists-read_action"><code class="inline">read_action</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The read action to use when building the aggregate. Defaults to the primary read action. Keep in mind this action must not have any required arguments.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-exists-filter" id="aggregates-exists-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A filter to apply to the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-exists-description" id="aggregates-exists-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-exists-default" id="aggregates-exists-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default value to use in cases where nil would be used. Count defaults to <code class="inline">0</code>.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-exists-public?" id="aggregates-exists-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate will appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#aggregates-exists-filterable?" id="aggregates-exists-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean | :simple_equality</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in filters.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-exists-sortable?" id="aggregates-exists-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in sorts.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-exists-sensitive?" id="aggregates-exists-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate should be considered sensitive.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-exists-authorize?" id="aggregates-exists-authorize?"><code class="inline">authorize?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate query should authorize based on the target action, if the parent query is authorized. Requires filter checks on the target action.</td></tr></tbody></table><h3 id="aggregates-exists-join_filter">aggregates.exists.join_filter</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">filter</span></code></pre><p>Declares a join filter on an aggregate. See the aggregates guide for more.</p><h3 id="examples-62">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="p" data-group-id="3810743916-1">[</span><span class="ss">:comments</span><span class="p">,</span><span class="w"> </span><span class="ss">:author</span><span class="p" data-group-id="3810743916-1">]</span><span class="p">,</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="3810743916-2">(</span><span class="n">active</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="3810743916-2">)</span><span class="w">
</span></code></pre><h3 id="arguments-50">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-exists-join_filter-relationship_path" id="aggregates-exists-join_filter-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship path on which to apply the join filter</td></tr><tr><td style="text-align: left;"><a href="#aggregates-exists-join_filter-filter" id="aggregates-exists-join_filter-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The filter to apply. Can be an expression or a filter template.</td></tr></tbody></table><h3 id="introspection-52">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.JoinFilter.xhtml"><code class="inline">Ash.Resource.Aggregate.JoinFilter</code></a></p><h3 id="introspection-53">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.xhtml"><code class="inline">Ash.Resource.Aggregate</code></a></p><h3 id="aggregates-first">aggregates.first</h3><pre><code class="makeup elixir" translate="no"><span class="n">first</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">field</span></code></pre><p>Declares a named <code class="inline">first</code> aggregate on the resource</p><p>First aggregates return the first value of the related record
that matches. Supports both <code class="inline">filter</code> and <code class="inline">sort</code>.</p><p>See the <a href="aggregates.xhtml">aggregates guide</a> for more.</p><h3 id="nested-dsls-24">Nested DSLs</h3><ul><li><a href="#aggregates-first-join_filter">join_filter</a></li></ul><h3 id="examples-63">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">first</span><span class="w"> </span><span class="ss">:first_assigned_ticket_subject</span><span class="p">,</span><span class="w"> </span><span class="ss">:assigned_tickets</span><span class="p">,</span><span class="w"> </span><span class="ss">:subject</span><span class="w"> </span><span class="k" data-group-id="2090390846-1">do</span><span class="w">
  </span><span class="n">filter</span><span class="w"> </span><span class="p" data-group-id="2090390846-2">[</span><span class="ss">active</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="2090390846-2">]</span><span class="w">
  </span><span class="n">sort</span><span class="w"> </span><span class="p" data-group-id="2090390846-3">[</span><span class="ss">:subject</span><span class="p" data-group-id="2090390846-3">]</span><span class="w">
</span><span class="k" data-group-id="2090390846-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-51">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-first-name" id="aggregates-first-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to place the aggregate in</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-first-relationship_path" id="aggregates-first-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship or relationship path to use for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-first-field" id="aggregates-first-field"><code class="inline">field</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to aggregate. Defaults to the first field in the primary key of the resource</td></tr></tbody></table><h3 id="options-45">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-first-include_nil?" id="aggregates-first-include_nil?"><code class="inline">include_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not to include <code class="inline">nil</code> values in the aggregate. Only relevant for <code class="inline">list</code> and <code class="inline">first</code> aggregates.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-first-read_action" id="aggregates-first-read_action"><code class="inline">read_action</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The read action to use when building the aggregate. Defaults to the primary read action. Keep in mind this action must not have any required arguments.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-first-filter" id="aggregates-first-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A filter to apply to the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-first-sort" id="aggregates-first-sort"><code class="inline">sort</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A sort to be applied to the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-first-description" id="aggregates-first-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-first-default" id="aggregates-first-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default value to use in cases where nil would be used. Count defaults to <code class="inline">0</code>.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-first-public?" id="aggregates-first-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate will appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#aggregates-first-filterable?" id="aggregates-first-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean | :simple_equality</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in filters.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-first-sortable?" id="aggregates-first-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in sorts.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-first-sensitive?" id="aggregates-first-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate should be considered sensitive.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-first-authorize?" id="aggregates-first-authorize?"><code class="inline">authorize?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate query should authorize based on the target action, if the parent query is authorized. Requires filter checks on the target action.</td></tr></tbody></table><h3 id="aggregates-first-join_filter">aggregates.first.join_filter</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">filter</span></code></pre><p>Declares a join filter on an aggregate. See the aggregates guide for more.</p><h3 id="examples-64">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="p" data-group-id="3511497136-1">[</span><span class="ss">:comments</span><span class="p">,</span><span class="w"> </span><span class="ss">:author</span><span class="p" data-group-id="3511497136-1">]</span><span class="p">,</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="3511497136-2">(</span><span class="n">active</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="3511497136-2">)</span><span class="w">
</span></code></pre><h3 id="arguments-52">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-first-join_filter-relationship_path" id="aggregates-first-join_filter-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship path on which to apply the join filter</td></tr><tr><td style="text-align: left;"><a href="#aggregates-first-join_filter-filter" id="aggregates-first-join_filter-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The filter to apply. Can be an expression or a filter template.</td></tr></tbody></table><h3 id="introspection-54">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.JoinFilter.xhtml"><code class="inline">Ash.Resource.Aggregate.JoinFilter</code></a></p><h3 id="introspection-55">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.xhtml"><code class="inline">Ash.Resource.Aggregate</code></a></p><h3 id="aggregates-sum">aggregates.sum</h3><pre><code class="makeup elixir" translate="no"><span class="n">sum</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">field</span></code></pre><p>Declares a named <code class="inline">sum</code> aggregate on the resource</p><p>Supports <code class="inline">filter</code>, but not <code class="inline">sort</code> (because that wouldn't affect the sum)</p><p>See the <a href="aggregates.xhtml">aggregates guide</a> for more.</p><h3 id="nested-dsls-25">Nested DSLs</h3><ul><li><a href="#aggregates-sum-join_filter">join_filter</a></li></ul><h3 id="examples-65">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">sum</span><span class="w"> </span><span class="ss">:assigned_ticket_price_sum</span><span class="p">,</span><span class="w"> </span><span class="ss">:assigned_tickets</span><span class="p">,</span><span class="w"> </span><span class="ss">:price</span><span class="w"> </span><span class="k" data-group-id="3762979504-1">do</span><span class="w">
  </span><span class="n">filter</span><span class="w"> </span><span class="p" data-group-id="3762979504-2">[</span><span class="ss">active</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="3762979504-2">]</span><span class="w">
</span><span class="k" data-group-id="3762979504-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-53">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-sum-name" id="aggregates-sum-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to place the aggregate in</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-sum-relationship_path" id="aggregates-sum-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship or relationship path to use for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-sum-field" id="aggregates-sum-field"><code class="inline">field</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to aggregate. Defaults to the first field in the primary key of the resource</td></tr></tbody></table><h3 id="options-46">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-sum-read_action" id="aggregates-sum-read_action"><code class="inline">read_action</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The read action to use when building the aggregate. Defaults to the primary read action. Keep in mind this action must not have any required arguments.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-sum-filter" id="aggregates-sum-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A filter to apply to the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-sum-description" id="aggregates-sum-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-sum-default" id="aggregates-sum-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default value to use in cases where nil would be used. Count defaults to <code class="inline">0</code>.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-sum-public?" id="aggregates-sum-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate will appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#aggregates-sum-filterable?" id="aggregates-sum-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean | :simple_equality</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in filters.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-sum-sortable?" id="aggregates-sum-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in sorts.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-sum-sensitive?" id="aggregates-sum-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate should be considered sensitive.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-sum-authorize?" id="aggregates-sum-authorize?"><code class="inline">authorize?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate query should authorize based on the target action, if the parent query is authorized. Requires filter checks on the target action.</td></tr></tbody></table><h3 id="aggregates-sum-join_filter">aggregates.sum.join_filter</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">filter</span></code></pre><p>Declares a join filter on an aggregate. See the aggregates guide for more.</p><h3 id="examples-66">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="p" data-group-id="6680683589-1">[</span><span class="ss">:comments</span><span class="p">,</span><span class="w"> </span><span class="ss">:author</span><span class="p" data-group-id="6680683589-1">]</span><span class="p">,</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="6680683589-2">(</span><span class="n">active</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="6680683589-2">)</span><span class="w">
</span></code></pre><h3 id="arguments-54">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-sum-join_filter-relationship_path" id="aggregates-sum-join_filter-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship path on which to apply the join filter</td></tr><tr><td style="text-align: left;"><a href="#aggregates-sum-join_filter-filter" id="aggregates-sum-join_filter-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The filter to apply. Can be an expression or a filter template.</td></tr></tbody></table><h3 id="introspection-56">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.JoinFilter.xhtml"><code class="inline">Ash.Resource.Aggregate.JoinFilter</code></a></p><h3 id="introspection-57">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.xhtml"><code class="inline">Ash.Resource.Aggregate</code></a></p><h3 id="aggregates-list">aggregates.list</h3><pre><code class="makeup elixir" translate="no"><span class="n">list</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">field</span></code></pre><p>Declares a named <code class="inline">list</code> aggregate on the resource.</p><p>A list aggregate selects the list of all values for the given field
and relationship combination.</p><p>See the <a href="aggregates.xhtml">aggregates guide</a> for more.</p><h3 id="nested-dsls-26">Nested DSLs</h3><ul><li><a href="#aggregates-list-join_filter">join_filter</a></li></ul><h3 id="examples-67">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">list</span><span class="w"> </span><span class="ss">:assigned_ticket_prices</span><span class="p">,</span><span class="w"> </span><span class="ss">:assigned_tickets</span><span class="p">,</span><span class="w"> </span><span class="ss">:price</span><span class="w"> </span><span class="k" data-group-id="1310286058-1">do</span><span class="w">
  </span><span class="n">filter</span><span class="w"> </span><span class="p" data-group-id="1310286058-2">[</span><span class="ss">active</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="1310286058-2">]</span><span class="w">
</span><span class="k" data-group-id="1310286058-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-55">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-list-name" id="aggregates-list-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to place the aggregate in</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-list-relationship_path" id="aggregates-list-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship or relationship path to use for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-list-field" id="aggregates-list-field"><code class="inline">field</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to aggregate. Defaults to the first field in the primary key of the resource</td></tr></tbody></table><h3 id="options-47">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-list-include_nil?" id="aggregates-list-include_nil?"><code class="inline">include_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not to include <code class="inline">nil</code> values in the aggregate. Only relevant for <code class="inline">list</code> and <code class="inline">first</code> aggregates.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-list-uniq?" id="aggregates-list-uniq?"><code class="inline">uniq?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not to count unique values only</td></tr><tr><td style="text-align: left;"><a href="#aggregates-list-read_action" id="aggregates-list-read_action"><code class="inline">read_action</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The read action to use when building the aggregate. Defaults to the primary read action. Keep in mind this action must not have any required arguments.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-list-filter" id="aggregates-list-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A filter to apply to the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-list-sort" id="aggregates-list-sort"><code class="inline">sort</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A sort to be applied to the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-list-description" id="aggregates-list-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-list-default" id="aggregates-list-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default value to use in cases where nil would be used. Count defaults to <code class="inline">0</code>.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-list-public?" id="aggregates-list-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate will appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#aggregates-list-filterable?" id="aggregates-list-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean | :simple_equality</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in filters.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-list-sortable?" id="aggregates-list-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in sorts.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-list-sensitive?" id="aggregates-list-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate should be considered sensitive.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-list-authorize?" id="aggregates-list-authorize?"><code class="inline">authorize?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate query should authorize based on the target action, if the parent query is authorized. Requires filter checks on the target action.</td></tr></tbody></table><h3 id="aggregates-list-join_filter">aggregates.list.join_filter</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">filter</span></code></pre><p>Declares a join filter on an aggregate. See the aggregates guide for more.</p><h3 id="examples-68">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="p" data-group-id="9030595500-1">[</span><span class="ss">:comments</span><span class="p">,</span><span class="w"> </span><span class="ss">:author</span><span class="p" data-group-id="9030595500-1">]</span><span class="p">,</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="9030595500-2">(</span><span class="n">active</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="9030595500-2">)</span><span class="w">
</span></code></pre><h3 id="arguments-56">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-list-join_filter-relationship_path" id="aggregates-list-join_filter-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship path on which to apply the join filter</td></tr><tr><td style="text-align: left;"><a href="#aggregates-list-join_filter-filter" id="aggregates-list-join_filter-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The filter to apply. Can be an expression or a filter template.</td></tr></tbody></table><h3 id="introspection-58">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.JoinFilter.xhtml"><code class="inline">Ash.Resource.Aggregate.JoinFilter</code></a></p><h3 id="introspection-59">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.xhtml"><code class="inline">Ash.Resource.Aggregate</code></a></p><h3 id="aggregates-max">aggregates.max</h3><pre><code class="makeup elixir" translate="no"><span class="n">max</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">field</span></code></pre><p>Declares a named <code class="inline">max</code> aggregate on the resource</p><p>Supports <code class="inline">filter</code>, but not <code class="inline">sort</code> (because that wouldn't affect the max)</p><p>See the <a href="aggregates.xhtml">aggregates guide</a> for more.</p><h3 id="nested-dsls-27">Nested DSLs</h3><ul><li><a href="#aggregates-max-join_filter">join_filter</a></li></ul><h3 id="examples-69">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">max</span><span class="w"> </span><span class="ss">:first_assigned_ticket_subject</span><span class="p">,</span><span class="w"> </span><span class="ss">:assigned_tickets</span><span class="p">,</span><span class="w"> </span><span class="ss">:severity</span><span class="w"> </span><span class="k" data-group-id="2872144081-1">do</span><span class="w">
  </span><span class="n">filter</span><span class="w"> </span><span class="p" data-group-id="2872144081-2">[</span><span class="ss">active</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="2872144081-2">]</span><span class="w">
</span><span class="k" data-group-id="2872144081-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-57">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-max-name" id="aggregates-max-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to place the aggregate in</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-max-relationship_path" id="aggregates-max-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship or relationship path to use for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-max-field" id="aggregates-max-field"><code class="inline">field</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to aggregate. Defaults to the first field in the primary key of the resource</td></tr></tbody></table><h3 id="options-48">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-max-read_action" id="aggregates-max-read_action"><code class="inline">read_action</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The read action to use when building the aggregate. Defaults to the primary read action. Keep in mind this action must not have any required arguments.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-max-filter" id="aggregates-max-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A filter to apply to the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-max-description" id="aggregates-max-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-max-default" id="aggregates-max-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default value to use in cases where nil would be used. Count defaults to <code class="inline">0</code>.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-max-public?" id="aggregates-max-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate will appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#aggregates-max-filterable?" id="aggregates-max-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean | :simple_equality</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in filters.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-max-sortable?" id="aggregates-max-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in sorts.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-max-sensitive?" id="aggregates-max-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate should be considered sensitive.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-max-authorize?" id="aggregates-max-authorize?"><code class="inline">authorize?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate query should authorize based on the target action, if the parent query is authorized. Requires filter checks on the target action.</td></tr></tbody></table><h3 id="aggregates-max-join_filter">aggregates.max.join_filter</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">filter</span></code></pre><p>Declares a join filter on an aggregate. See the aggregates guide for more.</p><h3 id="examples-70">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="p" data-group-id="1969535317-1">[</span><span class="ss">:comments</span><span class="p">,</span><span class="w"> </span><span class="ss">:author</span><span class="p" data-group-id="1969535317-1">]</span><span class="p">,</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="1969535317-2">(</span><span class="n">active</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="1969535317-2">)</span><span class="w">
</span></code></pre><h3 id="arguments-58">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-max-join_filter-relationship_path" id="aggregates-max-join_filter-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship path on which to apply the join filter</td></tr><tr><td style="text-align: left;"><a href="#aggregates-max-join_filter-filter" id="aggregates-max-join_filter-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The filter to apply. Can be an expression or a filter template.</td></tr></tbody></table><h3 id="introspection-60">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.JoinFilter.xhtml"><code class="inline">Ash.Resource.Aggregate.JoinFilter</code></a></p><h3 id="introspection-61">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.xhtml"><code class="inline">Ash.Resource.Aggregate</code></a></p><h3 id="aggregates-min">aggregates.min</h3><pre><code class="makeup elixir" translate="no"><span class="n">min</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">field</span></code></pre><p>Declares a named <code class="inline">min</code> aggregate on the resource</p><p>Supports <code class="inline">filter</code>, but not <code class="inline">sort</code> (because that wouldn't affect the min)</p><p>See the <a href="aggregates.xhtml">aggregates guide</a> for more.</p><h3 id="nested-dsls-28">Nested DSLs</h3><ul><li><a href="#aggregates-min-join_filter">join_filter</a></li></ul><h3 id="examples-71">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">min</span><span class="w"> </span><span class="ss">:first_assigned_ticket_subject</span><span class="p">,</span><span class="w"> </span><span class="ss">:assigned_tickets</span><span class="p">,</span><span class="w"> </span><span class="ss">:severity</span><span class="w"> </span><span class="k" data-group-id="9188884997-1">do</span><span class="w">
  </span><span class="n">filter</span><span class="w"> </span><span class="p" data-group-id="9188884997-2">[</span><span class="ss">active</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="9188884997-2">]</span><span class="w">
</span><span class="k" data-group-id="9188884997-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-59">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-min-name" id="aggregates-min-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to place the aggregate in</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-min-relationship_path" id="aggregates-min-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship or relationship path to use for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-min-field" id="aggregates-min-field"><code class="inline">field</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to aggregate. Defaults to the first field in the primary key of the resource</td></tr></tbody></table><h3 id="options-49">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-min-read_action" id="aggregates-min-read_action"><code class="inline">read_action</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The read action to use when building the aggregate. Defaults to the primary read action. Keep in mind this action must not have any required arguments.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-min-filter" id="aggregates-min-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A filter to apply to the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-min-description" id="aggregates-min-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-min-default" id="aggregates-min-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default value to use in cases where nil would be used. Count defaults to <code class="inline">0</code>.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-min-public?" id="aggregates-min-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate will appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#aggregates-min-filterable?" id="aggregates-min-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean | :simple_equality</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in filters.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-min-sortable?" id="aggregates-min-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in sorts.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-min-sensitive?" id="aggregates-min-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate should be considered sensitive.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-min-authorize?" id="aggregates-min-authorize?"><code class="inline">authorize?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate query should authorize based on the target action, if the parent query is authorized. Requires filter checks on the target action.</td></tr></tbody></table><h3 id="aggregates-min-join_filter">aggregates.min.join_filter</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">filter</span></code></pre><p>Declares a join filter on an aggregate. See the aggregates guide for more.</p><h3 id="examples-72">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="p" data-group-id="1489132771-1">[</span><span class="ss">:comments</span><span class="p">,</span><span class="w"> </span><span class="ss">:author</span><span class="p" data-group-id="1489132771-1">]</span><span class="p">,</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="1489132771-2">(</span><span class="n">active</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="1489132771-2">)</span><span class="w">
</span></code></pre><h3 id="arguments-60">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-min-join_filter-relationship_path" id="aggregates-min-join_filter-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship path on which to apply the join filter</td></tr><tr><td style="text-align: left;"><a href="#aggregates-min-join_filter-filter" id="aggregates-min-join_filter-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The filter to apply. Can be an expression or a filter template.</td></tr></tbody></table><h3 id="introspection-62">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.JoinFilter.xhtml"><code class="inline">Ash.Resource.Aggregate.JoinFilter</code></a></p><h3 id="introspection-63">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.xhtml"><code class="inline">Ash.Resource.Aggregate</code></a></p><h3 id="aggregates-avg">aggregates.avg</h3><pre><code class="makeup elixir" translate="no"><span class="n">avg</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">field</span></code></pre><p>Declares a named <code class="inline">avg</code> aggregate on the resource</p><p>Supports <code class="inline">filter</code>, but not <code class="inline">sort</code> (because that wouldn't affect the avg)</p><p>See the <a href="aggregates.xhtml">aggregates guide</a> for more.</p><h3 id="nested-dsls-29">Nested DSLs</h3><ul><li><a href="#aggregates-avg-join_filter">join_filter</a></li></ul><h3 id="examples-73">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">avg</span><span class="w"> </span><span class="ss">:assigned_ticket_price_sum</span><span class="p">,</span><span class="w"> </span><span class="ss">:assigned_tickets</span><span class="p">,</span><span class="w"> </span><span class="ss">:price</span><span class="w"> </span><span class="k" data-group-id="2940261059-1">do</span><span class="w">
  </span><span class="n">filter</span><span class="w"> </span><span class="p" data-group-id="2940261059-2">[</span><span class="ss">active</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="2940261059-2">]</span><span class="w">
</span><span class="k" data-group-id="2940261059-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-61">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-avg-name" id="aggregates-avg-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to place the aggregate in</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-avg-relationship_path" id="aggregates-avg-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship or relationship path to use for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-avg-field" id="aggregates-avg-field"><code class="inline">field</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to aggregate. Defaults to the first field in the primary key of the resource</td></tr></tbody></table><h3 id="options-50">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-avg-read_action" id="aggregates-avg-read_action"><code class="inline">read_action</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The read action to use when building the aggregate. Defaults to the primary read action. Keep in mind this action must not have any required arguments.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-avg-filter" id="aggregates-avg-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A filter to apply to the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-avg-description" id="aggregates-avg-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-avg-default" id="aggregates-avg-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default value to use in cases where nil would be used. Count defaults to <code class="inline">0</code>.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-avg-public?" id="aggregates-avg-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate will appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#aggregates-avg-filterable?" id="aggregates-avg-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean | :simple_equality</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in filters.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-avg-sortable?" id="aggregates-avg-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in sorts.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-avg-sensitive?" id="aggregates-avg-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate should be considered sensitive.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-avg-authorize?" id="aggregates-avg-authorize?"><code class="inline">authorize?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate query should authorize based on the target action, if the parent query is authorized. Requires filter checks on the target action.</td></tr></tbody></table><h3 id="aggregates-avg-join_filter">aggregates.avg.join_filter</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">filter</span></code></pre><p>Declares a join filter on an aggregate. See the aggregates guide for more.</p><h3 id="examples-74">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="p" data-group-id="2387914110-1">[</span><span class="ss">:comments</span><span class="p">,</span><span class="w"> </span><span class="ss">:author</span><span class="p" data-group-id="2387914110-1">]</span><span class="p">,</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="2387914110-2">(</span><span class="n">active</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="2387914110-2">)</span><span class="w">
</span></code></pre><h3 id="arguments-62">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-avg-join_filter-relationship_path" id="aggregates-avg-join_filter-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship path on which to apply the join filter</td></tr><tr><td style="text-align: left;"><a href="#aggregates-avg-join_filter-filter" id="aggregates-avg-join_filter-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The filter to apply. Can be an expression or a filter template.</td></tr></tbody></table><h3 id="introspection-64">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.JoinFilter.xhtml"><code class="inline">Ash.Resource.Aggregate.JoinFilter</code></a></p><h3 id="introspection-65">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.xhtml"><code class="inline">Ash.Resource.Aggregate</code></a></p><h3 id="aggregates-custom">aggregates.custom</h3><pre><code class="makeup elixir" translate="no"><span class="n">custom</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">type</span></code></pre><p>Declares a named <code class="inline">custom</code> aggregate on the resource</p><p>Supports <code class="inline">filter</code> and <code class="inline">sort</code>.</p><p>Custom aggregates provide an <code class="inline">implementation</code> which must implement data layer specific callbacks.</p><p>See the relevant data layer documentation and the <a href="aggregates.xhtml">aggregates guide</a> for more.</p><h3 id="nested-dsls-30">Nested DSLs</h3><ul><li><a href="#aggregates-custom-join_filter">join_filter</a></li></ul><h3 id="examples-75">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">custom</span><span class="w"> </span><span class="ss">:author_names</span><span class="p">,</span><span class="w"> </span><span class="ss">:authors</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="w"> </span><span class="k" data-group-id="8827103449-1">do</span><span class="w">
  </span><span class="n">implementation</span><span class="w"> </span><span class="p" data-group-id="8827103449-2">{</span><span class="nc">StringAgg</span><span class="p">,</span><span class="w"> </span><span class="ss">delimiter</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="p" data-group-id="8827103449-2">}</span><span class="w">
</span><span class="k" data-group-id="8827103449-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-63">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-custom-name" id="aggregates-custom-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to place the aggregate in</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-custom-relationship_path" id="aggregates-custom-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship or relationship path to use for the aggregate</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-custom-type" id="aggregates-custom-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the value returned by the aggregate</td></tr></tbody></table><h3 id="options-51">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#aggregates-custom-implementation" id="aggregates-custom-implementation"><code class="inline">implementation</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The module that implements the relevant data layer callbacks</td></tr><tr><td style="text-align: left;"><a href="#aggregates-custom-read_action" id="aggregates-custom-read_action"><code class="inline">read_action</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The read action to use when building the aggregate. Defaults to the primary read action. Keep in mind this action must not have any required arguments.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-custom-field" id="aggregates-custom-field"><code class="inline">field</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field to aggregate. Defaults to the first field in the primary key of the resource</td></tr><tr><td style="text-align: left;"><a href="#aggregates-custom-filter" id="aggregates-custom-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A filter to apply to the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-custom-sort" id="aggregates-custom-sort"><code class="inline">sort</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A sort to be applied to the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-custom-description" id="aggregates-custom-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the aggregate</td></tr><tr><td style="text-align: left;"><a href="#aggregates-custom-default" id="aggregates-custom-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default value to use in cases where nil would be used. Count defaults to <code class="inline">0</code>.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-custom-public?" id="aggregates-custom-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate will appear in public interfaces</td></tr><tr><td style="text-align: left;"><a href="#aggregates-custom-filterable?" id="aggregates-custom-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean | :simple_equality</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in filters.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-custom-sortable?" id="aggregates-custom-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate should be usable in sorts.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-custom-sensitive?" id="aggregates-custom-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the aggregate should be considered sensitive.</td></tr><tr><td style="text-align: left;"><a href="#aggregates-custom-authorize?" id="aggregates-custom-authorize?"><code class="inline">authorize?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the aggregate query should authorize based on the target action, if the parent query is authorized. Requires filter checks on the target action.</td></tr></tbody></table><h3 id="aggregates-custom-join_filter">aggregates.custom.join_filter</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="n">relationship_path</span><span class="p">,</span><span class="w"> </span><span class="n">filter</span></code></pre><p>Declares a join filter on an aggregate. See the aggregates guide for more.</p><h3 id="examples-76">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">join_filter</span><span class="w"> </span><span class="p" data-group-id="4853616755-1">[</span><span class="ss">:comments</span><span class="p">,</span><span class="w"> </span><span class="ss">:author</span><span class="p" data-group-id="4853616755-1">]</span><span class="p">,</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="4853616755-2">(</span><span class="n">active</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="4853616755-2">)</span><span class="w">
</span></code></pre><h3 id="arguments-64">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#aggregates-custom-join_filter-relationship_path" id="aggregates-custom-join_filter-relationship_path"><code class="inline">relationship_path</code></a></td><td style="text-align: left;"><code class="inline">atom | list(atom)</code></td><td style="text-align: left;"></td><td style="text-align: left;">The relationship path on which to apply the join filter</td></tr><tr><td style="text-align: left;"><a href="#aggregates-custom-join_filter-filter" id="aggregates-custom-join_filter-filter"><code class="inline">filter</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The filter to apply. Can be an expression or a filter template.</td></tr></tbody></table><h3 id="introspection-66">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.JoinFilter.xhtml"><code class="inline">Ash.Resource.Aggregate.JoinFilter</code></a></p><h3 id="introspection-67">Introspection</h3><p>Target: <a href="Ash.Resource.Aggregate.xhtml"><code class="inline">Ash.Resource.Aggregate</code></a></p><h2 id="calculations">calculations</h2><p>Declare named calculations on the resource.</p><p>These are calculations that can be loaded only by name using <a href="Ash.Query.xhtml#load/2"><code class="inline">Ash.Query.load/2</code></a>.
They are also available as top level fields on the resource.</p><p>See the <a href="calculations.xhtml">calculations guide</a> for more.</p><h3 id="nested-dsls-31">Nested DSLs</h3><ul><li><a href="#calculations-calculate">calculate</a><ul><li>argument</li></ul></li></ul><h3 id="examples-77">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">calculations</span><span class="w"> </span><span class="k" data-group-id="8664456344-1">do</span><span class="w">
  </span><span class="n">calculate</span><span class="w"> </span><span class="ss">:full_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="nc">MyApp.MyResource.FullName</span><span class="w">
</span><span class="k" data-group-id="8664456344-1">end</span><span class="w">
</span></code></pre><h3 id="calculations-calculate">calculations.calculate</h3><pre><code class="makeup elixir" translate="no"><span class="n">calculate</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">calculation</span><span class="w"> </span><span class="o">\\</span><span class="w"> </span><span class="no">nil</span></code></pre><p>Declares a named calculation on the resource.</p><p>Takes a module that must adopt the <a href="Ash.Resource.Calculation.xhtml"><code class="inline">Ash.Resource.Calculation</code></a> behaviour. See that module
for more information.</p><p>To ensure that the necessary fields are loaded:</p><p>1.) Specifying the <code class="inline">load</code> option on a calculation in the resource.
2.) Define a <code class="inline">load/3</code> callback in the calculation module
3.) Set <code class="inline">always_select?</code> on the attribute in question</p><p>See the <a href="calculations.xhtml">calculations guide</a> for more.</p><h3 id="nested-dsls-32">Nested DSLs</h3><ul><li><a href="#calculations-calculate-argument">argument</a></li></ul><h3 id="examples-78">Examples</h3><p><a href="Ash.Resource.Calculation.xhtml"><code class="inline">Ash.Resource.Calculation</code></a> implementation example:</p><pre><code class="makeup elixir" translate="no"><span class="n">calculate</span><span class="w"> </span><span class="ss">:full_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9419816952-1">{</span><span class="nc">MyApp.FullName</span><span class="p">,</span><span class="w"> </span><span class="ss">keys</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9419816952-2">[</span><span class="ss">:first_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:last_name</span><span class="p" data-group-id="9419816952-2">]</span><span class="p" data-group-id="9419816952-1">}</span><span class="p">,</span><span class="w"> </span><span class="ss">load</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9419816952-3">[</span><span class="ss">:first_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:last_name</span><span class="p" data-group-id="9419816952-3">]</span></code></pre><p><code class="inline">expr/1</code> example:</p><pre><code class="makeup elixir" translate="no"><span class="n">calculate</span><span class="w"> </span><span class="ss">:full_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="7000727981-1">(</span><span class="n">first_name</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">last_name</span><span class="p" data-group-id="7000727981-1">)</span></code></pre><p>Example with options:</p><pre><code class="makeup elixir" translate="no"><span class="n">calculate</span><span class="w"> </span><span class="ss">:full_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="9730428464-1">(</span><span class="n">first_name</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">last_name</span><span class="p" data-group-id="9730428464-1">)</span><span class="p">,</span><span class="w"> </span><span class="ss">allow_nil?</span><span class="p">:</span><span class="w"> </span><span class="no">false</span></code></pre><p>Example with options in <code class="inline">do</code> block:</p><pre><code class="makeup elixir" translate="no"><span class="n">calculate</span><span class="w"> </span><span class="ss">:full_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="n">expr</span><span class="p" data-group-id="8975693087-1">(</span><span class="n">first_name</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">last_name</span><span class="p" data-group-id="8975693087-1">)</span><span class="w"> </span><span class="k" data-group-id="8975693087-2">do</span><span class="w">
  </span><span class="n">allow_nil?</span><span class="w"> </span><span class="no">false</span><span class="w">
  </span><span class="n">public?</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="k" data-group-id="8975693087-2">end</span><span class="w">
</span></code></pre><h3 id="arguments-65">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#calculations-calculate-name" id="calculations-calculate-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The field name to use for the calculation value</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#calculations-calculate-type" id="calculations-calculate-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the calculation. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#calculations-calculate-calculation" id="calculations-calculate-calculation"><code class="inline">calculation</code></a></td><td style="text-align: left;"><code class="inline">(any, any -&gt; any) | module | any</code></td><td style="text-align: left;"></td><td style="text-align: left;">The <code class="inline">module</code>, <code class="inline">{module, opts}</code> or <code class="inline">expr(...)</code> to use for the calculation. Also accepts a function that takes <em>a list of records</em> and the context, and produces a result for each record.</td></tr></tbody></table><h3 id="options-52">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#calculations-calculate-async?" id="calculations-calculate-async?"><code class="inline">async?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;"></td></tr><tr><td style="text-align: left;"><a href="#calculations-calculate-constraints" id="calculations-calculate-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Constraints to provide to the type. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr><tr><td style="text-align: left;"><a href="#calculations-calculate-description" id="calculations-calculate-description"><code class="inline">description</code></a></td><td style="text-align: left;"><code class="inline">String.t</code></td><td style="text-align: left;"></td><td style="text-align: left;">An optional description for the calculation</td></tr><tr><td style="text-align: left;"><a href="#calculations-calculate-public?" id="calculations-calculate-public?"><code class="inline">public?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the calculation will appear in public interfaces.</td></tr><tr><td style="text-align: left;"><a href="#calculations-calculate-sensitive?" id="calculations-calculate-sensitive?"><code class="inline">sensitive?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not references to the calculation will be considered sensitive.</td></tr><tr><td style="text-align: left;"><a href="#calculations-calculate-load" id="calculations-calculate-load"><code class="inline">load</code></a></td><td style="text-align: left;"><code class="inline">any</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">A load statement to be applied if the calculation is used.</td></tr><tr><td style="text-align: left;"><a href="#calculations-calculate-allow_nil?" id="calculations-calculate-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the calculation can return nil.</td></tr><tr><td style="text-align: left;"><a href="#calculations-calculate-filterable?" id="calculations-calculate-filterable?"><code class="inline">filterable?</code></a></td><td style="text-align: left;"><code class="inline">boolean | :simple_equality</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the calculation should be usable in filters.</td></tr><tr><td style="text-align: left;"><a href="#calculations-calculate-sortable?" id="calculations-calculate-sortable?"><code class="inline">sortable?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the calculation can be referenced in sorts.</td></tr></tbody></table><h3 id="calculations-calculate-argument">calculations.calculate.argument</h3><pre><code class="makeup elixir" translate="no"><span class="n">argument</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span></code></pre><p>An argument to be passed into the calculation's arguments map</p><p>See the <a href="calculations.xhtml">calculations guide</a> for more.</p><h3 id="examples-79">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">argument</span><span class="w"> </span><span class="ss">:params</span><span class="p">,</span><span class="w"> </span><span class="ss">:map</span><span class="w"> </span><span class="k" data-group-id="6279626790-1">do</span><span class="w">
  </span><span class="n">default</span><span class="w"> </span><span class="p" data-group-id="6279626790-2">%{</span><span class="p" data-group-id="6279626790-2">}</span><span class="w">
</span><span class="k" data-group-id="6279626790-1">end</span><span class="w">
</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="n">argument</span><span class="w"> </span><span class="ss">:retries</span><span class="p">,</span><span class="w"> </span><span class="ss">:integer</span><span class="w"> </span><span class="k" data-group-id="1069642090-1">do</span><span class="w">
  </span><span class="n">allow_nil?</span><span class="w"> </span><span class="no">false</span><span class="w">
</span><span class="k" data-group-id="1069642090-1">end</span><span class="w">
</span></code></pre><h3 id="arguments-66">Arguments</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a class="spark-required" href="#calculations-calculate-argument-name" id="calculations-calculate-argument-name"><code class="inline">name</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">The name of the argument</td></tr><tr><td style="text-align: left;"><a class="spark-required" href="#calculations-calculate-argument-type" id="calculations-calculate-argument-type"><code class="inline">type</code></a></td><td style="text-align: left;"><code class="inline">module</code></td><td style="text-align: left;"></td><td style="text-align: left;">The type of the argument. See <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="options-53">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#calculations-calculate-argument-default" id="calculations-calculate-argument-default"><code class="inline">default</code></a></td><td style="text-align: left;"><code class="inline">(-&gt; any) | mfa | any</code></td><td style="text-align: left;"></td><td style="text-align: left;">A default value to use for the argument if not provided</td></tr><tr><td style="text-align: left;"><a href="#calculations-calculate-argument-allow_nil?" id="calculations-calculate-argument-allow_nil?"><code class="inline">allow_nil?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">true</code></td><td style="text-align: left;">Whether or not the argument value may be nil (or may be not provided)</td></tr><tr><td style="text-align: left;"><a href="#calculations-calculate-argument-allow_expr?" id="calculations-calculate-argument-allow_expr?"><code class="inline">allow_expr?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Allow passing expressions as argument values. Expressions cannot be type validated.</td></tr><tr><td style="text-align: left;"><a href="#calculations-calculate-argument-constraints" id="calculations-calculate-argument-constraints"><code class="inline">constraints</code></a></td><td style="text-align: left;"><code class="inline">keyword</code></td><td style="text-align: left;"><code class="inline">[]</code></td><td style="text-align: left;">Constraints to provide to the type when casting the value. See the type's documentation and <a href="Ash.Type.xhtml"><code class="inline">Ash.Type</code></a> for more.</td></tr></tbody></table><h3 id="introspection-68">Introspection</h3><p>Target: <a href="Ash.Resource.Calculation.Argument.xhtml"><code class="inline">Ash.Resource.Calculation.Argument</code></a></p><h3 id="introspection-69">Introspection</h3><p>Target: <a href="Ash.Resource.Calculation.xhtml"><code class="inline">Ash.Resource.Calculation</code></a></p><h2 id="multitenancy">multitenancy</h2><p>Options for configuring the multitenancy behavior of a resource.</p><p>To specify a tenant, use <a href="Ash.Query.xhtml#set_tenant/2"><code class="inline">Ash.Query.set_tenant/2</code></a> or
<a href="Ash.Changeset.xhtml#set_tenant/2"><code class="inline">Ash.Changeset.set_tenant/2</code></a> before passing it to an operation.</p><p>See the <a href="multitenancy.xhtml">multitenancy guide</a></p><h3 id="examples-80">Examples</h3><pre><code class="makeup elixir" translate="no"><span class="n">multitenancy</span><span class="w"> </span><span class="k" data-group-id="4913963092-1">do</span><span class="w">
  </span><span class="n">strategy</span><span class="w"> </span><span class="ss">:attribute</span><span class="w">
  </span><span class="n">attribute</span><span class="w"> </span><span class="ss">:organization_id</span><span class="w">
  </span><span class="n">global?</span><span class="w"> </span><span class="no">true</span><span class="w">
</span><span class="k" data-group-id="4913963092-1">end</span><span class="w">
</span></code></pre><h3 id="options-54">Options</h3><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Type</th><th style="text-align: left;">Default</th><th style="text-align: left;">Docs</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#multitenancy-strategy" id="multitenancy-strategy"><code class="inline">strategy</code></a></td><td style="text-align: left;"><code class="inline">:context | :attribute</code></td><td style="text-align: left;"><code class="inline">:context</code></td><td style="text-align: left;">Determine if multitenancy is performed with attribute filters or using data layer features.</td></tr><tr><td style="text-align: left;"><a href="#multitenancy-attribute" id="multitenancy-attribute"><code class="inline">attribute</code></a></td><td style="text-align: left;"><code class="inline">atom</code></td><td style="text-align: left;"></td><td style="text-align: left;">If using the <code class="inline">attribute</code> strategy, the attribute to use, e.g <code class="inline">org_id</code></td></tr><tr><td style="text-align: left;"><a href="#multitenancy-global?" id="multitenancy-global?"><code class="inline">global?</code></a></td><td style="text-align: left;"><code class="inline">boolean</code></td><td style="text-align: left;"><code class="inline">false</code></td><td style="text-align: left;">Whether or not the data may be accessed without setting a tenant. For example, with attribute multitenancy, this allows accessing without filtering by the tenant attribute.</td></tr><tr><td style="text-align: left;"><a href="#multitenancy-parse_attribute" id="multitenancy-parse_attribute"><code class="inline">parse_attribute</code></a></td><td style="text-align: left;"><code class="inline">mfa</code></td><td style="text-align: left;"><code class="inline">{Ash.Resource.Dsl, :identity, []}</code></td><td style="text-align: left;">An mfa ({module, function, args}) pointing to a function that takes a tenant and returns the attribute value</td></tr></tbody></table><style type="text/css">.spark-required::after { content: "*"; color: red !important; }</style>

  </body>
</html>
