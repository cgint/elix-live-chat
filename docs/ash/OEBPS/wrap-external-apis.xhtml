<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <title>Wrap External APIs - ash v3.5.33</title>
    <meta name="generator" content="ExDoc v0.38.2" />
    <link type="text/css" rel="stylesheet" href="dist/epub-elixir-FNUUKFP7.css" />
    <script src="dist/epub-4WIP524F.js"></script>

  </head>
  <body class="content-inner">

    <h1 id="content">Wrap External APIs</h1>
<pre><code class="makeup elixir" translate="no"><span class="nc">Mix</span><span class="o">.</span><span class="n">install</span><span class="p" data-group-id="2457690220-1">(</span><span class="w">
  </span><span class="p" data-group-id="2457690220-2">[</span><span class="w">
    </span><span class="p" data-group-id="2457690220-3">{</span><span class="ss">:ash</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;~&gt; 3.0&quot;</span><span class="p" data-group-id="2457690220-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="2457690220-4">{</span><span class="ss">:req</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;~&gt; 0.4.0&quot;</span><span class="p" data-group-id="2457690220-4">}</span><span class="w">
  </span><span class="p" data-group-id="2457690220-2">]</span><span class="p">,</span><span class="w">
  </span><span class="ss">consolidate_protocols</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
</span><span class="p" data-group-id="2457690220-1">)</span></code></pre><h2 id="introduction">Introduction</h2><p>Wrapping external APIs in Ash resources can allow you to leverage the rich and consistent interface provided by <a href="Ash.Resource.xhtml"><code class="inline">Ash.Resource</code></a> for interactions with external services.</p><p>There are a few approaches to how you might do this, including the still in progress <a href="https://github.com/ash-project/ash_json_api_wrapper">AshJsonApiWrapper</a>. Here we will leverage &quot;manual actions&quot; as this is fully supported by Ash, and is the commonly used approach.</p><p>This approach is most appropriate when you are working with an API that exposes some data, like entities, list of entities, etc. For this example, we will be interacting with <a href="https://openlibrary.org">https://openlibrary.org</a>, which allows for us to search and list books.</p><p>This guide covers reading data from the external API, not creating/updating it. This can be implemented using manual actions of a different type, or generic actions.</p><h2 id="wrapping-external-apis">Wrapping External APIs</h2><ol><li>Create a resource for interacting with the given API</li><li>Create a manual read action</li><li>In this manual action, we will:<ol><li>call the target API</li><li>transform the results</li><li>apply query operations to simulate capabilities provided by Ash</li></ol></li></ol><p>In the example below, we are calling to a <em>paginated</em> API, and we want to continue fetching results until we have reached the amount of results requested by the <a href="Ash.Query.xhtml"><code class="inline">Ash.Query</code></a>. We show this to illustrate that you can do all kinds of creative things when working with external APIs in manual actions.</p><h2 id="example">Example</h2><!-- livebook:{"disable_formatting":true} --><pre><code class="makeup elixir" translate="no"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Doc</span><span class="w"> </span><span class="k" data-group-id="4627652980-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Ash.Resource</span><span class="p">,</span><span class="w">
    </span><span class="ss">domain</span><span class="p">:</span><span class="w"> </span><span class="nc">Domain</span><span class="w">

  </span><span class="n">attributes</span><span class="w"> </span><span class="k" data-group-id="4627652980-2">do</span><span class="w">
    </span><span class="n">uuid_primary_key</span><span class="w"> </span><span class="ss">:id</span><span class="w">
    </span><span class="n">attribute</span><span class="w"> </span><span class="ss">:author_name</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="w">
    </span><span class="n">attribute</span><span class="w"> </span><span class="ss">:title</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="w">
    </span><span class="n">attribute</span><span class="w"> </span><span class="ss">:type</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="w">
  </span><span class="k" data-group-id="4627652980-2">end</span><span class="w">

  </span><span class="n">actions</span><span class="w"> </span><span class="k" data-group-id="4627652980-3">do</span><span class="w">
    </span><span class="n">read</span><span class="w"> </span><span class="ss">:search</span><span class="w"> </span><span class="k" data-group-id="4627652980-4">do</span><span class="w">
      </span><span class="n">primary?</span><span class="w"> </span><span class="no">true</span><span class="w">
      </span><span class="n">argument</span><span class="w"> </span><span class="ss">:query</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">allow_nil?</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
      </span><span class="n">prepare</span><span class="w"> </span><span class="k" data-group-id="4627652980-5">fn</span><span class="w"> </span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="c1"># We require that they limit the results to some reasonable set</span><span class="w">
        </span><span class="c1"># (because this API is huge)</span><span class="w">
        </span><span class="k">cond</span><span class="w"> </span><span class="k" data-group-id="4627652980-6">do</span><span class="w">
          </span><span class="n">query</span><span class="o">.</span><span class="n">limit</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">query</span><span class="o">.</span><span class="n">limit</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">250</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
            </span><span class="nc">Ash.Query</span><span class="o">.</span><span class="n">add_error</span><span class="p" data-group-id="4627652980-7">(</span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;must supply a limit that is less than or equal to 250&quot;</span><span class="p" data-group-id="4627652980-7">)</span><span class="w">
          </span><span class="n">query</span><span class="o">.</span><span class="n">limit</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
            </span><span class="n">query</span><span class="w">
          </span><span class="no">true</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
            </span><span class="c1"># limit 5 by default</span><span class="w">
            </span><span class="nc">Ash.Query</span><span class="o">.</span><span class="n">limit</span><span class="p" data-group-id="4627652980-8">(</span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p" data-group-id="4627652980-8">)</span><span class="w">
        </span><span class="k" data-group-id="4627652980-6">end</span><span class="w">
      </span><span class="k" data-group-id="4627652980-5">end</span><span class="w">

      </span><span class="n">manual</span><span class="w"> </span><span class="nc">Doc.Actions.Read</span><span class="w">
    </span><span class="k" data-group-id="4627652980-4">end</span><span class="w">
  </span><span class="k" data-group-id="4627652980-3">end</span><span class="w">
</span><span class="k" data-group-id="4627652980-1">end</span><span class="w">

</span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Domain</span><span class="w"> </span><span class="k" data-group-id="4627652980-9">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Ash.Domain</span><span class="p">,</span><span class="w">
    </span><span class="ss">validate_config_inclusion?</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">

  </span><span class="n">resources</span><span class="w"> </span><span class="k" data-group-id="4627652980-10">do</span><span class="w">
    </span><span class="n">resource</span><span class="w"> </span><span class="nc">Doc</span><span class="w"> </span><span class="k" data-group-id="4627652980-11">do</span><span class="w">
      </span><span class="n">define</span><span class="w"> </span><span class="ss">:search</span><span class="p">,</span><span class="w"> </span><span class="ss">args</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4627652980-12">[</span><span class="ss">:query</span><span class="p" data-group-id="4627652980-12">]</span><span class="w">
    </span><span class="k" data-group-id="4627652980-11">end</span><span class="w">
  </span><span class="k" data-group-id="4627652980-10">end</span><span class="w">
</span><span class="k" data-group-id="4627652980-9">end</span></code></pre><pre><code class="makeup output" translate="no"><span class="p" data-group-id="1169291049-1">{</span><span class="ss">:module</span><span class="p">,</span><span class="w"> </span><span class="nc">Domain</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1169291049-2">&lt;&lt;</span><span class="mi">70</span><span class="p">,</span><span class="w"> </span><span class="mi">79</span><span class="p">,</span><span class="w"> </span><span class="mi">82</span><span class="p">,</span><span class="w"> </span><span class="mi">49</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">250</span><span class="p">,</span><span class="w"> </span><span class="n">...</span><span class="p" data-group-id="1169291049-2">&gt;&gt;</span><span class="p">,</span><span class="w">
 </span><span class="p" data-group-id="1169291049-3">[</span><span class="w">
   </span><span class="nc">Ash.Domain.Dsl.Resources.Resource</span><span class="p">,</span><span class="w">
   </span><span class="nc">Ash.Domain.Dsl.Resources.Options</span><span class="p">,</span><span class="w">
   </span><span class="nc">Ash.Domain.Dsl</span><span class="p">,</span><span class="w">
   </span><span class="p" data-group-id="1169291049-4">%{</span><span class="ss">opts</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1169291049-5">[</span><span class="p" data-group-id="1169291049-5">]</span><span class="p">,</span><span class="w"> </span><span class="ss">entities</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1169291049-6">[</span><span class="n">...</span><span class="p" data-group-id="1169291049-6">]</span><span class="p" data-group-id="1169291049-4">}</span><span class="p">,</span><span class="w">
   </span><span class="nc">Ash.Domain.Dsl</span><span class="p">,</span><span class="w">
   </span><span class="nc">Ash.Domain.Dsl.Resources.Options</span><span class="p">,</span><span class="w">
   </span><span class="n">...</span><span class="w">
 </span><span class="p" data-group-id="1169291049-3">]</span><span class="p" data-group-id="1169291049-1">}</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Doc.Actions.Read</span><span class="w"> </span><span class="k" data-group-id="9838873170-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Ash.Resource.ManualRead</span><span class="w">

  </span><span class="kd">def</span><span class="w"> </span><span class="nf">read</span><span class="p" data-group-id="9838873170-2">(</span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="c">_opts</span><span class="p">,</span><span class="w"> </span><span class="c">_context</span><span class="p" data-group-id="9838873170-2">)</span><span class="w"> </span><span class="k" data-group-id="9838873170-3">do</span><span class="w">
    </span><span class="c1"># we aren&#39;t handling these query options to keep the example simple</span><span class="w">
    </span><span class="c1"># but you could on your own</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">query</span><span class="o">.</span><span class="n">sort</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="p" data-group-id="9838873170-4">[</span><span class="p" data-group-id="9838873170-4">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">query</span><span class="o">.</span><span class="n">offset</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="9838873170-5">do</span><span class="w">
      </span><span class="p" data-group-id="9838873170-6">{</span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Cannot sort or offset documents&quot;</span><span class="p" data-group-id="9838873170-6">}</span><span class="w">
    </span><span class="k" data-group-id="9838873170-5">end</span><span class="w">

    </span><span class="k">if</span><span class="w"> </span><span class="n">query</span><span class="o">.</span><span class="n">sort</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">query</span><span class="o">.</span><span class="n">sort</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="p" data-group-id="9838873170-7">[</span><span class="p" data-group-id="9838873170-7">]</span><span class="w"> </span><span class="k" data-group-id="9838873170-8">do</span><span class="w">
      </span><span class="k">raise</span><span class="w"> </span><span class="s">&quot;Cannot apply a sort to docs read&quot;</span><span class="w">
    </span><span class="k" data-group-id="9838873170-8">end</span><span class="w">

    </span><span class="k">if</span><span class="w"> </span><span class="n">query</span><span class="o">.</span><span class="n">offset</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">query</span><span class="o">.</span><span class="n">offset</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="9838873170-9">do</span><span class="w">
      </span><span class="k">raise</span><span class="w"> </span><span class="s">&quot;Cannot apply a sort to docs read&quot;</span><span class="w">
    </span><span class="k" data-group-id="9838873170-9">end</span><span class="w">

    </span><span class="n">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">query</span><span class="o">.</span><span class="n">limit</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ss">:infinity</span><span class="w">

    </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Ash.Query</span><span class="o">.</span><span class="n">unset</span><span class="p" data-group-id="9838873170-10">(</span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="ss">:limit</span><span class="p" data-group-id="9838873170-10">)</span><span class="w">

    </span><span class="n">query_results</span><span class="w"> </span><span class="o">=</span><span class="w">
      </span><span class="nc">Stream</span><span class="o">.</span><span class="n">resource</span><span class="p" data-group-id="9838873170-11">(</span><span class="w">
        </span><span class="k" data-group-id="9838873170-12">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
          </span><span class="p" data-group-id="9838873170-13">{</span><span class="n">limit</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="9838873170-13">}</span><span class="w">
        </span><span class="k" data-group-id="9838873170-12">end</span><span class="p">,</span><span class="w">
        </span><span class="k" data-group-id="9838873170-14">fn</span><span class="w">
          </span><span class="p" data-group-id="9838873170-15">{</span><span class="n">remaining</span><span class="p">,</span><span class="w"> </span><span class="n">page_number</span><span class="p" data-group-id="9838873170-15">}</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">remaining</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
            </span><span class="p" data-group-id="9838873170-16">{</span><span class="ss">:halt</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9838873170-17">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">page_number</span><span class="p" data-group-id="9838873170-17">}</span><span class="p" data-group-id="9838873170-16">}</span><span class="w">

          </span><span class="p" data-group-id="9838873170-18">{</span><span class="n">remaining</span><span class="p">,</span><span class="w"> </span><span class="n">page_number</span><span class="p" data-group-id="9838873170-18">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
            </span><span class="n">api_results</span><span class="w"> </span><span class="o">=</span><span class="w">
              </span><span class="n">query</span><span class="o">.</span><span class="n">arguments</span><span class="o">.</span><span class="n">query</span><span class="w">
              </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">get!</span><span class="p" data-group-id="9838873170-19">(</span><span class="n">page_number</span><span class="p" data-group-id="9838873170-19">)</span><span class="w">
              </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="9838873170-20">(</span><span class="o">&amp;</span><span class="n">to_doc</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="9838873170-20">)</span><span class="w">

            </span><span class="k">case</span><span class="w"> </span><span class="nc">Ash.Query</span><span class="o">.</span><span class="n">apply_to</span><span class="p" data-group-id="9838873170-21">(</span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="n">api_results</span><span class="p" data-group-id="9838873170-21">)</span><span class="w"> </span><span class="k" data-group-id="9838873170-22">do</span><span class="w">
              </span><span class="p" data-group-id="9838873170-23">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9838873170-24">[</span><span class="p" data-group-id="9838873170-24">]</span><span class="p" data-group-id="9838873170-23">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
                </span><span class="p" data-group-id="9838873170-25">{</span><span class="ss">:halt</span><span class="p">,</span><span class="w"> </span><span class="n">remaining</span><span class="p" data-group-id="9838873170-25">}</span><span class="w">

              </span><span class="p" data-group-id="9838873170-26">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p" data-group-id="9838873170-26">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
                </span><span class="n">count_of_results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">count</span><span class="p" data-group-id="9838873170-27">(</span><span class="n">results</span><span class="p" data-group-id="9838873170-27">)</span><span class="w">

                </span><span class="k">cond</span><span class="w"> </span><span class="k" data-group-id="9838873170-28">do</span><span class="w">
                  </span><span class="c1"># the api gives us batches of 100</span><span class="w">
                  </span><span class="n">remaining</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">:infinity</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">count_of_results</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
                    </span><span class="p" data-group-id="9838873170-29">{</span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9838873170-30">{</span><span class="ss">:infinity</span><span class="p">,</span><span class="w"> </span><span class="n">page_number</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="9838873170-30">}</span><span class="p" data-group-id="9838873170-29">}</span><span class="w">

                  </span><span class="n">remaining</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">:infinity</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
                    </span><span class="p" data-group-id="9838873170-31">{</span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9838873170-32">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">page_number</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="9838873170-32">}</span><span class="p" data-group-id="9838873170-31">}</span><span class="w">

                  </span><span class="no">true</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
                    </span><span class="n">still_remaining</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">remaining</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">count_of_results</span><span class="w">

                    </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w">
                      </span><span class="k">if</span><span class="w"> </span><span class="n">still_remaining</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="9838873170-33">do</span><span class="w">
                        </span><span class="nc">Enum</span><span class="o">.</span><span class="n">take</span><span class="p" data-group-id="9838873170-34">(</span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">remaining</span><span class="p" data-group-id="9838873170-34">)</span><span class="w">
                      </span><span class="k" data-group-id="9838873170-33">else</span><span class="w">
                        </span><span class="n">results</span><span class="w">
                      </span><span class="k" data-group-id="9838873170-33">end</span><span class="w">

                    </span><span class="p" data-group-id="9838873170-35">{</span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9838873170-36">{</span><span class="n">still_remaining</span><span class="p">,</span><span class="w"> </span><span class="n">page_number</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="9838873170-36">}</span><span class="p" data-group-id="9838873170-35">}</span><span class="w">
                </span><span class="k" data-group-id="9838873170-28">end</span><span class="w">

              </span><span class="p" data-group-id="9838873170-37">{</span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p" data-group-id="9838873170-37">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
                </span><span class="k">raise</span><span class="w"> </span><span class="nc">Ash.Error</span><span class="o">.</span><span class="n">to_ash_error</span><span class="p" data-group-id="9838873170-38">(</span><span class="n">error</span><span class="p" data-group-id="9838873170-38">)</span><span class="w">
            </span><span class="k" data-group-id="9838873170-22">end</span><span class="w">
        </span><span class="k" data-group-id="9838873170-14">end</span><span class="p">,</span><span class="w">
        </span><span class="k" data-group-id="9838873170-39">fn</span><span class="w"> </span><span class="bp">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ss">:ok</span><span class="w"> </span><span class="k" data-group-id="9838873170-39">end</span><span class="w">
      </span><span class="p" data-group-id="9838873170-11">)</span><span class="w">
      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">to_list</span><span class="p" data-group-id="9838873170-40">(</span><span class="p" data-group-id="9838873170-40">)</span><span class="w">

    </span><span class="p" data-group-id="9838873170-41">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">query_results</span><span class="p" data-group-id="9838873170-41">}</span><span class="w">
  </span><span class="k" data-group-id="9838873170-3">end</span><span class="w">

  </span><span class="kd">defp</span><span class="w"> </span><span class="nf">to_doc</span><span class="p" data-group-id="9838873170-42">(</span><span class="n">api_doc</span><span class="p" data-group-id="9838873170-42">)</span><span class="w"> </span><span class="k" data-group-id="9838873170-43">do</span><span class="w">
    </span><span class="p" data-group-id="9838873170-44">%</span><span class="nc" data-group-id="9838873170-44">Doc</span><span class="p" data-group-id="9838873170-44">{</span><span class="ss">author_name</span><span class="p">:</span><span class="w"> </span><span class="n">api_doc</span><span class="p" data-group-id="9838873170-45">[</span><span class="s">&quot;author_name&quot;</span><span class="p" data-group-id="9838873170-45">]</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="n">api_doc</span><span class="p" data-group-id="9838873170-46">[</span><span class="s">&quot;type&quot;</span><span class="p" data-group-id="9838873170-46">]</span><span class="p">,</span><span class="w"> </span><span class="ss">title</span><span class="p">:</span><span class="w"> </span><span class="n">api_doc</span><span class="p" data-group-id="9838873170-47">[</span><span class="s">&quot;title&quot;</span><span class="p" data-group-id="9838873170-47">]</span><span class="p" data-group-id="9838873170-44">}</span><span class="w">
  </span><span class="k" data-group-id="9838873170-43">end</span><span class="w">

  </span><span class="kd">defp</span><span class="w"> </span><span class="nf">get!</span><span class="p" data-group-id="9838873170-48">(</span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="n">page</span><span class="p" data-group-id="9838873170-48">)</span><span class="w"> </span><span class="k" data-group-id="9838873170-49">do</span><span class="w">
    </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="9838873170-50">do</span><span class="w">
        </span><span class="p" data-group-id="9838873170-51">[</span><span class="ss">q</span><span class="p">:</span><span class="w"> </span><span class="n">query</span><span class="p" data-group-id="9838873170-51">]</span><span class="w">
      </span><span class="k" data-group-id="9838873170-50">else</span><span class="w">
        </span><span class="p" data-group-id="9838873170-52">[</span><span class="ss">q</span><span class="p">:</span><span class="w"> </span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="ss">page</span><span class="p">:</span><span class="w"> </span><span class="n">page</span><span class="p" data-group-id="9838873170-52">]</span><span class="w">
      </span><span class="k" data-group-id="9838873170-50">end</span><span class="w">

    </span><span class="nc">Req</span><span class="o">.</span><span class="n">get!</span><span class="p" data-group-id="9838873170-53">(</span><span class="s">&quot;https://openlibrary.org/search.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">params</span><span class="p">:</span><span class="w"> </span><span class="n">params</span><span class="p" data-group-id="9838873170-53">)</span><span class="o">.</span><span class="n">body</span><span class="p" data-group-id="9838873170-54">[</span><span class="s">&quot;docs&quot;</span><span class="p" data-group-id="9838873170-54">]</span><span class="w">
  </span><span class="k" data-group-id="9838873170-49">end</span><span class="w">
</span><span class="k" data-group-id="9838873170-1">end</span></code></pre><pre><code class="makeup output" translate="no"><span class="p" data-group-id="3779804273-1">{</span><span class="ss">:module</span><span class="p">,</span><span class="w"> </span><span class="nc">Doc.Actions.Read</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3779804273-2">&lt;&lt;</span><span class="mi">70</span><span class="p">,</span><span class="w"> </span><span class="mi">79</span><span class="p">,</span><span class="w"> </span><span class="mi">82</span><span class="p">,</span><span class="w"> </span><span class="mi">49</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="n">...</span><span class="p" data-group-id="3779804273-2">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3779804273-3">{</span><span class="ss">:get!</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="3779804273-3">}</span><span class="p" data-group-id="3779804273-1">}</span></code></pre><h2 id="now-we-can-use-this-like-any-other-ash-resource">Now we can use this like any other Ash resource</h2><pre><code class="makeup elixir" translate="no"><span class="nc">Domain</span><span class="o">.</span><span class="n">search!</span><span class="p" data-group-id="6714806499-1">(</span><span class="s">&quot;Lord of the rings&quot;</span><span class="p" data-group-id="6714806499-1">)</span></code></pre><pre><code class="makeup output" translate="no"><span class="p" data-group-id="3499000122-1">[</span><span class="w">
  </span><span class="p" data-group-id="3499000122-2">#</span><span class="nc" data-group-id="3499000122-2">Doc</span><span class="p" data-group-id="3499000122-2">&lt;</span><span class="w">
    </span><span class="ss">__meta__</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-3">#</span><span class="nc" data-group-id="3499000122-3">Ecto.Schema.Metadata</span><span class="p" data-group-id="3499000122-3">&lt;</span><span class="ss">:built</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p" data-group-id="3499000122-3">&gt;</span><span class="p">,</span><span class="w">
    </span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="p">,</span><span class="w">
    </span><span class="ss">author_name</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-4">[</span><span class="s">&quot;J.R.R. Tolkien&quot;</span><span class="p" data-group-id="3499000122-4">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The Lord of the Rings&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;work&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">aggregates</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-5">%{</span><span class="p" data-group-id="3499000122-5">}</span><span class="p">,</span><span class="w">
    </span><span class="ss">calculations</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-6">%{</span><span class="p" data-group-id="3499000122-6">}</span><span class="p">,</span><span class="w">
    </span><span class="n">...</span><span class="w">
  </span><span class="p" data-group-id="3499000122-2">&gt;</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="3499000122-7">#</span><span class="nc" data-group-id="3499000122-7">Doc</span><span class="p" data-group-id="3499000122-7">&lt;</span><span class="w">
    </span><span class="ss">__meta__</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-8">#</span><span class="nc" data-group-id="3499000122-8">Ecto.Schema.Metadata</span><span class="p" data-group-id="3499000122-8">&lt;</span><span class="ss">:built</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p" data-group-id="3499000122-8">&gt;</span><span class="p">,</span><span class="w">
    </span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="p">,</span><span class="w">
    </span><span class="ss">author_name</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-9">[</span><span class="s">&quot;J.R.R. Tolkien&quot;</span><span class="p" data-group-id="3499000122-9">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The Fellowship of the Ring&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;work&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">aggregates</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-10">%{</span><span class="p" data-group-id="3499000122-10">}</span><span class="p">,</span><span class="w">
    </span><span class="ss">calculations</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-11">%{</span><span class="p" data-group-id="3499000122-11">}</span><span class="p">,</span><span class="w">
    </span><span class="n">...</span><span class="w">
  </span><span class="p" data-group-id="3499000122-7">&gt;</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="3499000122-12">#</span><span class="nc" data-group-id="3499000122-12">Doc</span><span class="p" data-group-id="3499000122-12">&lt;</span><span class="w">
    </span><span class="ss">__meta__</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-13">#</span><span class="nc" data-group-id="3499000122-13">Ecto.Schema.Metadata</span><span class="p" data-group-id="3499000122-13">&lt;</span><span class="ss">:built</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p" data-group-id="3499000122-13">&gt;</span><span class="p">,</span><span class="w">
    </span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="p">,</span><span class="w">
    </span><span class="ss">author_name</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-14">[</span><span class="s">&quot;J.R.R. Tolkien&quot;</span><span class="p" data-group-id="3499000122-14">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The Two Towers&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;work&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">aggregates</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-15">%{</span><span class="p" data-group-id="3499000122-15">}</span><span class="p">,</span><span class="w">
    </span><span class="ss">calculations</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-16">%{</span><span class="p" data-group-id="3499000122-16">}</span><span class="p">,</span><span class="w">
    </span><span class="n">...</span><span class="w">
  </span><span class="p" data-group-id="3499000122-12">&gt;</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="3499000122-17">#</span><span class="nc" data-group-id="3499000122-17">Doc</span><span class="p" data-group-id="3499000122-17">&lt;</span><span class="w">
    </span><span class="ss">__meta__</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-18">#</span><span class="nc" data-group-id="3499000122-18">Ecto.Schema.Metadata</span><span class="p" data-group-id="3499000122-18">&lt;</span><span class="ss">:built</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p" data-group-id="3499000122-18">&gt;</span><span class="p">,</span><span class="w">
    </span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="p">,</span><span class="w">
    </span><span class="ss">author_name</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-19">[</span><span class="s">&quot;J.R.R. Tolkien&quot;</span><span class="p" data-group-id="3499000122-19">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The Return of the King&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;work&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">aggregates</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-20">%{</span><span class="p" data-group-id="3499000122-20">}</span><span class="p">,</span><span class="w">
    </span><span class="ss">calculations</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-21">%{</span><span class="p" data-group-id="3499000122-21">}</span><span class="p">,</span><span class="w">
    </span><span class="n">...</span><span class="w">
  </span><span class="p" data-group-id="3499000122-17">&gt;</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="3499000122-22">#</span><span class="nc" data-group-id="3499000122-22">Doc</span><span class="p" data-group-id="3499000122-22">&lt;</span><span class="w">
    </span><span class="ss">__meta__</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-23">#</span><span class="nc" data-group-id="3499000122-23">Ecto.Schema.Metadata</span><span class="p" data-group-id="3499000122-23">&lt;</span><span class="ss">:built</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p" data-group-id="3499000122-23">&gt;</span><span class="p">,</span><span class="w">
    </span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="p">,</span><span class="w">
    </span><span class="ss">author_name</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-24">[</span><span class="s">&quot;J.R.R. Tolkien&quot;</span><span class="p" data-group-id="3499000122-24">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The Lord of the Rings&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;work&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">aggregates</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-25">%{</span><span class="p" data-group-id="3499000122-25">}</span><span class="p">,</span><span class="w">
    </span><span class="ss">calculations</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3499000122-26">%{</span><span class="p" data-group-id="3499000122-26">}</span><span class="p">,</span><span class="w">
    </span><span class="n">...</span><span class="w">
  </span><span class="p" data-group-id="3499000122-22">&gt;</span><span class="w">
</span><span class="p" data-group-id="3499000122-1">]</span></code></pre><pre><code class="makeup elixir" translate="no"><span class="kn">require</span><span class="w"> </span><span class="nc">Ash.Query</span><span class="w">
</span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Doc</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Ash.Query</span><span class="o">.</span><span class="n">filter</span><span class="p" data-group-id="3239331736-1">(</span><span class="n">contains</span><span class="p" data-group-id="3239331736-2">(</span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Two&quot;</span><span class="p" data-group-id="3239331736-2">)</span><span class="p" data-group-id="3239331736-1">)</span><span class="w">
</span><span class="nc">Domain</span><span class="o">.</span><span class="n">search!</span><span class="p" data-group-id="3239331736-3">(</span><span class="s">&quot;Lord of the rings&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">query</span><span class="p">:</span><span class="w"> </span><span class="n">query</span><span class="p" data-group-id="3239331736-3">)</span></code></pre><pre><code class="makeup output" translate="no"><span class="p" data-group-id="7745534623-1">[</span><span class="w">
  </span><span class="p" data-group-id="7745534623-2">#</span><span class="nc" data-group-id="7745534623-2">Doc</span><span class="p" data-group-id="7745534623-2">&lt;</span><span class="w">
    </span><span class="ss">__meta__</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-3">#</span><span class="nc" data-group-id="7745534623-3">Ecto.Schema.Metadata</span><span class="p" data-group-id="7745534623-3">&lt;</span><span class="ss">:built</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p" data-group-id="7745534623-3">&gt;</span><span class="p">,</span><span class="w">
    </span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="p">,</span><span class="w">
    </span><span class="ss">author_name</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-4">[</span><span class="s">&quot;J.R.R. Tolkien&quot;</span><span class="p" data-group-id="7745534623-4">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The Two Towers&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;work&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">aggregates</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-5">%{</span><span class="p" data-group-id="7745534623-5">}</span><span class="p">,</span><span class="w">
    </span><span class="ss">calculations</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-6">%{</span><span class="p" data-group-id="7745534623-6">}</span><span class="p">,</span><span class="w">
    </span><span class="n">...</span><span class="w">
  </span><span class="p" data-group-id="7745534623-2">&gt;</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="7745534623-7">#</span><span class="nc" data-group-id="7745534623-7">Doc</span><span class="p" data-group-id="7745534623-7">&lt;</span><span class="w">
    </span><span class="ss">__meta__</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-8">#</span><span class="nc" data-group-id="7745534623-8">Ecto.Schema.Metadata</span><span class="p" data-group-id="7745534623-8">&lt;</span><span class="ss">:built</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p" data-group-id="7745534623-8">&gt;</span><span class="p">,</span><span class="w">
    </span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="p">,</span><span class="w">
    </span><span class="ss">author_name</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-9">[</span><span class="s">&quot;Alessio Cavatore&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Rick Priestley&quot;</span><span class="p" data-group-id="7745534623-9">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The Lord of the Rings - The Two Towers&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;work&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">aggregates</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-10">%{</span><span class="p" data-group-id="7745534623-10">}</span><span class="p">,</span><span class="w">
    </span><span class="ss">calculations</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-11">%{</span><span class="p" data-group-id="7745534623-11">}</span><span class="p">,</span><span class="w">
    </span><span class="n">...</span><span class="w">
  </span><span class="p" data-group-id="7745534623-7">&gt;</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="7745534623-12">#</span><span class="nc" data-group-id="7745534623-12">Doc</span><span class="p" data-group-id="7745534623-12">&lt;</span><span class="w">
    </span><span class="ss">__meta__</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-13">#</span><span class="nc" data-group-id="7745534623-13">Ecto.Schema.Metadata</span><span class="p" data-group-id="7745534623-13">&lt;</span><span class="ss">:built</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p" data-group-id="7745534623-13">&gt;</span><span class="p">,</span><span class="w">
    </span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="p">,</span><span class="w">
    </span><span class="ss">author_name</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-14">[</span><span class="s">&quot;J.R.R. Tolkien&quot;</span><span class="p" data-group-id="7745534623-14">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The Two Towers&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;work&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">aggregates</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-15">%{</span><span class="p" data-group-id="7745534623-15">}</span><span class="p">,</span><span class="w">
    </span><span class="ss">calculations</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-16">%{</span><span class="p" data-group-id="7745534623-16">}</span><span class="p">,</span><span class="w">
    </span><span class="n">...</span><span class="w">
  </span><span class="p" data-group-id="7745534623-12">&gt;</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="7745534623-17">#</span><span class="nc" data-group-id="7745534623-17">Doc</span><span class="p" data-group-id="7745534623-17">&lt;</span><span class="w">
    </span><span class="ss">__meta__</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-18">#</span><span class="nc" data-group-id="7745534623-18">Ecto.Schema.Metadata</span><span class="p" data-group-id="7745534623-18">&lt;</span><span class="ss">:built</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p" data-group-id="7745534623-18">&gt;</span><span class="p">,</span><span class="w">
    </span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="p">,</span><span class="w">
    </span><span class="ss">author_name</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-19">[</span><span class="s">&quot;Alessio Cavatore&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Rick Priestley&quot;</span><span class="p" data-group-id="7745534623-19">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The Lord of the Rings - The Two Towers&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;work&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">aggregates</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-20">%{</span><span class="p" data-group-id="7745534623-20">}</span><span class="p">,</span><span class="w">
    </span><span class="ss">calculations</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-21">%{</span><span class="p" data-group-id="7745534623-21">}</span><span class="p">,</span><span class="w">
    </span><span class="n">...</span><span class="w">
  </span><span class="p" data-group-id="7745534623-17">&gt;</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="7745534623-22">#</span><span class="nc" data-group-id="7745534623-22">Doc</span><span class="p" data-group-id="7745534623-22">&lt;</span><span class="w">
    </span><span class="ss">__meta__</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-23">#</span><span class="nc" data-group-id="7745534623-23">Ecto.Schema.Metadata</span><span class="p" data-group-id="7745534623-23">&lt;</span><span class="ss">:built</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p" data-group-id="7745534623-23">&gt;</span><span class="p">,</span><span class="w">
    </span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="p">,</span><span class="w">
    </span><span class="ss">author_name</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-24">[</span><span class="s">&quot;J.R.R. Tolkien&quot;</span><span class="p" data-group-id="7745534623-24">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Two Towers : The Lord of the Rings&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;work&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">aggregates</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-25">%{</span><span class="p" data-group-id="7745534623-25">}</span><span class="p">,</span><span class="w">
    </span><span class="ss">calculations</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7745534623-26">%{</span><span class="p" data-group-id="7745534623-26">}</span><span class="p">,</span><span class="w">
    </span><span class="n">...</span><span class="w">
  </span><span class="p" data-group-id="7745534623-22">&gt;</span><span class="w">
</span><span class="p" data-group-id="7745534623-1">]</span></code></pre>

  </body>
</html>
