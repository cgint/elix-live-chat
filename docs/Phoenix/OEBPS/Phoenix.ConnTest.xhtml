<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <title>Phoenix.ConnTest - Phoenix v1.7.21</title>
    <meta name="generator" content="ExDoc v0.37.3" />
    <link type="text/css" rel="stylesheet" href="dist/epub-elixir-FNUUKFP7.css" />
    <script src="dist/epub-4WIP524F.js"></script>

  </head>
  <body class="content-inner">

    <h1 id="content">
Phoenix.ConnTest 
    </h1>


      <section id="moduledoc" class="docstring">
<p>Conveniences for testing Phoenix endpoints and connection related helpers.</p><p>You likely want to use this module or make it part of your <a href="https://hexdocs.pm/ex_unit/ExUnit.CaseTemplate.html"><code class="inline">ExUnit.CaseTemplate</code></a>.
Once used, this module automatically imports all functions defined here as
well as the functions in <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html"><code class="inline">Plug.Conn</code></a>.</p><h2 id="module-endpoint-testing" class="section-heading">
  <a href="#module-endpoint-testing" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Endpoint testing</span>
</h2>
<p><a href="Phoenix.ConnTest.xhtml"><code class="inline">Phoenix.ConnTest</code></a> typically works against endpoints. That's the preferred way
to test anything that your router dispatches to:</p><pre><code class="makeup elixir" translate="no"><samp class="na">@endpoint</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.Endpoint</samp><samp class="w">

</samp><samp class="n">test</samp><samp class="w"> </samp><samp class="s">&quot;says welcome on the home page&quot;</samp><samp class="w"> </samp><samp class="k" data-group-id="1798958937-1">do</samp><samp class="w">
  </samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">get</samp><samp class="p" data-group-id="1798958937-2">(</samp><samp class="n">build_conn</samp><samp class="p" data-group-id="1798958937-3">(</samp><samp class="p" data-group-id="1798958937-3">)</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;/&quot;</samp><samp class="p" data-group-id="1798958937-2">)</samp><samp class="w">
  </samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">conn</samp><samp class="o">.</samp><samp class="n">resp_body</samp><samp class="w"> </samp><samp class="o">=~</samp><samp class="w"> </samp><samp class="s">&quot;Welcome!&quot;</samp><samp class="w">
</samp><samp class="k" data-group-id="1798958937-1">end</samp><samp class="w">

</samp><samp class="n">test</samp><samp class="w"> </samp><samp class="s">&quot;logs in&quot;</samp><samp class="w"> </samp><samp class="k" data-group-id="1798958937-4">do</samp><samp class="w">
  </samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">post</samp><samp class="p" data-group-id="1798958937-5">(</samp><samp class="n">build_conn</samp><samp class="p" data-group-id="1798958937-6">(</samp><samp class="p" data-group-id="1798958937-6">)</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;/login&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="1798958937-7">[</samp><samp class="ss">username</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;john&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">password</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;doe&quot;</samp><samp class="p" data-group-id="1798958937-7">]</samp><samp class="p" data-group-id="1798958937-5">)</samp><samp class="w">
  </samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">conn</samp><samp class="o">.</samp><samp class="n">resp_body</samp><samp class="w"> </samp><samp class="o">=~</samp><samp class="w"> </samp><samp class="s">&quot;Logged in!&quot;</samp><samp class="w">
</samp><samp class="k" data-group-id="1798958937-4">end</samp></code></pre><p>The <code class="inline">@endpoint</code> module attribute contains the endpoint under testing,
most commonly your application endpoint itself. If you are using the
MyApp.ConnCase generated by Phoenix, it is automatically set for you.</p><p>As in your router and controllers, the connection is the main abstraction
in testing. <code class="inline">build_conn()</code> returns a new connection and functions in this
module can be used to manipulate the connection before dispatching
to the endpoint.</p><p>For example, one could set the accepts header for json requests as
follows:</p><pre><code class="makeup elixir" translate="no"><samp class="n">build_conn</samp><samp class="p" data-group-id="0623444926-1">(</samp><samp class="p" data-group-id="0623444926-1">)</samp><samp class="w">
</samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">put_req_header</samp><samp class="p" data-group-id="0623444926-2">(</samp><samp class="s">&quot;accept&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;application/json&quot;</samp><samp class="p" data-group-id="0623444926-2">)</samp><samp class="w">
</samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">get</samp><samp class="p" data-group-id="0623444926-3">(</samp><samp class="s">&quot;/&quot;</samp><samp class="p" data-group-id="0623444926-3">)</samp></code></pre><p>You can also create your own helpers, such as <code class="inline">json_conn()</code> that uses
<a href="#build_conn/0"><code class="inline">build_conn/0</code></a> and <code class="inline">put_req_header/3</code>, so you avoid repeating the connection
setup throughout your tests.</p><h2 id="module-controller-testing" class="section-heading">
  <a href="#module-controller-testing" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Controller testing</span>
</h2>
<p>The functions in this module can also be used for controller testing.
While endpoint testing is preferred over controller testing, especially
since the controller in Phoenix plays an integration role between your
domain and your views, unit testing controllers may be helpful in some
situations.</p><p>For such cases, you need to set the <code class="inline">@endpoint</code> attribute to your controller
and pass an atom representing the action to dispatch:</p><pre><code class="makeup elixir" translate="no"><samp class="na">@endpoint</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.HomeController</samp><samp class="w">

</samp><samp class="n">test</samp><samp class="w"> </samp><samp class="s">&quot;says welcome on the home page&quot;</samp><samp class="w"> </samp><samp class="k" data-group-id="2028358348-1">do</samp><samp class="w">
  </samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">get</samp><samp class="p" data-group-id="2028358348-2">(</samp><samp class="n">build_conn</samp><samp class="p" data-group-id="2028358348-3">(</samp><samp class="p" data-group-id="2028358348-3">)</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:index</samp><samp class="p" data-group-id="2028358348-2">)</samp><samp class="w">
  </samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">conn</samp><samp class="o">.</samp><samp class="n">resp_body</samp><samp class="w"> </samp><samp class="o">=~</samp><samp class="w"> </samp><samp class="s">&quot;Welcome!&quot;</samp><samp class="w">
</samp><samp class="k" data-group-id="2028358348-1">end</samp></code></pre><p>Keep in mind that, once the <code class="inline">@endpoint</code> variable is set, all tests after
setting it will be affected.</p><h2 id="module-views-testing" class="section-heading">
  <a href="#module-views-testing" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Views testing</span>
</h2>
<p>Under other circumstances, you may be testing a view or another layer that
requires a connection for processing. For such cases, a connection can be
created using the <a href="#build_conn/3"><code class="inline">build_conn/3</code></a> helper:</p><pre><code class="makeup elixir" translate="no"><samp class="nc">MyApp.UserView</samp><samp class="o">.</samp><samp class="n">render</samp><samp class="p" data-group-id="0184051748-1">(</samp><samp class="s">&quot;hello.html&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">conn</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="n">build_conn</samp><samp class="p" data-group-id="0184051748-2">(</samp><samp class="ss">:get</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;/&quot;</samp><samp class="p" data-group-id="0184051748-2">)</samp><samp class="p" data-group-id="0184051748-1">)</samp></code></pre><p>While <a href="#build_conn/0"><code class="inline">build_conn/0</code></a> returns a connection with no request information to it,
<a href="#build_conn/3"><code class="inline">build_conn/3</code></a> returns a connection with the given request information already
filled in.</p><h2 id="module-recycling" class="section-heading">
  <a href="#module-recycling" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Recycling</span>
</h2>
<p>Browsers implement a storage by using cookies. When a cookie is set in the
response, the browser stores it and sends it in the next request.</p><p>To emulate this behaviour, this module provides the idea of recycling.
The <a href="#recycle/1"><code class="inline">recycle/1</code></a> function receives a connection and returns a new connection,
similar to the one returned by <a href="#build_conn/0"><code class="inline">build_conn/0</code></a> with all the response cookies
from the previous connection defined as request headers. This is useful when
testing multiple routes that require cookies or session to work.</p><p>Keep in mind Phoenix will automatically recycle the connection between
dispatches. This usually works out well most times, but it may discard
information if you are modifying the connection before the next dispatch:</p><pre><code class="makeup elixir" translate="no"><samp class="c1"># No recycling as the connection is fresh</samp><samp class="w">
</samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">get</samp><samp class="p" data-group-id="4384635928-1">(</samp><samp class="n">build_conn</samp><samp class="p" data-group-id="4384635928-2">(</samp><samp class="p" data-group-id="4384635928-2">)</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;/&quot;</samp><samp class="p" data-group-id="4384635928-1">)</samp><samp class="w">

</samp><samp class="c1"># The connection is recycled, creating a new one behind the scenes</samp><samp class="w">
</samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">post</samp><samp class="p" data-group-id="4384635928-3">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;/login&quot;</samp><samp class="p" data-group-id="4384635928-3">)</samp><samp class="w">

</samp><samp class="c1"># We can also recycle manually in case we want custom headers</samp><samp class="w">
</samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w">
  </samp><samp class="n">conn</samp><samp class="w">
  </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">recycle</samp><samp class="p" data-group-id="4384635928-4">(</samp><samp class="p" data-group-id="4384635928-4">)</samp><samp class="w">
  </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">put_req_header</samp><samp class="p" data-group-id="4384635928-5">(</samp><samp class="s">&quot;x-special&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;nice&quot;</samp><samp class="p" data-group-id="4384635928-5">)</samp><samp class="w">

</samp><samp class="c1"># No recycling as we did it explicitly</samp><samp class="w">
</samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">delete</samp><samp class="p" data-group-id="4384635928-6">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;/logout&quot;</samp><samp class="p" data-group-id="4384635928-6">)</samp></code></pre><p>Recycling also recycles the &quot;accept&quot; and &quot;authorization&quot; headers,
as well as peer data information.</p>
      </section>


      <section id="summary" class="details-list">
        <h1 class="section-heading">Summary</h1>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#assert_error_sent/2" data-no-tooltip="" translate="no">assert_error_sent(status_int_or_atom, func)</a>

      </div>

        <div class="summary-synopsis"><p>Asserts an error was wrapped and sent with the given status.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#build_conn/0" data-no-tooltip="" translate="no">build_conn()</a>

      </div>

        <div class="summary-synopsis"><p>Creates a connection to be used in upcoming requests.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#build_conn/3" data-no-tooltip="" translate="no">build_conn(method, path, params_or_body \\ nil)</a>

      </div>

        <div class="summary-synopsis"><p>Creates a connection to be used in upcoming requests
with a preset method, path and body.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#bypass_through/1" data-no-tooltip="" translate="no">bypass_through(conn)</a>

      </div>

        <div class="summary-synopsis"><p>Calls the Endpoint and Router pipelines.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#bypass_through/2" data-no-tooltip="" translate="no">bypass_through(conn, router)</a>

      </div>

        <div class="summary-synopsis"><p>Calls the Endpoint and Router pipelines for the current route.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#bypass_through/3" data-no-tooltip="" translate="no">bypass_through(conn, router, pipelines)</a>

      </div>

        <div class="summary-synopsis"><p>Calls the Endpoint and the given Router pipelines.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#clear_flash/1" data-no-tooltip="" translate="no">clear_flash(conn)</a>

      </div>

        <div class="summary-synopsis"><p>Clears up the flash storage.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#connect/3" data-no-tooltip="" translate="no">connect(conn, path_or_action, params_or_body \\ nil)</a>

      </div>

        <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#delete/3" data-no-tooltip="" translate="no">delete(conn, path_or_action, params_or_body \\ nil)</a>

      </div>

        <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#delete_req_cookie/2" data-no-tooltip="" translate="no">delete_req_cookie(conn, key)</a>

      </div>

        <div class="summary-synopsis"><p>Deletes a request cookie.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#dispatch/5" data-no-tooltip="" translate="no">dispatch(conn, endpoint, method, path_or_action, params_or_body \\ nil)</a>

      </div>

        <div class="summary-synopsis"><p>Dispatches the connection to the given endpoint.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#ensure_recycled/1" data-no-tooltip="" translate="no">ensure_recycled(conn)</a>

      </div>

        <div class="summary-synopsis"><p>Ensures the connection is recycled if it wasn't already.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#fetch_flash/1" data-no-tooltip="" translate="no">fetch_flash(conn)</a>

      </div>

        <div class="summary-synopsis"><p>Fetches the flash storage.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get/3" data-no-tooltip="" translate="no">get(conn, path_or_action, params_or_body \\ nil)</a>

      </div>

        <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_flash/1" data-no-tooltip="" translate="no">get_flash(conn)</a>

          <span class="deprecated" title="get_flash/1 is deprecated. Use conn.assigns.flash instead">deprecated</span>

      </div>

        <div class="summary-synopsis"><p>Gets the whole flash storage.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_flash/2" data-no-tooltip="" translate="no">get_flash(conn, key)</a>

          <span class="deprecated" title="get_flash/2 is deprecated. Use Phoenix.Flash.get/2 instead">deprecated</span>

      </div>

        <div class="summary-synopsis"><p>Gets the given key from the flash storage.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#head/3" data-no-tooltip="" translate="no">head(conn, path_or_action, params_or_body \\ nil)</a>

      </div>

        <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#html_response/2" data-no-tooltip="" translate="no">html_response(conn, status)</a>

      </div>

        <div class="summary-synopsis"><p>Asserts the given status code, that we have an html response and
returns the response body if one was set or sent.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#init_test_session/2" data-no-tooltip="" translate="no">init_test_session(conn, session)</a>

      </div>

        <div class="summary-synopsis"><p>Inits a session used exclusively for testing.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#json_response/2" data-no-tooltip="" translate="no">json_response(conn, status)</a>

      </div>

        <div class="summary-synopsis"><p>Asserts the given status code, that we have a json response and
returns the decoded JSON response if one was set or sent.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#options/3" data-no-tooltip="" translate="no">options(conn, path_or_action, params_or_body \\ nil)</a>

      </div>

        <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#patch/3" data-no-tooltip="" translate="no">patch(conn, path_or_action, params_or_body \\ nil)</a>

      </div>

        <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#path_params/2" data-no-tooltip="" translate="no">path_params(conn, to)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the matched params of the URL for the <code class="inline">%Plug.Conn{}</code>'s router.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#post/3" data-no-tooltip="" translate="no">post(conn, path_or_action, params_or_body \\ nil)</a>

      </div>

        <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put/3" data-no-tooltip="" translate="no">put(conn, path_or_action, params_or_body \\ nil)</a>

      </div>

        <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_flash/3" data-no-tooltip="" translate="no">put_flash(conn, key, value)</a>

      </div>

        <div class="summary-synopsis"><p>Puts the given value under key in the flash storage.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_req_cookie/3" data-no-tooltip="" translate="no">put_req_cookie(conn, key, value)</a>

      </div>

        <div class="summary-synopsis"><p>Puts a request cookie.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#recycle/2" data-no-tooltip="" translate="no">recycle(conn, headers \\ ~w(accept accept-language authorization))</a>

      </div>

        <div class="summary-synopsis"><p>Recycles the connection.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#redirected_params/2" data-no-tooltip="" translate="no">redirected_params(conn, status \\ 302)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the matched params from the URL the connection was redirected to.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#redirected_to/2" data-no-tooltip="" translate="no">redirected_to(conn, status \\ 302)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the location header from the given redirect response.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#response/2" data-no-tooltip="" translate="no">response(conn, given)</a>

      </div>

        <div class="summary-synopsis"><p>Asserts the given status code and returns the response body
if one was set or sent.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#response_content_type/2" data-no-tooltip="" translate="no">response_content_type(conn, format)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the content type as long as it matches the given format.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#text_response/2" data-no-tooltip="" translate="no">text_response(conn, status)</a>

      </div>

        <div class="summary-synopsis"><p>Asserts the given status code, that we have a text response and
returns the response body if one was set or sent.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#trace/3" data-no-tooltip="" translate="no">trace(conn, path_or_action, params_or_body \\ nil)</a>

      </div>

        <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>

    </div>

</div>

      </section>


      <section id="functions" class="details-list">
        <h1 class="section-heading">Functions</h1>
        <div class="functions-list">
<section class="detail" id="assert_error_sent/2">

  <div class="detail-header">
    <a href="#assert_error_sent/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">assert_error_sent(status_int_or_atom, func)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L677" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> assert_error_sent(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">function</a>()) :: {<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">list</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()}</pre>

      </div>

<p>Asserts an error was wrapped and sent with the given status.</p><p>Useful for testing actions that you expect raise an error and have
the response wrapped in an HTTP status, with content usually rendered
by your MyAppWeb.ErrorHTML view.</p><p>The function accepts a status either as an integer HTTP status or
atom, such as <code class="inline">500</code> or <code class="inline">:internal_server_error</code>. The list of allowed atoms is available
in <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.Status.html"><code class="inline">Plug.Conn.Status</code></a>. If an error is raised, a 3-tuple of the wrapped
response is returned matching the status, headers, and body of the response:</p><pre><code class="makeup elixir" translate="no"><samp class="p" data-group-id="8747979943-1">{</samp><samp class="mi">500</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="8747979943-2">[</samp><samp class="p" data-group-id="8747979943-3">{</samp><samp class="s">&quot;content-type&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;text/html&quot;</samp><samp class="p" data-group-id="8747979943-3">}</samp><samp class="w"> </samp><samp class="o">|</samp><samp class="w"> </samp><samp class="bp">_</samp><samp class="p" data-group-id="8747979943-2">]</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;Internal Server Error&quot;</samp><samp class="p" data-group-id="8747979943-1">}</samp></code></pre><h2 id="assert_error_sent/2-examples" class="section-heading">
  <a href="#assert_error_sent/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="n">assert_error_sent</samp><samp class="w"> </samp><samp class="ss">:internal_server_error</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="k" data-group-id="9031552849-1">fn</samp><samp class="w"> </samp><samp class="o">-&gt;</samp><samp class="w">
  </samp><samp class="n">get</samp><samp class="p" data-group-id="9031552849-2">(</samp><samp class="n">build_conn</samp><samp class="p" data-group-id="9031552849-3">(</samp><samp class="p" data-group-id="9031552849-3">)</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;/broken/route&quot;</samp><samp class="p" data-group-id="9031552849-2">)</samp><samp class="w">
</samp><samp class="k" data-group-id="9031552849-1">end</samp><samp class="w">

</samp><samp class="n">response</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">assert_error_sent</samp><samp class="w"> </samp><samp class="mi">500</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="k" data-group-id="9031552849-4">fn</samp><samp class="w"> </samp><samp class="o">-&gt;</samp><samp class="w">
  </samp><samp class="n">get</samp><samp class="p" data-group-id="9031552849-5">(</samp><samp class="n">build_conn</samp><samp class="p" data-group-id="9031552849-6">(</samp><samp class="p" data-group-id="9031552849-6">)</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;/broken/route&quot;</samp><samp class="p" data-group-id="9031552849-5">)</samp><samp class="w">
</samp><samp class="k" data-group-id="9031552849-4">end</samp><samp class="w">
</samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="p" data-group-id="9031552849-7">{</samp><samp class="mi">500</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="9031552849-8">[</samp><samp class="c">_h</samp><samp class="w"> </samp><samp class="o">|</samp><samp class="w"> </samp><samp class="c">_t</samp><samp class="p" data-group-id="9031552849-8">]</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;Internal Server Error&quot;</samp><samp class="p" data-group-id="9031552849-7">}</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">response</samp></code></pre><p>This can also be used to test a route resulted in an error that was translated to a
specific response by the <code class="inline">Plug.Status</code> protocol, such as <a href="https://hexdocs.pm/ecto/3.10.1/Ecto.NoResultsError.html"><code class="inline">Ecto.NoResultsError</code></a>:</p><pre><code class="makeup elixir" translate="no"><samp class="n">assert_error_sent</samp><samp class="w"> </samp><samp class="ss">:not_found</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="k" data-group-id="0797184607-1">fn</samp><samp class="w"> </samp><samp class="o">-&gt;</samp><samp class="w">
  </samp><samp class="n">get</samp><samp class="p" data-group-id="0797184607-2">(</samp><samp class="n">build_conn</samp><samp class="p" data-group-id="0797184607-3">(</samp><samp class="p" data-group-id="0797184607-3">)</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;/something-that-raises-no-results-error&quot;</samp><samp class="p" data-group-id="0797184607-2">)</samp><samp class="w">
</samp><samp class="k" data-group-id="0797184607-1">end</samp></code></pre><p><em>Note</em>: for routes that don't raise an error, but instead return a status, you should test the
response directly:</p><pre><code class="makeup elixir" translate="no"><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">get</samp><samp class="p" data-group-id="4196987612-1">(</samp><samp class="n">build_conn</samp><samp class="p" data-group-id="4196987612-2">(</samp><samp class="p" data-group-id="4196987612-2">)</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;/users/not-found&quot;</samp><samp class="p" data-group-id="4196987612-1">)</samp><samp class="w">
</samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">response</samp><samp class="p" data-group-id="4196987612-3">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="mi">404</samp><samp class="p" data-group-id="4196987612-3">)</samp></code></pre>
  </section>
</section>
<section class="detail" id="build_conn/0">

  <div class="detail-header">
    <a href="#build_conn/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">build_conn()</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L139" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> build_conn() :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Creates a connection to be used in upcoming requests.</p>
  </section>
</section>
<section class="detail" id="build_conn/3">

    <span id="build_conn/2"></span>

  <div class="detail-header">
    <a href="#build_conn/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">build_conn(method, path, params_or_body \\ nil)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L151" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> build_conn(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">list</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>() | nil) ::
  <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Creates a connection to be used in upcoming requests
with a preset method, path and body.</p><p>This is useful when a specific connection is required
for testing a plug or a particular function.</p>
  </section>
</section>
<section class="detail" id="bypass_through/1">

  <div class="detail-header">
    <a href="#bypass_through/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">bypass_through(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L552" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> bypass_through(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Calls the Endpoint and Router pipelines.</p><p>Useful for unit testing Plugs where Endpoint and/or router pipeline
plugs are required for proper setup.</p><p>Note the use of <code class="inline">get(&quot;/&quot;)</code> following <code class="inline">bypass_through</code> in the examples below.
To execute the plug pipelines, you must issue a request against the router.
Most often, you can simply send a GET request against the root path, but you
may also specify a different method or path which your pipelines may operate
against.</p><h2 id="bypass_through/1-examples" class="section-heading">
  <a href="#bypass_through/1-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<p>For example, imagine you are testing an authentication plug in
isolation, but you need to invoke the Endpoint plugs and router
pipelines to set up session and flash related dependencies.
One option is to invoke an existing route that uses the proper
pipelines. You can do so by passing the connection and the
router name to <code class="inline">bypass_through</code>:</p><pre><code class="makeup elixir" translate="no"><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w">
  </samp><samp class="n">conn</samp><samp class="w">
  </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">bypass_through</samp><samp class="p" data-group-id="5649531637-1">(</samp><samp class="nc">MyAppWeb.Router</samp><samp class="p" data-group-id="5649531637-1">)</samp><samp class="w">
  </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">get</samp><samp class="p" data-group-id="5649531637-2">(</samp><samp class="s">&quot;/some_url&quot;</samp><samp class="p" data-group-id="5649531637-2">)</samp><samp class="w">
  </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="nc">MyApp.RequireAuthentication</samp><samp class="o">.</samp><samp class="n">call</samp><samp class="p" data-group-id="5649531637-3">(</samp><samp class="p" data-group-id="5649531637-4">[</samp><samp class="p" data-group-id="5649531637-4">]</samp><samp class="p" data-group-id="5649531637-3">)</samp><samp class="w">
</samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">conn</samp><samp class="o">.</samp><samp class="n">halted</samp></code></pre><p>You can also specify which pipelines you want to run:</p><pre><code class="makeup elixir" translate="no"><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w">
  </samp><samp class="n">conn</samp><samp class="w">
  </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">bypass_through</samp><samp class="p" data-group-id="3836868258-1">(</samp><samp class="nc">MyAppWeb.Router</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="3836868258-2">[</samp><samp class="ss">:browser</samp><samp class="p" data-group-id="3836868258-2">]</samp><samp class="p" data-group-id="3836868258-1">)</samp><samp class="w">
  </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">get</samp><samp class="p" data-group-id="3836868258-3">(</samp><samp class="s">&quot;/&quot;</samp><samp class="p" data-group-id="3836868258-3">)</samp><samp class="w">
  </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="nc">MyApp.RequireAuthentication</samp><samp class="o">.</samp><samp class="n">call</samp><samp class="p" data-group-id="3836868258-4">(</samp><samp class="p" data-group-id="3836868258-5">[</samp><samp class="p" data-group-id="3836868258-5">]</samp><samp class="p" data-group-id="3836868258-4">)</samp><samp class="w">
</samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">conn</samp><samp class="o">.</samp><samp class="n">halted</samp></code></pre><p>Alternatively, you could only invoke the Endpoint's plugs:</p><pre><code class="makeup elixir" translate="no"><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w">
  </samp><samp class="n">conn</samp><samp class="w">
  </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">bypass_through</samp><samp class="p" data-group-id="0505661020-1">(</samp><samp class="p" data-group-id="0505661020-1">)</samp><samp class="w">
  </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">get</samp><samp class="p" data-group-id="0505661020-2">(</samp><samp class="s">&quot;/&quot;</samp><samp class="p" data-group-id="0505661020-2">)</samp><samp class="w">
  </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="nc">MyApp.RequireAuthentication</samp><samp class="o">.</samp><samp class="n">call</samp><samp class="p" data-group-id="0505661020-3">(</samp><samp class="p" data-group-id="0505661020-4">[</samp><samp class="p" data-group-id="0505661020-4">]</samp><samp class="p" data-group-id="0505661020-3">)</samp><samp class="w">

</samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">conn</samp><samp class="o">.</samp><samp class="n">halted</samp></code></pre>
  </section>
</section>
<section class="detail" id="bypass_through/2">

  <div class="detail-header">
    <a href="#bypass_through/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">bypass_through(conn, router)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L562" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> bypass_through(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">module</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Calls the Endpoint and Router pipelines for the current route.</p><p>See <a href="#bypass_through/1"><code class="inline">bypass_through/1</code></a>.</p>
  </section>
</section>
<section class="detail" id="bypass_through/3">

  <div class="detail-header">
    <a href="#bypass_through/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">bypass_through(conn, router, pipelines)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L572" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> bypass_through(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">module</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">list</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Calls the Endpoint and the given Router pipelines.</p><p>See <a href="#bypass_through/1"><code class="inline">bypass_through/1</code></a>.</p>
  </section>
</section>
<section class="detail" id="clear_flash/1">

  <div class="detail-header">
    <a href="#clear_flash/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">clear_flash(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L299" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> clear_flash(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Clears up the flash storage.</p>
  </section>
</section>
<section class="detail" id="connect/3">

    <span id="connect/2"></span>

  <div class="detail-header">
    <a href="#connect/3" class="detail-link" data-no-tooltip="" aria-label="Link to this macro">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">connect(conn, path_or_action, params_or_body \\ nil)</h1>

        <span class="note">(macro)</span>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L165" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Dispatches to the current endpoint.</p><p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="delete/3">

    <span id="delete/2"></span>

  <div class="detail-header">
    <a href="#delete/3" class="detail-link" data-no-tooltip="" aria-label="Link to this macro">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">delete(conn, path_or_action, params_or_body \\ nil)</h1>

        <span class="note">(macro)</span>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L165" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Dispatches to the current endpoint.</p><p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="delete_req_cookie/2">

  <div class="detail-header">
    <a href="#delete_req_cookie/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">delete_req_cookie(conn, key)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L265" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> delete_req_cookie(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Deletes a request cookie.</p>
  </section>
</section>
<section class="detail" id="dispatch/5">

    <span id="dispatch/4"></span>

  <div class="detail-header">
    <a href="#dispatch/5" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">dispatch(conn, endpoint, method, path_or_action, params_or_body \\ nil)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L212" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Dispatches the connection to the given endpoint.</p><p>When invoked via <a href="#get/3"><code class="inline">get/3</code></a>, <a href="#post/3"><code class="inline">post/3</code></a> and friends, the endpoint
is automatically retrieved from the <code class="inline">@endpoint</code> module
attribute, otherwise it must be given as an argument.</p><p>The connection will be configured with the given <code class="inline">method</code>,
<code class="inline">path_or_action</code> and <code class="inline">params_or_body</code>.</p><p>If <code class="inline">path_or_action</code> is a string, it is considered to be the
request path and stored as so in the connection. If an atom,
it is assumed to be an action and the connection is dispatched
to the given action.</p><h2 id="dispatch/5-parameters-and-body" class="section-heading">
  <a href="#dispatch/5-parameters-and-body" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Parameters and body</span>
</h2>
<p>This function, as well as <a href="#get/3"><code class="inline">get/3</code></a>, <a href="#post/3"><code class="inline">post/3</code></a> and friends, accepts the
request body or parameters as last argument:</p><pre><code class="makeup elixir" translate="no"><samp class="w">  </samp><samp class="n">get</samp><samp class="p" data-group-id="2754721584-1">(</samp><samp class="n">build_conn</samp><samp class="p" data-group-id="2754721584-2">(</samp><samp class="p" data-group-id="2754721584-2">)</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;/&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">some</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;param&quot;</samp><samp class="p" data-group-id="2754721584-1">)</samp><samp class="w">
  </samp><samp class="n">get</samp><samp class="p" data-group-id="2754721584-3">(</samp><samp class="n">build_conn</samp><samp class="p" data-group-id="2754721584-4">(</samp><samp class="p" data-group-id="2754721584-4">)</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;/&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;some=param&amp;url=encoded&quot;</samp><samp class="p" data-group-id="2754721584-3">)</samp></code></pre><p>The allowed values are:</p><ul><li><p><code class="inline">nil</code> - meaning there is no body</p></li><li><p>a binary - containing a request body. For such cases, <code class="inline">:headers</code>
must be given as option with a content-type</p></li><li><p>a map or list - containing the parameters which will automatically
set the content-type to multipart. The map or list may contain
other lists or maps and all entries will be normalized to string
keys</p></li><li><p>a struct - unlike other maps, a struct will be passed through as-is
without normalizing its entries</p></li></ul>
  </section>
</section>
<section class="detail" id="ensure_recycled/1">

  <div class="detail-header">
    <a href="#ensure_recycled/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">ensure_recycled(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L496" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> ensure_recycled(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Ensures the connection is recycled if it wasn't already.</p><p>See <a href="#recycle/1"><code class="inline">recycle/1</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="fetch_flash/1">

  <div class="detail-header">
    <a href="#fetch_flash/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">fetch_flash(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L271" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> fetch_flash(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Fetches the flash storage.</p>
  </section>
</section>
<section class="detail" id="get/3">

    <span id="get/2"></span>

  <div class="detail-header">
    <a href="#get/3" class="detail-link" data-no-tooltip="" aria-label="Link to this macro">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">get(conn, path_or_action, params_or_body \\ nil)</h1>

        <span class="note">(macro)</span>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L165" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Dispatches to the current endpoint.</p><p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="get_flash/1">

  <div class="detail-header">
    <a href="#get_flash/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">get_flash(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L278" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

    <div class="deprecated">
      This function is deprecated. get_flash/1 is deprecated. Use conn.assigns.flash instead.
    </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> get_flash(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()</pre>

      </div>

<p>Gets the whole flash storage.</p>
  </section>
</section>
<section class="detail" id="get_flash/2">

  <div class="detail-header">
    <a href="#get_flash/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">get_flash(conn, key)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L285" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

    <div class="deprecated">
      This function is deprecated. get_flash/2 is deprecated. Use Phoenix.Flash.get/2 instead.
    </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> get_flash(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()</pre>

      </div>

<p>Gets the given key from the flash storage.</p>
  </section>
</section>
<section class="detail" id="head/3">

    <span id="head/2"></span>

  <div class="detail-header">
    <a href="#head/3" class="detail-link" data-no-tooltip="" aria-label="Link to this macro">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">head(conn, path_or_action, params_or_body \\ nil)</h1>

        <span class="note">(macro)</span>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L165" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Dispatches to the current endpoint.</p><p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="html_response/2">

  <div class="detail-header">
    <a href="#html_response/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">html_response(conn, status)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L386" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> html_response(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), status :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()</pre>

      </div>

<p>Asserts the given status code, that we have an html response and
returns the response body if one was set or sent.</p><h2 id="html_response/2-examples" class="section-heading">
  <a href="#html_response/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">html_response</samp><samp class="p" data-group-id="5467880494-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="mi">200</samp><samp class="p" data-group-id="5467880494-1">)</samp><samp class="w"> </samp><samp class="o">=~</samp><samp class="w"> </samp><samp class="s">&quot;&lt;html&gt;&quot;</samp></code></pre>
  </section>
</section>
<section class="detail" id="init_test_session/2">

  <div class="detail-header">
    <a href="#init_test_session/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">init_test_session(conn, session)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L253" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> init_test_session(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">keyword</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Inits a session used exclusively for testing.</p>
  </section>
</section>
<section class="detail" id="json_response/2">

  <div class="detail-header">
    <a href="#json_response/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">json_response(conn, status)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L418" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> json_response(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), status :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()</pre>

      </div>

<p>Asserts the given status code, that we have a json response and
returns the decoded JSON response if one was set or sent.</p><h2 id="json_response/2-examples" class="section-heading">
  <a href="#json_response/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="n">body</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">json_response</samp><samp class="p" data-group-id="8722487114-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="mi">200</samp><samp class="p" data-group-id="8722487114-1">)</samp><samp class="w">
</samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="s">&quot;can&#39;t be blank&quot;</samp><samp class="w"> </samp><samp class="ow">in</samp><samp class="w"> </samp><samp class="n">body</samp><samp class="p" data-group-id="8722487114-2">[</samp><samp class="s">&quot;errors&quot;</samp><samp class="p" data-group-id="8722487114-2">]</samp></code></pre>
  </section>
</section>
<section class="detail" id="options/3">

    <span id="options/2"></span>

  <div class="detail-header">
    <a href="#options/3" class="detail-link" data-no-tooltip="" aria-label="Link to this macro">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">options(conn, path_or_action, params_or_body \\ nil)</h1>

        <span class="note">(macro)</span>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L165" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Dispatches to the current endpoint.</p><p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="patch/3">

    <span id="patch/2"></span>

  <div class="detail-header">
    <a href="#patch/3" class="detail-link" data-no-tooltip="" aria-label="Link to this macro">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">patch(conn, path_or_action, params_or_body \\ nil)</h1>

        <span class="note">(macro)</span>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L165" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Dispatches to the current endpoint.</p><p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="path_params/2">

  <div class="detail-header">
    <a href="#path_params/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">path_params(conn, to)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L626" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> path_params(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()</pre>

      </div>

<p>Returns the matched params of the URL for the <code class="inline">%Plug.Conn{}</code>'s router.</p><p>Useful for extracting path params out of returned URLs, such as those
returned by <code class="inline">Phoenix.LiveViewTest</code>'s redirected results.</p><h2 id="path_params/2-examples" class="section-heading">
  <a href="#path_params/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="n">assert</samp><samp class="w"> </samp><samp class="p" data-group-id="2018836198-1">{</samp><samp class="ss">:error</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="2018836198-2">{</samp><samp class="ss">:redirect</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="2018836198-3">%{</samp><samp class="ss">to</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;/posts/123&quot;</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">to</samp><samp class="p" data-group-id="2018836198-3">}</samp><samp class="p" data-group-id="2018836198-2">}</samp><samp class="p" data-group-id="2018836198-1">}</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">live</samp><samp class="p" data-group-id="2018836198-4">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;/path&quot;</samp><samp class="p" data-group-id="2018836198-4">)</samp><samp class="w">
</samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="p" data-group-id="2018836198-5">%{</samp><samp class="ss">id</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;123&quot;</samp><samp class="p" data-group-id="2018836198-5">}</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">path_params</samp><samp class="p" data-group-id="2018836198-6">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">to</samp><samp class="p" data-group-id="2018836198-6">)</samp></code></pre>
  </section>
</section>
<section class="detail" id="post/3">

    <span id="post/2"></span>

  <div class="detail-header">
    <a href="#post/3" class="detail-link" data-no-tooltip="" aria-label="Link to this macro">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">post(conn, path_or_action, params_or_body \\ nil)</h1>

        <span class="note">(macro)</span>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L165" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Dispatches to the current endpoint.</p><p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="put/3">

    <span id="put/2"></span>

  <div class="detail-header">
    <a href="#put/3" class="detail-link" data-no-tooltip="" aria-label="Link to this macro">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">put(conn, path_or_action, params_or_body \\ nil)</h1>

        <span class="note">(macro)</span>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L165" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Dispatches to the current endpoint.</p><p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="put_flash/3">

  <div class="detail-header">
    <a href="#put_flash/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">put_flash(conn, key, value)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L293" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> put_flash(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Puts the given value under key in the flash storage.</p>
  </section>
</section>
<section class="detail" id="put_req_cookie/3">

  <div class="detail-header">
    <a href="#put_req_cookie/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">put_req_cookie(conn, key, value)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L259" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> put_req_cookie(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Puts a request cookie.</p>
  </section>
</section>
<section class="detail" id="recycle/2">

    <span id="recycle/1"></span>

  <div class="detail-header">
    <a href="#recycle/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">recycle(conn, headers \\ ~w(accept accept-language authorization))</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L476" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> recycle(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), [<a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()]) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Recycles the connection.</p><p>Recycling receives a connection and returns a new connection,
containing cookies and relevant information from the given one.</p><p>This emulates behaviour performed by browsers where cookies
returned in the response are available in following requests.</p><p>By default, only the headers &quot;accept&quot;, &quot;accept-language&quot;, and
&quot;authorization&quot; are recycled. However, a custom set of headers
can be specified by passing a list of strings representing its
names as the second argument of the function.</p><p>Note <a href="#recycle/1"><code class="inline">recycle/1</code></a> is automatically invoked when dispatching
to the endpoint, unless the connection has already been
recycled.</p>
  </section>
</section>
<section class="detail" id="redirected_params/2">

    <span id="redirected_params/1"></span>

  <div class="detail-header">
    <a href="#redirected_params/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">redirected_params(conn, status \\ 302)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L590" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> redirected_params(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), status :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">non_neg_integer</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()</pre>

      </div>

<p>Returns the matched params from the URL the connection was redirected to.</p><p>Uses the provided <code class="inline">%Plug.Conn{}</code>s router matched in the previous request.
Raises if the response's location header is not set or if the response does
not match the redirect status code (defaults to 302).</p><h2 id="redirected_params/2-examples" class="section-heading">
  <a href="#redirected_params/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">redirected_to</samp><samp class="p" data-group-id="8192398028-1">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="8192398028-1">)</samp><samp class="w"> </samp><samp class="o">=~</samp><samp class="w"> </samp><samp class="s">&quot;/posts/123&quot;</samp><samp class="w">
</samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="p" data-group-id="8192398028-2">%{</samp><samp class="ss">id</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;123&quot;</samp><samp class="p" data-group-id="8192398028-2">}</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">redirected_params</samp><samp class="p" data-group-id="8192398028-3">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="8192398028-3">)</samp><samp class="w">
</samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="p" data-group-id="8192398028-4">%{</samp><samp class="ss">id</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;123&quot;</samp><samp class="p" data-group-id="8192398028-4">}</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">redirected_params</samp><samp class="p" data-group-id="8192398028-5">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="mi">303</samp><samp class="p" data-group-id="8192398028-5">)</samp></code></pre>
  </section>
</section>
<section class="detail" id="redirected_to/2">

    <span id="redirected_to/1"></span>

  <div class="detail-header">
    <a href="#redirected_to/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">redirected_to(conn, status \\ 302)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L438" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> redirected_to(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), status :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">non_neg_integer</a>()) :: <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()</pre>

      </div>

<p>Returns the location header from the given redirect response.</p><p>Raises if the response does not match the redirect status code
(defaults to 302).</p><h2 id="redirected_to/2-examples" class="section-heading">
  <a href="#redirected_to/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">redirected_to</samp><samp class="p" data-group-id="6791038045-1">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="6791038045-1">)</samp><samp class="w"> </samp><samp class="o">=~</samp><samp class="w"> </samp><samp class="s">&quot;/foo/bar&quot;</samp><samp class="w">
</samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">redirected_to</samp><samp class="p" data-group-id="6791038045-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="mi">301</samp><samp class="p" data-group-id="6791038045-2">)</samp><samp class="w"> </samp><samp class="o">=~</samp><samp class="w"> </samp><samp class="s">&quot;/foo/bar&quot;</samp><samp class="w">
</samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">redirected_to</samp><samp class="p" data-group-id="6791038045-3">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:moved_permanently</samp><samp class="p" data-group-id="6791038045-3">)</samp><samp class="w"> </samp><samp class="o">=~</samp><samp class="w"> </samp><samp class="s">&quot;/foo/bar&quot;</samp></code></pre>
  </section>
</section>
<section class="detail" id="response/2">

  <div class="detail-header">
    <a href="#response/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">response(conn, given)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L357" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> response(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), status :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>()</pre>

      </div>

<p>Asserts the given status code and returns the response body
if one was set or sent.</p><h2 id="response/2-examples" class="section-heading">
  <a href="#response/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">get</samp><samp class="p" data-group-id="0371823559-1">(</samp><samp class="n">build_conn</samp><samp class="p" data-group-id="0371823559-2">(</samp><samp class="p" data-group-id="0371823559-2">)</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;/&quot;</samp><samp class="p" data-group-id="0371823559-1">)</samp><samp class="w">
</samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">response</samp><samp class="p" data-group-id="0371823559-3">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="mi">200</samp><samp class="p" data-group-id="0371823559-3">)</samp><samp class="w"> </samp><samp class="o">=~</samp><samp class="w"> </samp><samp class="s">&quot;hello world&quot;</samp></code></pre>
  </section>
</section>
<section class="detail" id="response_content_type/2">

  <div class="detail-header">
    <a href="#response_content_type/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">response_content_type(conn, format)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L311" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> response_content_type(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()</pre>

      </div>

<p>Returns the content type as long as it matches the given format.</p><h2 id="response_content_type/2-examples" class="section-heading">
  <a href="#response_content_type/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="c1"># Assert we have an html response with utf-8 charset</samp><samp class="w">
</samp><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">response_content_type</samp><samp class="p" data-group-id="3876025463-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:html</samp><samp class="p" data-group-id="3876025463-1">)</samp><samp class="w"> </samp><samp class="o">=~</samp><samp class="w"> </samp><samp class="s">&quot;charset=utf-8&quot;</samp></code></pre>
  </section>
</section>
<section class="detail" id="text_response/2">

  <div class="detail-header">
    <a href="#text_response/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">text_response(conn, status)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L401" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> text_response(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), status :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()</pre>

      </div>

<p>Asserts the given status code, that we have a text response and
returns the response body if one was set or sent.</p><h2 id="text_response/2-examples" class="section-heading">
  <a href="#text_response/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="n">assert</samp><samp class="w"> </samp><samp class="n">text_response</samp><samp class="p" data-group-id="8693728627-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="mi">200</samp><samp class="p" data-group-id="8693728627-1">)</samp><samp class="w"> </samp><samp class="o">=~</samp><samp class="w"> </samp><samp class="s">&quot;hello&quot;</samp></code></pre>
  </section>
</section>
<section class="detail" id="trace/3">

    <span id="trace/2"></span>

  <div class="detail-header">
    <a href="#trace/3" class="detail-link" data-no-tooltip="" aria-label="Link to this macro">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">trace(conn, path_or_action, params_or_body \\ nil)</h1>

        <span class="note">(macro)</span>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/test/conn_test.ex#L165" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Dispatches to the current endpoint.</p><p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>

        </div>
      </section>


  </body>
</html>
