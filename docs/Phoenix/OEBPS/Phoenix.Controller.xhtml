<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <title>Phoenix.Controller - Phoenix v1.7.21</title>
    <meta name="generator" content="ExDoc v0.37.3" />
    <link type="text/css" rel="stylesheet" href="dist/epub-elixir-FNUUKFP7.css" />
    <script src="dist/epub-4WIP524F.js"></script>

  </head>
  <body class="content-inner">

    <h1 id="content">
Phoenix.Controller 
    </h1>


      <section id="moduledoc" class="docstring">
<p>Controllers are used to group common functionality in the same
(pluggable) module.</p><p>For example, the route:</p><pre><code class="makeup elixir" translate="no"><samp class="n">get</samp><samp class="w"> </samp><samp class="s">&quot;/users/:id&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.UserController</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:show</samp></code></pre><p>will invoke the <code class="inline">show/2</code> action in the <code class="inline">MyAppWeb.UserController</code>:</p><pre><code class="makeup elixir" translate="no"><samp class="kd">defmodule</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.UserController</samp><samp class="w"> </samp><samp class="k" data-group-id="0167575361-1">do</samp><samp class="w">
  </samp><samp class="kn">use</samp><samp class="w"> </samp><samp class="nc">MyAppWeb</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:controller</samp><samp class="w">

  </samp><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">show</samp><samp class="p" data-group-id="0167575361-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="0167575361-3">%{</samp><samp class="s">&quot;id&quot;</samp><samp class="w"> </samp><samp class="p">=&gt;</samp><samp class="w"> </samp><samp class="n">id</samp><samp class="p" data-group-id="0167575361-3">}</samp><samp class="p" data-group-id="0167575361-2">)</samp><samp class="w"> </samp><samp class="k" data-group-id="0167575361-4">do</samp><samp class="w">
    </samp><samp class="n">user</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="nc">Repo</samp><samp class="o">.</samp><samp class="n">get</samp><samp class="p" data-group-id="0167575361-5">(</samp><samp class="nc">User</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">id</samp><samp class="p" data-group-id="0167575361-5">)</samp><samp class="w">
    </samp><samp class="n">render</samp><samp class="p" data-group-id="0167575361-6">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:show</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">user</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="n">user</samp><samp class="p" data-group-id="0167575361-6">)</samp><samp class="w">
  </samp><samp class="k" data-group-id="0167575361-4">end</samp><samp class="w">
</samp><samp class="k" data-group-id="0167575361-1">end</samp></code></pre><p>An action is a regular function that receives the connection
and the request parameters as arguments. The connection is a
<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html"><code class="inline">Plug.Conn</code></a> struct, as specified by the Plug library.</p><p>Then we invoke <a href="#render/3"><code class="inline">render/3</code></a>, passing the connection, the template
to render (typically named after the action), and the <code class="inline">user: user</code>
as assigns. We will explore all of those concepts next.</p><h2 id="module-connection" class="section-heading">
  <a href="#module-connection" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Connection</span>
</h2>
<p>A controller by default provides many convenience functions for
manipulating the connection, rendering templates, and more.</p><p>Those functions are imported from two modules:</p><ul><li><p><a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html"><code class="inline">Plug.Conn</code></a> - a collection of low-level functions to work with
the connection</p></li><li><p><a href="Phoenix.Controller.xhtml"><code class="inline">Phoenix.Controller</code></a> - functions provided by Phoenix
to support rendering, and other Phoenix specific behaviour</p></li></ul><p>If you want to have functions that manipulate the connection
without fully implementing the controller, you can import both
modules directly instead of <code class="inline">use Phoenix.Controller</code>.</p><h2 id="module-rendering-and-layouts" class="section-heading">
  <a href="#module-rendering-and-layouts" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Rendering and layouts</span>
</h2>
<p>One of the main features provided by controllers is the ability
to perform content negotiation and render templates based on
information sent by the client.</p><p>There are two ways to render content in a controller. One option
is to invoke format-specific functions, such as <a href="#html/2"><code class="inline">html/2</code></a> and <a href="#json/2"><code class="inline">json/2</code></a>.</p><p>However, most commonly controllers invoke custom modules called
views. Views are modules capable of rendering a custom format.
This is done by specifying the option <code class="inline">:formats</code> when defining
the controller:</p><pre><code class="makeup elixir" translate="no"><samp class="kn">use</samp><samp class="w"> </samp><samp class="nc">Phoenix.Controller</samp><samp class="p">,</samp><samp class="w">
  </samp><samp class="ss">formats</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="p" data-group-id="3292336386-1">[</samp><samp class="ss">:html</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:json</samp><samp class="p" data-group-id="3292336386-1">]</samp></code></pre><p> Now, when invoking <a href="#render/3"><code class="inline">render/3</code></a>, a controller named <code class="inline">MyAppWeb.UserController</code>
 will invoke <code class="inline">MyAppWeb.UserHTML</code> and <code class="inline">MyAppWeb.UserJSON</code> respectively
 when rendering each format:</p><pre><code class="makeup elixir" translate="no"><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">show</samp><samp class="p" data-group-id="4868360569-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="4868360569-2">%{</samp><samp class="s">&quot;id&quot;</samp><samp class="w"> </samp><samp class="p">=&gt;</samp><samp class="w"> </samp><samp class="n">id</samp><samp class="p" data-group-id="4868360569-2">}</samp><samp class="p" data-group-id="4868360569-1">)</samp><samp class="w"> </samp><samp class="k" data-group-id="4868360569-3">do</samp><samp class="w">
  </samp><samp class="n">user</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="nc">Repo</samp><samp class="o">.</samp><samp class="n">get</samp><samp class="p" data-group-id="4868360569-4">(</samp><samp class="nc">User</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">id</samp><samp class="p" data-group-id="4868360569-4">)</samp><samp class="w">
  </samp><samp class="c1"># Will invoke UserHTML.show(%{user: user}) for html requests</samp><samp class="w">
  </samp><samp class="c1"># Will invoke UserJSON.show(%{user: user}) for json requests</samp><samp class="w">
  </samp><samp class="n">render</samp><samp class="p" data-group-id="4868360569-5">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:show</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">user</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="n">user</samp><samp class="p" data-group-id="4868360569-5">)</samp><samp class="w">
</samp><samp class="k" data-group-id="4868360569-3">end</samp></code></pre><p>Some formats are also handy to have layouts, which render content
shared across all pages. We can also specify layouts on <code class="inline">use</code>:</p><pre><code class="makeup elixir" translate="no"><samp class="kn">use</samp><samp class="w"> </samp><samp class="nc">Phoenix.Controller</samp><samp class="p">,</samp><samp class="w">
  </samp><samp class="ss">formats</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="p" data-group-id="2051604030-1">[</samp><samp class="ss">:html</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:json</samp><samp class="p" data-group-id="2051604030-1">]</samp><samp class="p">,</samp><samp class="w">
  </samp><samp class="ss">layouts</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="p" data-group-id="2051604030-2">[</samp><samp class="ss">html</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.Layouts</samp><samp class="p" data-group-id="2051604030-2">]</samp></code></pre><p>You can also specify formats and layouts to render by calling
<a href="#put_view/2"><code class="inline">put_view/2</code></a> and <a href="#put_layout/2"><code class="inline">put_layout/2</code></a> directly with a connection.
The line above can also be written directly in your actions as:</p><pre><code class="makeup elixir" translate="no"><samp class="n">conn</samp><samp class="w">
</samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">put_view</samp><samp class="p" data-group-id="5564018703-1">(</samp><samp class="ss">html</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.UserHTML</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">json</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.UserJSON</samp><samp class="p" data-group-id="5564018703-1">)</samp><samp class="w">
</samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">put_layout</samp><samp class="p" data-group-id="5564018703-2">(</samp><samp class="ss">html</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.Layouts</samp><samp class="p" data-group-id="5564018703-2">)</samp></code></pre><h3 id="module-backwards-compatibility" class="section-heading">
  <a href="#module-backwards-compatibility" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Backwards compatibility</span>
</h3>
<p>In previous Phoenix versions, a controller you always render
<code class="inline">MyApp.UserView</code>. This behaviour can be explicitly retained by
passing a suffix to the formats options:</p><pre><code class="makeup elixir" translate="no"><samp class="kn">use</samp><samp class="w"> </samp><samp class="nc">Phoenix.Controller</samp><samp class="p">,</samp><samp class="w">
  </samp><samp class="ss">formats</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="p" data-group-id="5388850126-1">[</samp><samp class="ss">html</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;View&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">json</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;View&quot;</samp><samp class="p" data-group-id="5388850126-1">]</samp><samp class="p">,</samp><samp class="w">
  </samp><samp class="ss">layouts</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="p" data-group-id="5388850126-2">[</samp><samp class="ss">html</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.Layouts</samp><samp class="p" data-group-id="5388850126-2">]</samp></code></pre><h3 id="module-options" class="section-heading">
  <a href="#module-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h3>
<p>When used, the controller supports the following options to customize
template rendering:</p><ul><li><p><code class="inline">:formats</code> - the formats this controller will render
by default. For example, specifying <code class="inline">formats: [:html, :json]</code>
for a controller named <code class="inline">MyAppWeb.UserController</code> will
invoke <code class="inline">MyAppWeb.UserHTML</code> and <code class="inline">MyAppWeb.UserJSON</code> when
respectively rendering each format. If <code class="inline">:formats</code> is not
set, the default view is set to <code class="inline">MyAppWeb.UserView</code></p></li><li><p><code class="inline">:layouts</code> - which layouts to render for each format,
for example: <code class="inline">[html: DemoWeb.Layouts]</code></p></li></ul><p>Deprecated options:</p><ul><li><p><code class="inline">:namespace</code> - sets the namespace for the layout. Use
<code class="inline">:layouts</code> instead</p></li><li><p><code class="inline">:put_default_views</code> - controls whether the default view
and layout should be set or not. Set <code class="inline">formats: []</code> and
<code class="inline">layouts: []</code> instead</p></li></ul><h2 id="module-plug-pipeline" class="section-heading">
  <a href="#module-plug-pipeline" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Plug pipeline</span>
</h2>
<p>As with routers, controllers also have their own plug pipeline.
However, different from routers, controllers have a single pipeline:</p><pre><code class="makeup elixir" translate="no"><samp class="kd">defmodule</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.UserController</samp><samp class="w"> </samp><samp class="k" data-group-id="1769828694-1">do</samp><samp class="w">
  </samp><samp class="kn">use</samp><samp class="w"> </samp><samp class="nc">MyAppWeb</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:controller</samp><samp class="w">

  </samp><samp class="n">plug</samp><samp class="w"> </samp><samp class="ss">:authenticate</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">usernames</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="p" data-group-id="1769828694-2">[</samp><samp class="s">&quot;jose&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;eric&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;sonny&quot;</samp><samp class="p" data-group-id="1769828694-2">]</samp><samp class="w">

  </samp><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">show</samp><samp class="p" data-group-id="1769828694-3">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">params</samp><samp class="p" data-group-id="1769828694-3">)</samp><samp class="w"> </samp><samp class="k" data-group-id="1769828694-4">do</samp><samp class="w">
    </samp><samp class="c1"># authenticated users only</samp><samp class="w">
  </samp><samp class="k" data-group-id="1769828694-4">end</samp><samp class="w">

  </samp><samp class="kd">defp</samp><samp class="w"> </samp><samp class="nf">authenticate</samp><samp class="p" data-group-id="1769828694-5">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">options</samp><samp class="p" data-group-id="1769828694-5">)</samp><samp class="w"> </samp><samp class="k" data-group-id="1769828694-6">do</samp><samp class="w">
    </samp><samp class="k">if</samp><samp class="w"> </samp><samp class="n">get_session</samp><samp class="p" data-group-id="1769828694-7">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:username</samp><samp class="p" data-group-id="1769828694-7">)</samp><samp class="w"> </samp><samp class="ow">in</samp><samp class="w"> </samp><samp class="n">options</samp><samp class="p" data-group-id="1769828694-8">[</samp><samp class="ss">:usernames</samp><samp class="p" data-group-id="1769828694-8">]</samp><samp class="w"> </samp><samp class="k" data-group-id="1769828694-9">do</samp><samp class="w">
      </samp><samp class="n">conn</samp><samp class="w">
    </samp><samp class="k" data-group-id="1769828694-9">else</samp><samp class="w">
      </samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">redirect</samp><samp class="p" data-group-id="1769828694-10">(</samp><samp class="ss">to</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;/&quot;</samp><samp class="p" data-group-id="1769828694-10">)</samp><samp class="w"> </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">halt</samp><samp class="p" data-group-id="1769828694-11">(</samp><samp class="p" data-group-id="1769828694-11">)</samp><samp class="w">
    </samp><samp class="k" data-group-id="1769828694-9">end</samp><samp class="w">
  </samp><samp class="k" data-group-id="1769828694-6">end</samp><samp class="w">
</samp><samp class="k" data-group-id="1769828694-1">end</samp></code></pre><p>The <code class="inline">:authenticate</code> plug will be invoked before the action. If the
plug calls <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#halt/1"><code class="inline">Plug.Conn.halt/1</code></a> (which is by default imported into
controllers), it will halt the pipeline and won't invoke the action.</p><h3 id="module-guards" class="section-heading">
  <a href="#module-guards" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Guards</span>
</h3>
<p><code class="inline">plug/2</code> in controllers supports guards, allowing a developer to configure
a plug to only run in some particular action.</p><pre><code class="makeup elixir" translate="no"><samp class="n">plug</samp><samp class="w"> </samp><samp class="ss">:do_something</samp><samp class="w"> </samp><samp class="ow">when</samp><samp class="w"> </samp><samp class="n">action</samp><samp class="w"> </samp><samp class="ow">in</samp><samp class="w"> </samp><samp class="p" data-group-id="9967722858-1">[</samp><samp class="ss">:show</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:edit</samp><samp class="p" data-group-id="9967722858-1">]</samp></code></pre><p>Due to operator precedence in Elixir, if the second argument is a keyword list,
we need to wrap the keyword in <code class="inline">[...]</code> when using <code class="inline">when</code>:</p><pre><code class="makeup elixir" translate="no"><samp class="n">plug</samp><samp class="w"> </samp><samp class="ss">:authenticate</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="7348933292-1">[</samp><samp class="ss">usernames</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="p" data-group-id="7348933292-2">[</samp><samp class="s">&quot;jose&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;eric&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;sonny&quot;</samp><samp class="p" data-group-id="7348933292-2">]</samp><samp class="p" data-group-id="7348933292-1">]</samp><samp class="w"> </samp><samp class="ow">when</samp><samp class="w"> </samp><samp class="n">action</samp><samp class="w"> </samp><samp class="ow">in</samp><samp class="w"> </samp><samp class="p" data-group-id="7348933292-3">[</samp><samp class="ss">:show</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:edit</samp><samp class="p" data-group-id="7348933292-3">]</samp><samp class="w">
</samp><samp class="n">plug</samp><samp class="w"> </samp><samp class="ss">:authenticate</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="7348933292-4">[</samp><samp class="ss">usernames</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="p" data-group-id="7348933292-5">[</samp><samp class="s">&quot;admin&quot;</samp><samp class="p" data-group-id="7348933292-5">]</samp><samp class="p" data-group-id="7348933292-4">]</samp><samp class="w"> </samp><samp class="ow">when</samp><samp class="w"> </samp><samp class="ow">not</samp><samp class="w"> </samp><samp class="n">action</samp><samp class="w"> </samp><samp class="ow">in</samp><samp class="w"> </samp><samp class="p" data-group-id="7348933292-6">[</samp><samp class="ss">:index</samp><samp class="p" data-group-id="7348933292-6">]</samp></code></pre><p>The first plug will run only when action is show or edit. The second plug will
always run, except for the index action.</p><p>Those guards work like regular Elixir guards and the only variables accessible
in the guard are <code class="inline">conn</code>, the <code class="inline">action</code> as an atom and the <code class="inline">controller</code> as an
alias.</p><h2 id="module-controllers-are-plugs" class="section-heading">
  <a href="#module-controllers-are-plugs" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Controllers are plugs</span>
</h2>
<p>Like routers, controllers are plugs, but they are wired to dispatch
to a particular function which is called an action.</p><p>For example, the route:</p><pre><code class="makeup elixir" translate="no"><samp class="n">get</samp><samp class="w"> </samp><samp class="s">&quot;/users/:id&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="nc">UserController</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:show</samp></code></pre><p>will invoke <code class="inline">UserController</code> as a plug:</p><pre><code class="makeup elixir" translate="no"><samp class="nc">UserController</samp><samp class="o">.</samp><samp class="n">call</samp><samp class="p" data-group-id="0398069786-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:show</samp><samp class="p" data-group-id="0398069786-1">)</samp></code></pre><p>which will trigger the plug pipeline and which will eventually
invoke the inner action plug that dispatches to the <code class="inline">show/2</code>
function in <code class="inline">UserController</code>.</p><p>As controllers are plugs, they implement both <a href="https://hexdocs.pm/plug/1.15.3/Plug.html#c:init/1"><code class="inline">init/1</code></a> and
<a href="https://hexdocs.pm/plug/1.15.3/Plug.html#c:call/2"><code class="inline">call/2</code></a>, and it also provides a function named <code class="inline">action/2</code>
which is responsible for dispatching the appropriate action
after the plug stack (and is also overridable).</p><h3 id="module-overriding-action-2-for-custom-arguments" class="section-heading">
  <a href="#module-overriding-action-2-for-custom-arguments" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Overriding <code class="inline">action/2</code> for custom arguments</span>
</h3>
<p>Phoenix injects an <code class="inline">action/2</code> plug in your controller which calls the
function matched from the router. By default, it passes the conn and params.
In some cases, overriding the <code class="inline">action/2</code> plug in your controller is a
useful way to inject arguments into your actions that you would otherwise
need to repeatedly fetch off the connection. For example, imagine if you
stored a <code class="inline">conn.assigns.current_user</code> in the connection and wanted quick
access to the user for every action in your controller:</p><pre><code class="makeup elixir" translate="no"><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">action</samp><samp class="p" data-group-id="7846664339-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="bp">_</samp><samp class="p" data-group-id="7846664339-1">)</samp><samp class="w"> </samp><samp class="k" data-group-id="7846664339-2">do</samp><samp class="w">
  </samp><samp class="n">args</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="p" data-group-id="7846664339-3">[</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">conn</samp><samp class="o">.</samp><samp class="n">params</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">conn</samp><samp class="o">.</samp><samp class="n">assigns</samp><samp class="o">.</samp><samp class="n">current_user</samp><samp class="p" data-group-id="7846664339-3">]</samp><samp class="w">
  </samp><samp class="n">apply</samp><samp class="p" data-group-id="7846664339-4">(</samp><samp class="bp">__MODULE__</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">action_name</samp><samp class="p" data-group-id="7846664339-5">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="7846664339-5">)</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">args</samp><samp class="p" data-group-id="7846664339-4">)</samp><samp class="w">
</samp><samp class="k" data-group-id="7846664339-2">end</samp><samp class="w">

</samp><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">index</samp><samp class="p" data-group-id="7846664339-6">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="c">_params</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">user</samp><samp class="p" data-group-id="7846664339-6">)</samp><samp class="w"> </samp><samp class="k" data-group-id="7846664339-7">do</samp><samp class="w">
  </samp><samp class="n">videos</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="nc">Repo</samp><samp class="o">.</samp><samp class="n">all</samp><samp class="p" data-group-id="7846664339-8">(</samp><samp class="n">user_videos</samp><samp class="p" data-group-id="7846664339-9">(</samp><samp class="n">user</samp><samp class="p" data-group-id="7846664339-9">)</samp><samp class="p" data-group-id="7846664339-8">)</samp><samp class="w">
  </samp><samp class="c1"># ...</samp><samp class="w">
</samp><samp class="k" data-group-id="7846664339-7">end</samp><samp class="w">

</samp><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">delete</samp><samp class="p" data-group-id="7846664339-10">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="7846664339-11">%{</samp><samp class="s">&quot;id&quot;</samp><samp class="w"> </samp><samp class="p">=&gt;</samp><samp class="w"> </samp><samp class="n">id</samp><samp class="p" data-group-id="7846664339-11">}</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">user</samp><samp class="p" data-group-id="7846664339-10">)</samp><samp class="w"> </samp><samp class="k" data-group-id="7846664339-12">do</samp><samp class="w">
  </samp><samp class="n">video</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="nc">Repo</samp><samp class="o">.</samp><samp class="n">get!</samp><samp class="p" data-group-id="7846664339-13">(</samp><samp class="n">user_videos</samp><samp class="p" data-group-id="7846664339-14">(</samp><samp class="n">user</samp><samp class="p" data-group-id="7846664339-14">)</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">id</samp><samp class="p" data-group-id="7846664339-13">)</samp><samp class="w">
  </samp><samp class="c1"># ...</samp><samp class="w">
</samp><samp class="k" data-group-id="7846664339-12">end</samp></code></pre>
      </section>


      <section id="summary" class="details-list">
        <h1 class="section-heading">Summary</h1>
<div class="summary-types summary">
  <h2>
    <a href="#types">Types</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:layout/0" data-no-tooltip="" translate="no">layout()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:view/0" data-no-tooltip="" translate="no">view()</a>

      </div>

    </div>

</div>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#accepts/2" data-no-tooltip="" translate="no">accepts(conn, accepted)</a>

      </div>

        <div class="summary-synopsis"><p>Performs content negotiation based on the available formats.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#action_fallback/1" data-no-tooltip="" translate="no">action_fallback(plug)</a>

      </div>

        <div class="summary-synopsis"><p>Registers the plug to call as a fallback to the controller action.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#action_name/1" data-no-tooltip="" translate="no">action_name(conn)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the action name as an atom, raises if unavailable.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#allow_jsonp/2" data-no-tooltip="" translate="no">allow_jsonp(conn, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>A plug that may convert a JSON response into a JSONP one.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#clear_flash/1" data-no-tooltip="" translate="no">clear_flash(conn)</a>

      </div>

        <div class="summary-synopsis"><p>Clears all flash messages.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#controller_module/1" data-no-tooltip="" translate="no">controller_module(conn)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the controller module as an atom, raises if unavailable.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#current_path/1" data-no-tooltip="" translate="no">current_path(conn)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the current request path with its default query parameters</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#current_path/2" data-no-tooltip="" translate="no">current_path(conn, params)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the current path with the given query parameters.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#current_url/1" data-no-tooltip="" translate="no">current_url(conn)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the current request url with its default query parameters</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#current_url/2" data-no-tooltip="" translate="no">current_url(conn, params)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the current request URL with query params.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#delete_csrf_token/0" data-no-tooltip="" translate="no">delete_csrf_token()</a>

      </div>

        <div class="summary-synopsis"><p>Deletes the CSRF token from the process dictionary.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#endpoint_module/1" data-no-tooltip="" translate="no">endpoint_module(conn)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the endpoint module as an atom, raises if unavailable.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#fetch_flash/2" data-no-tooltip="" translate="no">fetch_flash(conn, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Fetches the flash storage.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_csrf_token/0" data-no-tooltip="" translate="no">get_csrf_token()</a>

      </div>

        <div class="summary-synopsis"><p>Gets or generates a CSRF token.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_flash/1" data-no-tooltip="" translate="no">get_flash(conn)</a>

          <span class="deprecated" title="get_flash/1 is deprecated. Use the @flash assign provided by the :fetch_flash plug">deprecated</span>

      </div>

        <div class="summary-synopsis"><p>Returns a map of previously set flash messages or an empty map.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_flash/2" data-no-tooltip="" translate="no">get_flash(conn, key)</a>

          <span class="deprecated" title="get_flash/2 is deprecated. Use Phoenix.Flash.get(@flash, key) instead">deprecated</span>

      </div>

        <div class="summary-synopsis"><p>Returns a message from flash by <code class="inline">key</code> (or <code class="inline">nil</code> if no message is available for <code class="inline">key</code>).</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_format/1" data-no-tooltip="" translate="no">get_format(conn)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the request format, such as &quot;json&quot;, &quot;html&quot;.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#html/2" data-no-tooltip="" translate="no">html(conn, data)</a>

      </div>

        <div class="summary-synopsis"><p>Sends html response.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#json/2" data-no-tooltip="" translate="no">json(conn, data)</a>

      </div>

        <div class="summary-synopsis"><p>Sends JSON response.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#layout/2" data-no-tooltip="" translate="no">layout(conn, format \\ nil)</a>

      </div>

        <div class="summary-synopsis"><p>Retrieves the current layout for the given format.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#layout_formats/1" data-no-tooltip="" translate="no">layout_formats(conn)</a>

          <span class="deprecated" title="layout_formats/1 is deprecated, pass a keyword list to put_layout/put_root_layout instead">deprecated</span>

      </div>

        <div class="summary-synopsis"><p>Retrieves current layout formats.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#merge_flash/2" data-no-tooltip="" translate="no">merge_flash(conn, enumerable)</a>

      </div>

        <div class="summary-synopsis"><p>Merges a map into the flash.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#protect_from_forgery/2" data-no-tooltip="" translate="no">protect_from_forgery(conn, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Enables CSRF protection.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_flash/3" data-no-tooltip="" translate="no">put_flash(conn, key, message)</a>

      </div>

        <div class="summary-synopsis"><p>Persists a value in flash.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_format/2" data-no-tooltip="" translate="no">put_format(conn, format)</a>

      </div>

        <div class="summary-synopsis"><p>Puts the format in the connection.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_layout/2" data-no-tooltip="" translate="no">put_layout(conn, layout)</a>

      </div>

        <div class="summary-synopsis"><p>Stores the layout for rendering.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_layout_formats/2" data-no-tooltip="" translate="no">put_layout_formats(conn, formats)</a>

          <span class="deprecated" title="put_layout_formats/2 is deprecated, pass a keyword list to put_layout/put_root_layout instead">deprecated</span>

      </div>

        <div class="summary-synopsis"><p>Sets which formats have a layout when rendering.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_new_layout/2" data-no-tooltip="" translate="no">put_new_layout(conn, layout)</a>

      </div>

        <div class="summary-synopsis"><p>Stores the layout for rendering if one was not stored yet.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_new_view/2" data-no-tooltip="" translate="no">put_new_view(conn, formats)</a>

      </div>

        <div class="summary-synopsis"><p>Stores the view for rendering if one was not stored yet.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_root_layout/2" data-no-tooltip="" translate="no">put_root_layout(conn, layout)</a>

      </div>

        <div class="summary-synopsis"><p>Stores the root layout for rendering.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_router_url/2" data-no-tooltip="" translate="no">put_router_url(conn, uri)</a>

      </div>

        <div class="summary-synopsis"><p>Puts the url string or <code class="inline">%URI{}</code> to be used for route generation.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_secure_browser_headers/2" data-no-tooltip="" translate="no">put_secure_browser_headers(conn, headers \\ %{})</a>

      </div>

        <div class="summary-synopsis"><p>Put headers that improve browser security.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_static_url/2" data-no-tooltip="" translate="no">put_static_url(conn, uri)</a>

      </div>

        <div class="summary-synopsis"><p>Puts the URL or <code class="inline">%URI{}</code> to be used for the static url generation.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_view/2" data-no-tooltip="" translate="no">put_view(conn, formats)</a>

      </div>

        <div class="summary-synopsis"><p>Stores the view for rendering.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#redirect/2" data-no-tooltip="" translate="no">redirect(conn, opts)</a>

      </div>

        <div class="summary-synopsis"><p>Sends redirect response to the given url.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#render/2" data-no-tooltip="" translate="no">render(conn, template_or_assigns \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Render the given template or the default template
specified by the current action with the given assigns.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#render/3" data-no-tooltip="" translate="no">render(conn, template, assigns)</a>

      </div>

        <div class="summary-synopsis"><p>Renders the given <code class="inline">template</code> and <code class="inline">assigns</code> based on the <code class="inline">conn</code> information.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#root_layout/2" data-no-tooltip="" translate="no">root_layout(conn, format \\ nil)</a>

      </div>

        <div class="summary-synopsis"><p>Retrieves the current root layout for the given format.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#router_module/1" data-no-tooltip="" translate="no">router_module(conn)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the router module as an atom, raises if unavailable.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#scrub_params/2" data-no-tooltip="" translate="no">scrub_params(conn, required_key)</a>

      </div>

        <div class="summary-synopsis"><p>Scrubs the parameters from the request.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#send_download/3" data-no-tooltip="" translate="no">send_download(conn, kind, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Sends the given file or binary as a download.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#status_message_from_template/1" data-no-tooltip="" translate="no">status_message_from_template(template)</a>

      </div>

        <div class="summary-synopsis"><p>Generates a status message from the template name.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#text/2" data-no-tooltip="" translate="no">text(conn, data)</a>

      </div>

        <div class="summary-synopsis"><p>Sends text response.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#view_module/2" data-no-tooltip="" translate="no">view_module(conn, format \\ nil)</a>

      </div>

        <div class="summary-synopsis"><p>Retrieves the current view for the given format.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#view_template/1" data-no-tooltip="" translate="no">view_template(conn)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the template name rendered in the view as a string
(or nil if no template was rendered).</p></div>

    </div>

</div>

      </section>


      <section id="types" class="details-list">
        <h1 class="section-heading">Types</h1>
        <div class="types-list">
<section class="detail" id="t:layout/0">

  <div class="detail-header">
    <a href="#t:layout/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">layout()</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L16" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> layout() :: {<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">module</a>(), layout_name :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()} | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>() | false</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:view/0">

  <div class="detail-header">
    <a href="#t:view/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">view()</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L15" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> view() :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()</pre>

      </div>


  </section>
</section>

        </div>
      </section>

      <section id="functions" class="details-list">
        <h1 class="section-heading">Functions</h1>
        <div class="functions-list">
<section class="detail" id="accepts/2">

  <div class="detail-header">
    <a href="#accepts/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">accepts(conn, accepted)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1507" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> accepts(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), [<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>()]) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Performs content negotiation based on the available formats.</p><p>It receives a connection, a list of formats that the server
is capable of rendering and then proceeds to perform content
negotiation based on the request information. If the client
accepts any of the given formats, the request proceeds.</p><p>If the request contains a &quot;_format&quot; parameter, it is
considered to be the format desired by the client. If no
&quot;_format&quot; parameter is available, this function will parse
the &quot;accept&quot; header and find a matching format accordingly.</p><p>This function is useful when you may want to serve different
content-types (such as JSON and HTML) from the same routes.
However, if you always have distinct routes, you can also
disable content negotiation and simply hardcode your format
of choice in your route pipelines:</p><pre><code class="makeup elixir" translate="no"><samp class="n">plug</samp><samp class="w"> </samp><samp class="ss">:put_format</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;html&quot;</samp></code></pre><p>It is important to notice that browsers have historically
sent bad accept headers. For this reason, this function will
default to &quot;html&quot; format whenever:</p><ul><li><p>the accepted list of arguments contains the &quot;html&quot; format</p></li><li><p>the accept header specified more than one media type preceded
or followed by the wildcard media type &quot;<code class="inline">*/*</code>&quot;</p></li></ul><p>This function raises <a href="Phoenix.NotAcceptableError.xhtml"><code class="inline">Phoenix.NotAcceptableError</code></a>, which is rendered
with status 406, whenever the server cannot serve a response in any
of the formats expected by the client.</p><h2 id="accepts/2-examples" class="section-heading">
  <a href="#accepts/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<p><a href="#accepts/2"><code class="inline">accepts/2</code></a> can be invoked as a function:</p><pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">accepts</samp><samp class="p" data-group-id="9959914182-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="9959914182-2">[</samp><samp class="s">&quot;html&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;json&quot;</samp><samp class="p" data-group-id="9959914182-2">]</samp><samp class="p" data-group-id="9959914182-1">)</samp></code></pre><p>or used as a plug:</p><pre><code class="makeup elixir" translate="no"><samp class="n">plug</samp><samp class="w"> </samp><samp class="ss">:accepts</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="5606127346-1">[</samp><samp class="s">&quot;html&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;json&quot;</samp><samp class="p" data-group-id="5606127346-1">]</samp><samp class="w">
</samp><samp class="n">plug</samp><samp class="w"> </samp><samp class="ss">:accepts</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="sx">~w(html json)</samp></code></pre><h2 id="accepts/2-custom-media-types" class="section-heading">
  <a href="#accepts/2-custom-media-types" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Custom media types</span>
</h2>
<p>It is possible to add custom media types to your Phoenix application.
The first step is to teach Plug about those new media types in
your <code class="inline">config/config.exs</code> file:</p><pre><code class="makeup elixir" translate="no"><samp class="n">config</samp><samp class="w"> </samp><samp class="ss">:mime</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:types</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="4852963725-1">%{</samp><samp class="w">
  </samp><samp class="s">&quot;application/vnd.api+json&quot;</samp><samp class="w"> </samp><samp class="p">=&gt;</samp><samp class="w"> </samp><samp class="p" data-group-id="4852963725-2">[</samp><samp class="s">&quot;json-api&quot;</samp><samp class="p" data-group-id="4852963725-2">]</samp><samp class="w">
</samp><samp class="p" data-group-id="4852963725-1">}</samp></code></pre><p>The key is the media type, the value is a list of formats the
media type can be identified with. For example, by using
&quot;json-api&quot;, you will be able to use templates with extension
&quot;index.json-api&quot; or to force a particular format in a given
URL by sending &quot;?_format=json-api&quot;.</p><p>After this change, you must recompile plug:</p><pre><code class="makeup shell" translate="no"><samp class="gp unselectable">$ </samp><samp class="">mix deps.clean mime --build
</samp><samp class="gp unselectable">$ </samp><samp class="">mix deps.get
</samp></code></pre><p>And now you can use it in accepts too:</p><pre><code class="makeup elixir" translate="no"><samp class="n">plug</samp><samp class="w"> </samp><samp class="ss">:accepts</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="0373943378-1">[</samp><samp class="s">&quot;html&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;json-api&quot;</samp><samp class="p" data-group-id="0373943378-1">]</samp></code></pre>
  </section>
</section>
<section class="detail" id="action_fallback/1">

  <div class="detail-header">
    <a href="#action_fallback/1" class="detail-link" data-no-tooltip="" aria-label="Link to this macro">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">action_fallback(plug)</h1>

        <span class="note">(macro)</span>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L314" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Registers the plug to call as a fallback to the controller action.</p><p>A fallback plug is useful to translate common domain data structures
into a valid <code class="inline">%Plug.Conn{}</code> response. If the controller action fails to
return a <code class="inline">%Plug.Conn{}</code>, the provided plug will be called and receive
the controller's <code class="inline">%Plug.Conn{}</code> as it was before the action was invoked
along with the value returned from the controller action.</p><h2 id="action_fallback/1-examples" class="section-heading">
  <a href="#action_fallback/1-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="kd">defmodule</samp><samp class="w"> </samp><samp class="nc">MyController</samp><samp class="w"> </samp><samp class="k" data-group-id="0819410484-1">do</samp><samp class="w">
  </samp><samp class="kn">use</samp><samp class="w"> </samp><samp class="nc">Phoenix.Controller</samp><samp class="w">

  </samp><samp class="n">action_fallback</samp><samp class="w"> </samp><samp class="nc">MyFallbackController</samp><samp class="w">

  </samp><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">show</samp><samp class="p" data-group-id="0819410484-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="0819410484-3">%{</samp><samp class="s">&quot;id&quot;</samp><samp class="w"> </samp><samp class="p">=&gt;</samp><samp class="w"> </samp><samp class="n">id</samp><samp class="p" data-group-id="0819410484-3">}</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">current_user</samp><samp class="p" data-group-id="0819410484-2">)</samp><samp class="w"> </samp><samp class="k" data-group-id="0819410484-4">do</samp><samp class="w">
    </samp><samp class="k">with</samp><samp class="w"> </samp><samp class="p" data-group-id="0819410484-5">{</samp><samp class="ss">:ok</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">post</samp><samp class="p" data-group-id="0819410484-5">}</samp><samp class="w"> </samp><samp class="o">&lt;-</samp><samp class="w"> </samp><samp class="nc">Blog</samp><samp class="o">.</samp><samp class="n">fetch_post</samp><samp class="p" data-group-id="0819410484-6">(</samp><samp class="n">id</samp><samp class="p" data-group-id="0819410484-6">)</samp><samp class="p">,</samp><samp class="w">
         </samp><samp class="ss">:ok</samp><samp class="w"> </samp><samp class="o">&lt;-</samp><samp class="w"> </samp><samp class="nc">Authorizer</samp><samp class="o">.</samp><samp class="n">authorize</samp><samp class="p" data-group-id="0819410484-7">(</samp><samp class="n">current_user</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:view</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">post</samp><samp class="p" data-group-id="0819410484-7">)</samp><samp class="w"> </samp><samp class="k" data-group-id="0819410484-8">do</samp><samp class="w">

      </samp><samp class="n">render</samp><samp class="p" data-group-id="0819410484-9">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;show.json&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">post</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="n">post</samp><samp class="p" data-group-id="0819410484-9">)</samp><samp class="w">
    </samp><samp class="k" data-group-id="0819410484-8">end</samp><samp class="w">
  </samp><samp class="k" data-group-id="0819410484-4">end</samp><samp class="w">
</samp><samp class="k" data-group-id="0819410484-1">end</samp></code></pre><p>In the above example, <code class="inline">with</code> is used to match only a successful
post fetch, followed by valid authorization for the current user.
In the event either of those fail to match, <code class="inline">with</code> will not invoke
the render block and instead return the unmatched value. In this case,
imagine <code class="inline">Blog.fetch_post/2</code> returned <code class="inline">{:error, :not_found}</code> or
<code class="inline">Authorizer.authorize/3</code> returned <code class="inline">{:error, :unauthorized}</code>. For cases
where these data structures serve as return values across multiple
boundaries in our domain, a single fallback module can be used to
translate the value into a valid response. For example, you could
write the following fallback controller to handle the above values:</p><pre><code class="makeup elixir" translate="no"><samp class="kd">defmodule</samp><samp class="w"> </samp><samp class="nc">MyFallbackController</samp><samp class="w"> </samp><samp class="k" data-group-id="1668138805-1">do</samp><samp class="w">
  </samp><samp class="kn">use</samp><samp class="w"> </samp><samp class="nc">Phoenix.Controller</samp><samp class="w">

  </samp><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">call</samp><samp class="p" data-group-id="1668138805-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="1668138805-3">{</samp><samp class="ss">:error</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:not_found</samp><samp class="p" data-group-id="1668138805-3">}</samp><samp class="p" data-group-id="1668138805-2">)</samp><samp class="w"> </samp><samp class="k" data-group-id="1668138805-4">do</samp><samp class="w">
    </samp><samp class="n">conn</samp><samp class="w">
    </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">put_status</samp><samp class="p" data-group-id="1668138805-5">(</samp><samp class="ss">:not_found</samp><samp class="p" data-group-id="1668138805-5">)</samp><samp class="w">
    </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">put_view</samp><samp class="p" data-group-id="1668138805-6">(</samp><samp class="nc">MyErrorView</samp><samp class="p" data-group-id="1668138805-6">)</samp><samp class="w">
    </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">render</samp><samp class="p" data-group-id="1668138805-7">(</samp><samp class="ss">:&quot;404&quot;</samp><samp class="p" data-group-id="1668138805-7">)</samp><samp class="w">
  </samp><samp class="k" data-group-id="1668138805-4">end</samp><samp class="w">

  </samp><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">call</samp><samp class="p" data-group-id="1668138805-8">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="1668138805-9">{</samp><samp class="ss">:error</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:unauthorized</samp><samp class="p" data-group-id="1668138805-9">}</samp><samp class="p" data-group-id="1668138805-8">)</samp><samp class="w"> </samp><samp class="k" data-group-id="1668138805-10">do</samp><samp class="w">
    </samp><samp class="n">conn</samp><samp class="w">
    </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">put_status</samp><samp class="p" data-group-id="1668138805-11">(</samp><samp class="ss">:forbidden</samp><samp class="p" data-group-id="1668138805-11">)</samp><samp class="w">
    </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">put_view</samp><samp class="p" data-group-id="1668138805-12">(</samp><samp class="nc">MyErrorView</samp><samp class="p" data-group-id="1668138805-12">)</samp><samp class="w">
    </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">render</samp><samp class="p" data-group-id="1668138805-13">(</samp><samp class="ss">:&quot;403&quot;</samp><samp class="p" data-group-id="1668138805-13">)</samp><samp class="w">
  </samp><samp class="k" data-group-id="1668138805-10">end</samp><samp class="w">
</samp><samp class="k" data-group-id="1668138805-1">end</samp></code></pre>
  </section>
</section>
<section class="detail" id="action_name/1">

  <div class="detail-header">
    <a href="#action_name/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">action_name(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L322" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> action_name(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()</pre>

      </div>

<p>Returns the action name as an atom, raises if unavailable.</p>
  </section>
</section>
<section class="detail" id="allow_jsonp/2">

    <span id="allow_jsonp/1"></span>

  <div class="detail-header">
    <a href="#allow_jsonp/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">allow_jsonp(conn, opts \\ [])</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L392" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> allow_jsonp(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>A plug that may convert a JSON response into a JSONP one.</p><p>In case a JSON response is returned, it will be converted
to a JSONP as long as the callback field is present in
the query string. The callback field itself defaults to
&quot;callback&quot;, but may be configured with the callback option.</p><p>In case there is no callback or the response is not encoded
in JSON format, it is a no-op.</p><p>Only alphanumeric characters and underscore are allowed in the
callback name. Otherwise an exception is raised.</p><h2 id="allow_jsonp/2-examples" class="section-heading">
  <a href="#allow_jsonp/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="c1"># Will convert JSON to JSONP if callback=someFunction is given</samp><samp class="w">
</samp><samp class="n">plug</samp><samp class="w"> </samp><samp class="ss">:allow_jsonp</samp><samp class="w">

</samp><samp class="c1"># Will convert JSON to JSONP if cb=someFunction is given</samp><samp class="w">
</samp><samp class="n">plug</samp><samp class="w"> </samp><samp class="ss">:allow_jsonp</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">callback</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;cb&quot;</samp></code></pre>
  </section>
</section>
<section class="detail" id="clear_flash/1">

  <div class="detail-header">
    <a href="#clear_flash/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">clear_flash(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1749" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Clears all flash messages.</p>
  </section>
</section>
<section class="detail" id="controller_module/1">

  <div class="detail-header">
    <a href="#controller_module/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">controller_module(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L328" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> controller_module(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()</pre>

      </div>

<p>Returns the controller module as an atom, raises if unavailable.</p>
  </section>
</section>
<section class="detail" id="current_path/1">

  <div class="detail-header">
    <a href="#current_path/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">current_path(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1772" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Returns the current request path with its default query parameters:</p><pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">current_path</samp><samp class="p" data-group-id="3983416021-1">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="3983416021-1">)</samp><samp class="w">
</samp><samp class="s">&quot;/users/123?existing=param&quot;</samp></code></pre><p>See <a href="#current_path/2"><code class="inline">current_path/2</code></a> to override the default parameters.</p><p>The path is normalized based on the <code class="inline">conn.script_name</code> and
<code class="inline">conn.path_info</code>. For example, &quot;/foo//bar/&quot; will become &quot;/foo/bar&quot;.
If you want the original path, use <code class="inline">conn.request_path</code> instead.</p>
  </section>
</section>
<section class="detail" id="current_path/2">

  <div class="detail-header">
    <a href="#current_path/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">current_path(conn, params)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1804" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Returns the current path with the given query parameters.</p><p>You may also retrieve only the request path by passing an
empty map of params.</p><h2 id="current_path/2-examples" class="section-heading">
  <a href="#current_path/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">current_path</samp><samp class="p" data-group-id="3458465846-1">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="3458465846-1">)</samp><samp class="w">
</samp><samp class="s">&quot;/users/123?existing=param&quot;</samp><samp class="w">

</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">current_path</samp><samp class="p" data-group-id="3458465846-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="3458465846-3">%{</samp><samp class="ss">new</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;param&quot;</samp><samp class="p" data-group-id="3458465846-3">}</samp><samp class="p" data-group-id="3458465846-2">)</samp><samp class="w">
</samp><samp class="s">&quot;/users/123?new=param&quot;</samp><samp class="w">

</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">current_path</samp><samp class="p" data-group-id="3458465846-4">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="3458465846-5">%{</samp><samp class="ss">filter</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="p" data-group-id="3458465846-6">%{</samp><samp class="ss">status</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="p" data-group-id="3458465846-7">[</samp><samp class="s">&quot;draft&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;published&quot;</samp><samp class="p" data-group-id="3458465846-7">]</samp><samp class="p" data-group-id="3458465846-6">}</samp><samp class="p" data-group-id="3458465846-5">}</samp><samp class="p" data-group-id="3458465846-4">)</samp><samp class="w">
</samp><samp class="s">&quot;/users/123?filter[status][]=draft&amp;filter[status][]=published&quot;</samp><samp class="w">

</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">current_path</samp><samp class="p" data-group-id="3458465846-8">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="3458465846-9">%{</samp><samp class="p" data-group-id="3458465846-9">}</samp><samp class="p" data-group-id="3458465846-8">)</samp><samp class="w">
</samp><samp class="s">&quot;/users/123&quot;</samp></code></pre><p>The path is normalized based on the <code class="inline">conn.script_name</code> and
<code class="inline">conn.path_info</code>. For example, &quot;/foo//bar/&quot; will become &quot;/foo/bar&quot;.
If you want the original path, use <code class="inline">conn.request_path</code> instead.</p>
  </section>
</section>
<section class="detail" id="current_url/1">

  <div class="detail-header">
    <a href="#current_url/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">current_url(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1824" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Returns the current request url with its default query parameters:</p><pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">current_url</samp><samp class="p" data-group-id="5713486305-1">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="5713486305-1">)</samp><samp class="w">
</samp><samp class="s">&quot;https://www.example.com/users/123?existing=param&quot;</samp></code></pre><p>See <a href="#current_url/2"><code class="inline">current_url/2</code></a> to override the default parameters.</p>
  </section>
</section>
<section class="detail" id="current_url/2">

  <div class="detail-header">
    <a href="#current_url/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">current_url(conn, params)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1870" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Returns the current request URL with query params.</p><p>The path will be retrieved from the currently requested path via
<a href="#current_path/1"><code class="inline">current_path/1</code></a>. The scheme, host and others will be received from
the URL configuration in your Phoenix endpoint. The reason we don't
use the host and scheme information in the request is because most
applications are behind proxies and the host and scheme may not
actually reflect the host and scheme accessed by the client. If you
want to access the url precisely as requested by the client, see
<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#request_url/1"><code class="inline">Plug.Conn.request_url/1</code></a>.</p><h2 id="current_url/2-examples" class="section-heading">
  <a href="#current_url/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">current_url</samp><samp class="p" data-group-id="2514522235-1">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="2514522235-1">)</samp><samp class="w">
</samp><samp class="s">&quot;https://www.example.com/users/123?existing=param&quot;</samp><samp class="w">

</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">current_url</samp><samp class="p" data-group-id="2514522235-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="2514522235-3">%{</samp><samp class="ss">new</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;param&quot;</samp><samp class="p" data-group-id="2514522235-3">}</samp><samp class="p" data-group-id="2514522235-2">)</samp><samp class="w">
</samp><samp class="s">&quot;https://www.example.com/users/123?new=param&quot;</samp><samp class="w">

</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">current_url</samp><samp class="p" data-group-id="2514522235-4">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="2514522235-5">%{</samp><samp class="p" data-group-id="2514522235-5">}</samp><samp class="p" data-group-id="2514522235-4">)</samp><samp class="w">
</samp><samp class="s">&quot;https://www.example.com/users/123&quot;</samp></code></pre><h2 id="current_url/2-custom-url-generation" class="section-heading">
  <a href="#current_url/2-custom-url-generation" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Custom URL Generation</span>
</h2>
<p>In some cases, you'll need to generate a request's URL, but using a
different scheme, different host, etc. This can be accomplished in
two ways.</p><p>If you want to do so in a case-by-case basis, you can define a custom
function that gets the endpoint URI configuration and changes it accordingly.
For example, to get the current URL always in HTTPS format:</p><pre><code class="makeup elixir" translate="no"><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">current_secure_url</samp><samp class="p" data-group-id="7589790027-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">params</samp><samp class="w"> </samp><samp class="o">\\</samp><samp class="w"> </samp><samp class="p" data-group-id="7589790027-2">%{</samp><samp class="p" data-group-id="7589790027-2">}</samp><samp class="p" data-group-id="7589790027-1">)</samp><samp class="w"> </samp><samp class="k" data-group-id="7589790027-3">do</samp><samp class="w">
  </samp><samp class="n">current_uri</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.Endpoint</samp><samp class="o">.</samp><samp class="n">struct_url</samp><samp class="p" data-group-id="7589790027-4">(</samp><samp class="p" data-group-id="7589790027-4">)</samp><samp class="w">
  </samp><samp class="n">current_path</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="nc">Phoenix.Controller</samp><samp class="o">.</samp><samp class="n">current_path</samp><samp class="p" data-group-id="7589790027-5">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">params</samp><samp class="p" data-group-id="7589790027-5">)</samp><samp class="w">
  </samp><samp class="nc">Phoenix.VerifiedRoutes</samp><samp class="o">.</samp><samp class="n">unverified_url</samp><samp class="p" data-group-id="7589790027-6">(</samp><samp class="p" data-group-id="7589790027-7">%</samp><samp class="nc" data-group-id="7589790027-7">URI</samp><samp class="p" data-group-id="7589790027-7">{</samp><samp class="n">current_uri</samp><samp class="w"> </samp><samp class="o">|</samp><samp class="w"> </samp><samp class="ss">scheme</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;https&quot;</samp><samp class="p" data-group-id="7589790027-7">}</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">current_path</samp><samp class="p" data-group-id="7589790027-6">)</samp><samp class="w">
</samp><samp class="k" data-group-id="7589790027-3">end</samp></code></pre><p>However, if you want all generated URLs to always have a certain schema,
host, etc, you may use <a href="#put_router_url/2"><code class="inline">put_router_url/2</code></a>.</p>
  </section>
</section>
<section class="detail" id="delete_csrf_token/0">

  <div class="detail-header">
    <a href="#delete_csrf_token/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">delete_csrf_token()</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1433" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Deletes the CSRF token from the process dictionary.</p><p><em>Note</em>: The token is deleted only after a response has been sent.</p>
  </section>
</section>
<section class="detail" id="endpoint_module/1">

  <div class="detail-header">
    <a href="#endpoint_module/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">endpoint_module(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L340" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> endpoint_module(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()</pre>

      </div>

<p>Returns the endpoint module as an atom, raises if unavailable.</p>
  </section>
</section>
<section class="detail" id="fetch_flash/2">

    <span id="fetch_flash/1"></span>

  <div class="detail-header">
    <a href="#fetch_flash/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">fetch_flash(conn, opts \\ [])</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1629" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Fetches the flash storage.</p>
  </section>
</section>
<section class="detail" id="get_csrf_token/0">

  <div class="detail-header">
    <a href="#get_csrf_token/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">get_csrf_token()</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1426" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Gets or generates a CSRF token.</p><p>If a token exists, it is returned, otherwise it is generated and stored
in the process dictionary.</p>
  </section>
</section>
<section class="detail" id="get_flash/1">

  <div class="detail-header">
    <a href="#get_flash/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">get_flash(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1705" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

    <div class="deprecated">
      This function is deprecated. get_flash/1 is deprecated. Use the @flash assign provided by the :fetch_flash plug.
    </div>

  <section class="docstring">

<p>Returns a map of previously set flash messages or an empty map.</p><h2 id="get_flash/1-examples" class="section-heading">
  <a href="#get_flash/1-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">get_flash</samp><samp class="p" data-group-id="0752924381-1">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="0752924381-1">)</samp><samp class="w">
</samp><samp class="p" data-group-id="0752924381-2">%{</samp><samp class="p" data-group-id="0752924381-2">}</samp><samp class="w">

</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">put_flash</samp><samp class="p" data-group-id="0752924381-3">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:info</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;Welcome Back!&quot;</samp><samp class="p" data-group-id="0752924381-3">)</samp><samp class="w">
</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">get_flash</samp><samp class="p" data-group-id="0752924381-4">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="0752924381-4">)</samp><samp class="w">
</samp><samp class="p" data-group-id="0752924381-5">%{</samp><samp class="s">&quot;info&quot;</samp><samp class="w"> </samp><samp class="p">=&gt;</samp><samp class="w"> </samp><samp class="s">&quot;Welcome Back!&quot;</samp><samp class="p" data-group-id="0752924381-5">}</samp></code></pre>
  </section>
</section>
<section class="detail" id="get_flash/2">

  <div class="detail-header">
    <a href="#get_flash/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">get_flash(conn, key)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1721" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

    <div class="deprecated">
      This function is deprecated. get_flash/2 is deprecated. Use Phoenix.Flash.get(@flash, key) instead.
    </div>

  <section class="docstring">

<p>Returns a message from flash by <code class="inline">key</code> (or <code class="inline">nil</code> if no message is available for <code class="inline">key</code>).</p><h2 id="get_flash/2-examples" class="section-heading">
  <a href="#get_flash/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">put_flash</samp><samp class="p" data-group-id="6229814546-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:info</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;Welcome Back!&quot;</samp><samp class="p" data-group-id="6229814546-1">)</samp><samp class="w">
</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">get_flash</samp><samp class="p" data-group-id="6229814546-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:info</samp><samp class="p" data-group-id="6229814546-2">)</samp><samp class="w">
</samp><samp class="s">&quot;Welcome Back!&quot;</samp></code></pre>
  </section>
</section>
<section class="detail" id="get_format/1">

  <div class="detail-header">
    <a href="#get_format/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">get_format(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1166" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Returns the request format, such as &quot;json&quot;, &quot;html&quot;.</p><p>This format is used when rendering a template as an atom.
For example, <code class="inline">render(conn, :foo)</code> will render <code class="inline">&quot;foo.FORMAT&quot;</code>
where the format is the one set here. The default format
is typically set from the negotiation done in <a href="#accepts/2"><code class="inline">accepts/2</code></a>.</p>
  </section>
</section>
<section class="detail" id="html/2">

  <div class="detail-header">
    <a href="#html/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">html(conn, data)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L468" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> html(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">iodata</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Sends html response.</p><h2 id="html/2-examples" class="section-heading">
  <a href="#html/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">html</samp><samp class="p" data-group-id="1017842371-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;&lt;html&gt;&lt;head&gt;...&quot;</samp><samp class="p" data-group-id="1017842371-1">)</samp></code></pre>
  </section>
</section>
<section class="detail" id="json/2">

  <div class="detail-header">
    <a href="#json/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">json(conn, data)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L363" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> json(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Sends JSON response.</p><p>It uses the configured <code class="inline">:json_library</code> under the <code class="inline">:phoenix</code>
application for <code class="inline">:json</code> to pick up the encoder module.</p><h2 id="json/2-examples" class="section-heading">
  <a href="#json/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">json</samp><samp class="p" data-group-id="5655584251-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="5655584251-2">%{</samp><samp class="ss">id</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="mi">123</samp><samp class="p" data-group-id="5655584251-2">}</samp><samp class="p" data-group-id="5655584251-1">)</samp></code></pre>
  </section>
</section>
<section class="detail" id="layout/2">

    <span id="layout/1"></span>

  <div class="detail-header">
    <a href="#layout/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">layout(conn, format \\ nil)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L804" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> layout(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>() | nil) :: {<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()} | false</pre>

      </div>

<p>Retrieves the current layout for the given format.</p><p>If no format is given, takes the current one from the connection.</p>
  </section>
</section>
<section class="detail" id="layout_formats/1">

  <div class="detail-header">
    <a href="#layout_formats/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">layout_formats(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L794" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

    <div class="deprecated">
      This function is deprecated. layout_formats/1 is deprecated, pass a keyword list to put_layout/put_root_layout instead.
    </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> layout_formats(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: [<a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()]</pre>

      </div>

<p>Retrieves current layout formats.</p>
  </section>
</section>
<section class="detail" id="merge_flash/2">

  <div class="detail-header">
    <a href="#merge_flash/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">merge_flash(conn, enumerable)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1666" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Merges a map into the flash.</p><p>Returns the updated connection.</p><h2 id="merge_flash/2-examples" class="section-heading">
  <a href="#merge_flash/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">merge_flash</samp><samp class="p" data-group-id="2532333824-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">info</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;Welcome Back!&quot;</samp><samp class="p" data-group-id="2532333824-1">)</samp><samp class="w">
</samp><samp class="gp unselectable">iex&gt; </samp><samp class="nc">Phoenix.Flash</samp><samp class="o">.</samp><samp class="n">get</samp><samp class="p" data-group-id="2532333824-2">(</samp><samp class="n">conn</samp><samp class="o">.</samp><samp class="n">assigns</samp><samp class="o">.</samp><samp class="n">flash</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:info</samp><samp class="p" data-group-id="2532333824-2">)</samp><samp class="w">
</samp><samp class="s">&quot;Welcome Back!&quot;</samp></code></pre>
  </section>
</section>
<section class="detail" id="protect_from_forgery/2">

    <span id="protect_from_forgery/1"></span>

  <div class="detail-header">
    <a href="#protect_from_forgery/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">protect_from_forgery(conn, opts \\ [])</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1368" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Enables CSRF protection.</p><p>Currently used as a wrapper function for <a href="https://hexdocs.pm/plug/1.15.3/Plug.CSRFProtection.html"><code class="inline">Plug.CSRFProtection</code></a>
and mainly serves as a function plug in <code class="inline">YourApp.Router</code>.</p><p>Check <a href="#get_csrf_token/0"><code class="inline">get_csrf_token/0</code></a> and <a href="#delete_csrf_token/0"><code class="inline">delete_csrf_token/0</code></a> for
retrieving and deleting CSRF tokens.</p>
  </section>
</section>
<section class="detail" id="put_flash/3">

  <div class="detail-header">
    <a href="#put_flash/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">put_flash(conn, key, message)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1683" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Persists a value in flash.</p><p>Returns the updated connection.</p><h2 id="put_flash/3-examples" class="section-heading">
  <a href="#put_flash/3-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">put_flash</samp><samp class="p" data-group-id="8803522442-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:info</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;Welcome Back!&quot;</samp><samp class="p" data-group-id="8803522442-1">)</samp><samp class="w">
</samp><samp class="gp unselectable">iex&gt; </samp><samp class="nc">Phoenix.Flash</samp><samp class="o">.</samp><samp class="n">get</samp><samp class="p" data-group-id="8803522442-2">(</samp><samp class="n">conn</samp><samp class="o">.</samp><samp class="n">assigns</samp><samp class="o">.</samp><samp class="n">flash</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:info</samp><samp class="p" data-group-id="8803522442-2">)</samp><samp class="w">
</samp><samp class="s">&quot;Welcome Back!&quot;</samp></code></pre>
  </section>
</section>
<section class="detail" id="put_format/2">

  <div class="detail-header">
    <a href="#put_format/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">put_format(conn, format)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1156" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Puts the format in the connection.</p><p>This format is used when rendering a template as an atom.
For example, <code class="inline">render(conn, :foo)</code> will render <code class="inline">&quot;foo.FORMAT&quot;</code>
where the format is the one set here. The default format
is typically set from the negotiation done in <a href="#accepts/2"><code class="inline">accepts/2</code></a>.</p><p>See <a href="#get_format/1"><code class="inline">get_format/1</code></a> for retrieval.</p>
  </section>
</section>
<section class="detail" id="put_layout/2">

  <div class="detail-header">
    <a href="#put_layout/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">put_layout(conn, layout)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L641" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> put_layout(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), [{format :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="#t:layout/0">layout</a>()}] | false) ::
  <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Stores the layout for rendering.</p><p>The layout must be given as keyword list where the key is the request
format the layout will be applied to (such as <code class="inline">:html</code>) and the value
is one of:</p><ul><li><p><code class="inline">{module, layout}</code> with the <code class="inline">module</code> the layout is defined and
the name of the <code class="inline">layout</code> as an atom</p></li><li><p><code class="inline">layout</code> when the name of the layout. This requires a layout for
the given format in the shape of <code class="inline">{module, layout}</code> to be previously
given</p></li><li><p><code class="inline">false</code> which disables the layout</p></li></ul><p>If <code class="inline">false</code> is given without a format, all layouts are disabled.</p><h2 id="put_layout/2-examples" class="section-heading">
  <a href="#put_layout/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">layout</samp><samp class="p" data-group-id="8609673267-1">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="8609673267-1">)</samp><samp class="w">
</samp><samp class="no">false</samp><samp class="w">

</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">put_layout</samp><samp class="p" data-group-id="8609673267-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">html</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="p" data-group-id="8609673267-3">{</samp><samp class="nc">AppView</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:application</samp><samp class="p" data-group-id="8609673267-3">}</samp><samp class="p" data-group-id="8609673267-2">)</samp><samp class="w">
</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">layout</samp><samp class="p" data-group-id="8609673267-4">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="8609673267-4">)</samp><samp class="w">
</samp><samp class="p" data-group-id="8609673267-5">{</samp><samp class="nc">AppView</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:application</samp><samp class="p" data-group-id="8609673267-5">}</samp><samp class="w">

</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">put_layout</samp><samp class="p" data-group-id="8609673267-6">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">html</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="ss">:print</samp><samp class="p" data-group-id="8609673267-6">)</samp><samp class="w">
</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">layout</samp><samp class="p" data-group-id="8609673267-7">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="8609673267-7">)</samp><samp class="w">
</samp><samp class="p" data-group-id="8609673267-8">{</samp><samp class="nc">AppView</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:print</samp><samp class="p" data-group-id="8609673267-8">}</samp></code></pre><p>Raises <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.AlreadySentError.html"><code class="inline">Plug.Conn.AlreadySentError</code></a> if <code class="inline">conn</code> is already sent.</p>
  </section>
</section>
<section class="detail" id="put_layout_formats/2">

  <div class="detail-header">
    <a href="#put_layout_formats/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">put_layout_formats(conn, formats)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L782" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

    <div class="deprecated">
      This function is deprecated. put_layout_formats/2 is deprecated, pass a keyword list to put_layout/put_root_layout instead.
    </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> put_layout_formats(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), [<a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()]) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Sets which formats have a layout when rendering.</p><h2 id="put_layout_formats/2-examples" class="section-heading">
  <a href="#put_layout_formats/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">layout_formats</samp><samp class="p" data-group-id="9865965520-1">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="9865965520-1">)</samp><samp class="w">
</samp><samp class="p" data-group-id="9865965520-2">[</samp><samp class="s">&quot;html&quot;</samp><samp class="p" data-group-id="9865965520-2">]</samp><samp class="w">

</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">put_layout_formats</samp><samp class="p" data-group-id="9865965520-3">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="9865965520-4">[</samp><samp class="s">&quot;html&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;mobile&quot;</samp><samp class="p" data-group-id="9865965520-4">]</samp><samp class="p" data-group-id="9865965520-3">)</samp><samp class="w">
</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">layout_formats</samp><samp class="p" data-group-id="9865965520-5">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="9865965520-5">)</samp><samp class="w">
</samp><samp class="p" data-group-id="9865965520-6">[</samp><samp class="s">&quot;html&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;mobile&quot;</samp><samp class="p" data-group-id="9865965520-6">]</samp></code></pre><p>Raises <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.AlreadySentError.html"><code class="inline">Plug.Conn.AlreadySentError</code></a> if <code class="inline">conn</code> is already sent.</p>
  </section>
</section>
<section class="detail" id="put_new_layout/2">

  <div class="detail-header">
    <a href="#put_new_layout/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">put_new_layout(conn, layout)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L719" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> put_new_layout(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), [{format :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="#t:layout/0">layout</a>()}] | <a href="#t:layout/0">layout</a>()) ::
  <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Stores the layout for rendering if one was not stored yet.</p><p>See <a href="#put_layout/2"><code class="inline">put_layout/2</code></a> for more information.</p><p>Raises <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.AlreadySentError.html"><code class="inline">Plug.Conn.AlreadySentError</code></a> if <code class="inline">conn</code> is already sent.</p>
  </section>
</section>
<section class="detail" id="put_new_view/2">

  <div class="detail-header">
    <a href="#put_new_view/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">put_new_view(conn, formats)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L577" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> put_new_view(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), [{format :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="#t:view/0">view</a>()}] | <a href="#t:view/0">view</a>()) ::
  <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Stores the view for rendering if one was not stored yet.</p><p>Raises <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.AlreadySentError.html"><code class="inline">Plug.Conn.AlreadySentError</code></a> if <code class="inline">conn</code> is already sent.</p>
  </section>
</section>
<section class="detail" id="put_root_layout/2">

  <div class="detail-header">
    <a href="#put_root_layout/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">put_root_layout(conn, layout)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L758" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> put_root_layout(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), [{format :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="#t:layout/0">layout</a>()}] | false) ::
  <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Stores the root layout for rendering.</p><p>The layout must be given as keyword list where the key is the request
format the layout will be applied to (such as <code class="inline">:html</code>) and the value
is one of:</p><ul><li><p><code class="inline">{module, layout}</code> with the <code class="inline">module</code> the layout is defined and
the name of the <code class="inline">layout</code> as an atom</p></li><li><p><code class="inline">layout</code> when the name of the layout. This requires a layout for
the given format in the shape of <code class="inline">{module, layout}</code> to be previously
given</p></li><li><p><code class="inline">false</code> which disables the layout</p></li></ul><h2 id="put_root_layout/2-examples" class="section-heading">
  <a href="#put_root_layout/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">root_layout</samp><samp class="p" data-group-id="9658822063-1">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="9658822063-1">)</samp><samp class="w">
</samp><samp class="no">false</samp><samp class="w">

</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">put_root_layout</samp><samp class="p" data-group-id="9658822063-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">html</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="p" data-group-id="9658822063-3">{</samp><samp class="nc">AppView</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:root</samp><samp class="p" data-group-id="9658822063-3">}</samp><samp class="p" data-group-id="9658822063-2">)</samp><samp class="w">
</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">root_layout</samp><samp class="p" data-group-id="9658822063-4">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="9658822063-4">)</samp><samp class="w">
</samp><samp class="p" data-group-id="9658822063-5">{</samp><samp class="nc">AppView</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:root</samp><samp class="p" data-group-id="9658822063-5">}</samp><samp class="w">

</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">conn</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="n">put_root_layout</samp><samp class="p" data-group-id="9658822063-6">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">html</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="ss">:bare</samp><samp class="p" data-group-id="9658822063-6">)</samp><samp class="w">
</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">root_layout</samp><samp class="p" data-group-id="9658822063-7">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="9658822063-7">)</samp><samp class="w">
</samp><samp class="p" data-group-id="9658822063-8">{</samp><samp class="nc">AppView</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:bare</samp><samp class="p" data-group-id="9658822063-8">}</samp></code></pre><p>Raises <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.AlreadySentError.html"><code class="inline">Plug.Conn.AlreadySentError</code></a> if <code class="inline">conn</code> is already sent.</p>
  </section>
</section>
<section class="detail" id="put_router_url/2">

  <div class="detail-header">
    <a href="#put_router_url/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">put_router_url(conn, uri)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1123" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Puts the url string or <code class="inline">%URI{}</code> to be used for route generation.</p><p>This function overrides the default URL generation pulled
from the <code class="inline">%Plug.Conn{}</code>'s endpoint configuration.</p><h2 id="put_router_url/2-examples" class="section-heading">
  <a href="#put_router_url/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<p>Imagine your application is configured to run on &quot;example.com&quot;
but after the user signs in, you want all links to use
&quot;some_user.example.com&quot;. You can do so by setting the proper
router url configuration:</p><pre><code class="makeup elixir" translate="no"><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">put_router_url_by_user</samp><samp class="p" data-group-id="9083714510-1">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="9083714510-1">)</samp><samp class="w"> </samp><samp class="k" data-group-id="9083714510-2">do</samp><samp class="w">
  </samp><samp class="n">put_router_url</samp><samp class="p" data-group-id="9083714510-3">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">get_user_from_conn</samp><samp class="p" data-group-id="9083714510-4">(</samp><samp class="n">conn</samp><samp class="p" data-group-id="9083714510-4">)</samp><samp class="o">.</samp><samp class="n">account_name</samp><samp class="w"> </samp><samp class="o">&lt;&gt;</samp><samp class="w"> </samp><samp class="s">&quot;.example.com&quot;</samp><samp class="p" data-group-id="9083714510-3">)</samp><samp class="w">
</samp><samp class="k" data-group-id="9083714510-2">end</samp></code></pre><p>Now when you call <code class="inline">Routes.some_route_url(conn, ...)</code>, it will use
the router url set above. Keep in mind that, if you want to generate
routes to the <em>current</em> domain, it is preferred to use
<code class="inline">Routes.some_route_path</code> helpers, as those are always relative.</p>
  </section>
</section>
<section class="detail" id="put_secure_browser_headers/2">

    <span id="put_secure_browser_headers/1"></span>

  <div class="detail-header">
    <a href="#put_secure_browser_headers/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">put_secure_browser_headers(conn, headers \\ %{})</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1395" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Put headers that improve browser security.</p><p>It sets the following headers:</p><ul><li><code class="inline">referrer-policy</code> - only send origin on cross origin requests</li><li><code class="inline">x-frame-options</code> - set to SAMEORIGIN to avoid clickjacking
through iframes unless in the same origin</li><li><code class="inline">x-content-type-options</code> - set to nosniff. This requires
script and style tags to be sent with proper content type</li><li><code class="inline">x-download-options</code> - set to noopen to instruct the browser
not to open a download directly in the browser, to avoid
HTML files rendering inline and accessing the security
context of the application (like critical domain cookies)</li><li><code class="inline">x-permitted-cross-domain-policies</code> - set to none to restrict
Adobe Flash Players access to data</li></ul><p>A custom headers map may also be given to be merged with defaults.
It is recommended for custom header keys to be in lowercase, to avoid sending
duplicate keys in a request.
Additionally, responses with mixed-case headers served over HTTP/2 are not
considered valid by common clients, resulting in dropped responses.</p>
  </section>
</section>
<section class="detail" id="put_static_url/2">

  <div class="detail-header">
    <a href="#put_static_url/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">put_static_url(conn, uri)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1138" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Puts the URL or <code class="inline">%URI{}</code> to be used for the static url generation.</p><p>Using this function on a <code class="inline">%Plug.Conn{}</code> struct tells <code class="inline">static_url/2</code> to use
the given information for URL generation instead of the <code class="inline">%Plug.Conn{}</code>'s
endpoint configuration (much like <a href="#put_router_url/2"><code class="inline">put_router_url/2</code></a> but for static URLs).</p>
  </section>
</section>
<section class="detail" id="put_view/2">

  <div class="detail-header">
    <a href="#put_view/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">put_view(conn, formats)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L540" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> put_view(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), [{format :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="#t:view/0">view</a>()}] | <a href="#t:view/0">view</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Stores the view for rendering.</p><p>Raises <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.AlreadySentError.html"><code class="inline">Plug.Conn.AlreadySentError</code></a> if <code class="inline">conn</code> is already sent.</p><h2 id="put_view/2-examples" class="section-heading">
  <a href="#put_view/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="c1"># Use single view module</samp><samp class="w">
</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">put_view</samp><samp class="p" data-group-id="3097198882-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="nc">AppView</samp><samp class="p" data-group-id="3097198882-1">)</samp><samp class="w">

</samp><samp class="c1"># Use multiple view module for content negotiation</samp><samp class="w">
</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">put_view</samp><samp class="p" data-group-id="3097198882-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">html</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="nc">AppHTML</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">json</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="nc">AppJSON</samp><samp class="p" data-group-id="3097198882-2">)</samp></code></pre>
  </section>
</section>
<section class="detail" id="redirect/2">

  <div class="detail-header">
    <a href="#redirect/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">redirect(conn, opts)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L489" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Sends redirect response to the given url.</p><p>For security, <code class="inline">:to</code> only accepts paths. Use the <code class="inline">:external</code>
option to redirect to any URL.</p><p>The response will be sent with the status code defined within
the connection, via <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#put_status/2"><code class="inline">Plug.Conn.put_status/2</code></a>. If no status
code is set, a 302 response is sent.</p><h2 id="redirect/2-examples" class="section-heading">
  <a href="#redirect/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">redirect</samp><samp class="p" data-group-id="5005469113-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">to</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;/login&quot;</samp><samp class="p" data-group-id="5005469113-1">)</samp><samp class="w">

</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">redirect</samp><samp class="p" data-group-id="5005469113-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">external</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;https://elixir-lang.org&quot;</samp><samp class="p" data-group-id="5005469113-2">)</samp></code></pre>
  </section>
</section>
<section class="detail" id="render/2">

    <span id="render/1"></span>

  <div class="detail-header">
    <a href="#render/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">render(conn, template_or_assigns \\ [])</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L835" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> render(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Render the given template or the default template
specified by the current action with the given assigns.</p><p>See <a href="#render/3"><code class="inline">render/3</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="render/3">

  <div class="detail-header">
    <a href="#render/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">render(conn, template, assigns)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L937" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> render(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="https://hexdocs.pm/elixir/Keyword.html#t:t/0">Keyword.t</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Renders the given <code class="inline">template</code> and <code class="inline">assigns</code> based on the <code class="inline">conn</code> information.</p><p>Once the template is rendered, the template format is set as the response
content type (for example, an HTML template will set &quot;text/html&quot; as response
content type) and the data is sent to the client with default status of 200.</p><h2 id="render/3-arguments" class="section-heading">
  <a href="#render/3-arguments" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Arguments</span>
</h2>
<ul><li><p><code class="inline">conn</code> - the <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html"><code class="inline">Plug.Conn</code></a> struct</p></li><li><p><code class="inline">template</code> - which may be an atom or a string. If an atom, like <code class="inline">:index</code>,
it will render a template with the same format as the one returned by
<a href="#get_format/1"><code class="inline">get_format/1</code></a>. For example, for an HTML request, it will render
the &quot;index.html&quot; template. If the template is a string, it must contain
the extension too, like &quot;index.json&quot;</p></li><li><p><code class="inline">assigns</code> - a dictionary with the assigns to be used in the view. Those
assigns are merged and have higher precedence than the connection assigns
(<code class="inline">conn.assigns</code>)</p></li></ul><h2 id="render/3-examples" class="section-heading">
  <a href="#render/3-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="kd">defmodule</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.UserController</samp><samp class="w"> </samp><samp class="k" data-group-id="1105399850-1">do</samp><samp class="w">
  </samp><samp class="kn">use</samp><samp class="w"> </samp><samp class="nc">Phoenix.Controller</samp><samp class="w">

  </samp><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">show</samp><samp class="p" data-group-id="1105399850-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="c">_params</samp><samp class="p" data-group-id="1105399850-2">)</samp><samp class="w"> </samp><samp class="k" data-group-id="1105399850-3">do</samp><samp class="w">
    </samp><samp class="n">render</samp><samp class="p" data-group-id="1105399850-4">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;show.html&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">message</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;Hello&quot;</samp><samp class="p" data-group-id="1105399850-4">)</samp><samp class="w">
  </samp><samp class="k" data-group-id="1105399850-3">end</samp><samp class="w">
</samp><samp class="k" data-group-id="1105399850-1">end</samp></code></pre><p>The example above renders a template &quot;show.html&quot; from the <code class="inline">MyAppWeb.UserView</code>
and sets the response content type to &quot;text/html&quot;.</p><p>In many cases, you may want the template format to be set dynamically based
on the request. To do so, you can pass the template name as an atom (without
the extension):</p><pre><code class="makeup elixir" translate="no"><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">show</samp><samp class="p" data-group-id="5767469579-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="c">_params</samp><samp class="p" data-group-id="5767469579-1">)</samp><samp class="w"> </samp><samp class="k" data-group-id="5767469579-2">do</samp><samp class="w">
  </samp><samp class="n">render</samp><samp class="p" data-group-id="5767469579-3">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:show</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">message</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;Hello&quot;</samp><samp class="p" data-group-id="5767469579-3">)</samp><samp class="w">
</samp><samp class="k" data-group-id="5767469579-2">end</samp></code></pre><p>In order for the example above to work, we need to do content negotiation with
the accepts plug before rendering. You can do so by adding the following to your
pipeline (in the router):</p><pre><code class="makeup elixir" translate="no"><samp class="n">plug</samp><samp class="w"> </samp><samp class="ss">:accepts</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="5436454848-1">[</samp><samp class="s">&quot;html&quot;</samp><samp class="p" data-group-id="5436454848-1">]</samp></code></pre><h2 id="render/3-views" class="section-heading">
  <a href="#render/3-views" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Views</span>
</h2>
<p>By default, Controllers render templates in a view with a similar name to the
controller. For example, <code class="inline">MyAppWeb.UserController</code> will render templates inside
the <code class="inline">MyAppWeb.UserView</code>. This information can be changed any time by using the
<a href="#put_view/2"><code class="inline">put_view/2</code></a> function:</p><pre><code class="makeup elixir" translate="no"><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">show</samp><samp class="p" data-group-id="6680070277-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="c">_params</samp><samp class="p" data-group-id="6680070277-1">)</samp><samp class="w"> </samp><samp class="k" data-group-id="6680070277-2">do</samp><samp class="w">
  </samp><samp class="n">conn</samp><samp class="w">
  </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">put_view</samp><samp class="p" data-group-id="6680070277-3">(</samp><samp class="nc">MyAppWeb.SpecialView</samp><samp class="p" data-group-id="6680070277-3">)</samp><samp class="w">
  </samp><samp class="o">|&gt;</samp><samp class="w"> </samp><samp class="n">render</samp><samp class="p" data-group-id="6680070277-4">(</samp><samp class="ss">:show</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">message</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;Hello&quot;</samp><samp class="p" data-group-id="6680070277-4">)</samp><samp class="w">
</samp><samp class="k" data-group-id="6680070277-2">end</samp></code></pre><p><a href="#put_view/2"><code class="inline">put_view/2</code></a> can also be used as a plug:</p><pre><code class="makeup elixir" translate="no"><samp class="kd">defmodule</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.UserController</samp><samp class="w"> </samp><samp class="k" data-group-id="1438273077-1">do</samp><samp class="w">
  </samp><samp class="kn">use</samp><samp class="w"> </samp><samp class="nc">Phoenix.Controller</samp><samp class="w">

  </samp><samp class="n">plug</samp><samp class="w"> </samp><samp class="ss">:put_view</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">html</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.SpecialView</samp><samp class="w">

  </samp><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">show</samp><samp class="p" data-group-id="1438273077-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="c">_params</samp><samp class="p" data-group-id="1438273077-2">)</samp><samp class="w"> </samp><samp class="k" data-group-id="1438273077-3">do</samp><samp class="w">
    </samp><samp class="n">render</samp><samp class="p" data-group-id="1438273077-4">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:show</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">message</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;Hello&quot;</samp><samp class="p" data-group-id="1438273077-4">)</samp><samp class="w">
  </samp><samp class="k" data-group-id="1438273077-3">end</samp><samp class="w">
</samp><samp class="k" data-group-id="1438273077-1">end</samp></code></pre><h2 id="render/3-layouts" class="section-heading">
  <a href="#render/3-layouts" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Layouts</span>
</h2>
<p>Templates are often rendered inside layouts. By default, Phoenix
will render layouts for html requests. For example:</p><pre><code class="makeup elixir" translate="no"><samp class="kd">defmodule</samp><samp class="w"> </samp><samp class="nc">MyAppWeb.UserController</samp><samp class="w"> </samp><samp class="k" data-group-id="8716742884-1">do</samp><samp class="w">
  </samp><samp class="kn">use</samp><samp class="w"> </samp><samp class="nc">Phoenix.Controller</samp><samp class="w">

  </samp><samp class="kd">def</samp><samp class="w"> </samp><samp class="nf">show</samp><samp class="p" data-group-id="8716742884-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="c">_params</samp><samp class="p" data-group-id="8716742884-2">)</samp><samp class="w"> </samp><samp class="k" data-group-id="8716742884-3">do</samp><samp class="w">
    </samp><samp class="n">render</samp><samp class="p" data-group-id="8716742884-4">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;show.html&quot;</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">message</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;Hello&quot;</samp><samp class="p" data-group-id="8716742884-4">)</samp><samp class="w">
  </samp><samp class="k" data-group-id="8716742884-3">end</samp><samp class="w">
</samp><samp class="k" data-group-id="8716742884-1">end</samp></code></pre><p>will render the  &quot;show.html&quot; template inside an &quot;app.html&quot;
template specified in <code class="inline">MyAppWeb.LayoutView</code>. <a href="#put_layout/2"><code class="inline">put_layout/2</code></a> can be used
to change the layout, similar to how <a href="#put_view/2"><code class="inline">put_view/2</code></a> can be used to change
the view.</p>
  </section>
</section>
<section class="detail" id="root_layout/2">

    <span id="root_layout/1"></span>

  <div class="detail-header">
    <a href="#root_layout/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">root_layout(conn, format \\ nil)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L814" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> root_layout(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>() | nil) ::
  {<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()} | false</pre>

      </div>

<p>Retrieves the current root layout for the given format.</p><p>If no format is given, takes the current one from the connection.</p>
  </section>
</section>
<section class="detail" id="router_module/1">

  <div class="detail-header">
    <a href="#router_module/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">router_module(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L334" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> router_module(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()</pre>

      </div>

<p>Returns the router module as an atom, raises if unavailable.</p>
  </section>
</section>
<section class="detail" id="scrub_params/2">

  <div class="detail-header">
    <a href="#scrub_params/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">scrub_params(conn, required_key)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1326" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> scrub_params(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Scrubs the parameters from the request.</p><p>This process is two-fold:</p><ul><li>Checks to see if the <code class="inline">required_key</code> is present</li><li>Changes empty parameters of <code class="inline">required_key</code> (recursively) to nils</li></ul><p>This function is useful for removing empty strings sent
via HTML forms. If you are providing an API, there
is likely no need to invoke <a href="#scrub_params/2"><code class="inline">scrub_params/2</code></a>.</p><p>If the <code class="inline">required_key</code> is not present, it will
raise <a href="Phoenix.MissingParamError.xhtml"><code class="inline">Phoenix.MissingParamError</code></a>.</p><h2 id="scrub_params/2-examples" class="section-heading">
  <a href="#scrub_params/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">scrub_params</samp><samp class="p" data-group-id="1669362997-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;user&quot;</samp><samp class="p" data-group-id="1669362997-1">)</samp></code></pre>
  </section>
</section>
<section class="detail" id="send_download/3">

    <span id="send_download/2"></span>

  <div class="detail-header">
    <a href="#send_download/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">send_download(conn, kind, opts \\ [])</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1235" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Sends the given file or binary as a download.</p><p>The second argument must be <code class="inline">{:binary, contents}</code>, where
<code class="inline">contents</code> will be sent as download, or<code class="inline">{:file, path}</code>,
where <code class="inline">path</code> is the filesystem location of the file to
be sent. Be careful to not interpolate the path from
external parameters, as it could allow traversal of the
filesystem.</p><p>The download is achieved by setting &quot;content-disposition&quot;
to attachment. The &quot;content-type&quot; will also be set based
on the extension of the given filename but can be customized
via the <code class="inline">:content_type</code> and <code class="inline">:charset</code> options.</p><h2 id="send_download/3-options" class="section-heading">
  <a href="#send_download/3-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Options</span>
</h2>
<ul><li><code class="inline">:filename</code> - the filename to be presented to the user
as download</li><li><code class="inline">:content_type</code> - the content type of the file or binary
sent as download. It is automatically inferred from the
filename extension</li><li><code class="inline">:disposition</code> - specifies disposition type
(<code class="inline">:attachment</code> or <code class="inline">:inline</code>). If <code class="inline">:attachment</code> was used,
user will be prompted to save the file. If <code class="inline">:inline</code> was used,
the browser will attempt to open the file.
Defaults to <code class="inline">:attachment</code>.</li><li><code class="inline">:charset</code> - the charset of the file, such as &quot;utf-8&quot;.
Defaults to none</li><li><code class="inline">:offset</code> - the bytes to offset when reading. Defaults to <code class="inline">0</code></li><li><code class="inline">:length</code> - the total bytes to read. Defaults to <code class="inline">:all</code></li><li><code class="inline">:encode</code> - encodes the filename using <a href="https://hexdocs.pm/elixir/URI.html#encode/2"><code class="inline">URI.encode/2</code></a>.
Defaults to <code class="inline">true</code>. When <code class="inline">false</code>, disables encoding. If you
disable encoding, you need to guarantee there are no special
characters in the filename, such as quotes, newlines, etc.
Otherwise you can expose your application to security attacks</li></ul><h2 id="send_download/3-examples" class="section-heading">
  <a href="#send_download/3-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<p>To send a file that is stored inside your application priv
directory:</p><pre><code class="makeup elixir" translate="no"><samp class="n">path</samp><samp class="w"> </samp><samp class="o">=</samp><samp class="w"> </samp><samp class="nc">Application</samp><samp class="o">.</samp><samp class="n">app_dir</samp><samp class="p" data-group-id="9790984612-1">(</samp><samp class="ss">:my_app</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;priv/prospectus.pdf&quot;</samp><samp class="p" data-group-id="9790984612-1">)</samp><samp class="w">
</samp><samp class="n">send_download</samp><samp class="p" data-group-id="9790984612-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="9790984612-3">{</samp><samp class="ss">:file</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="n">path</samp><samp class="p" data-group-id="9790984612-3">}</samp><samp class="p" data-group-id="9790984612-2">)</samp></code></pre><p>When using <code class="inline">{:file, path}</code>, the filename is inferred from the
given path but may also be set explicitly.</p><p>To allow the user to download contents that are in memory as
a binary or string:</p><pre><code class="makeup elixir" translate="no"><samp class="n">send_download</samp><samp class="p" data-group-id="7736501529-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="p" data-group-id="7736501529-2">{</samp><samp class="ss">:binary</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;world&quot;</samp><samp class="p" data-group-id="7736501529-2">}</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">filename</samp><samp class="p">:</samp><samp class="w"> </samp><samp class="s">&quot;hello.txt&quot;</samp><samp class="p" data-group-id="7736501529-1">)</samp></code></pre><p>See <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#send_file/3"><code class="inline">Plug.Conn.send_file/3</code></a> and <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#send_resp/3"><code class="inline">Plug.Conn.send_resp/3</code></a> if you
would like to access the low-level functions used to send files
and responses via Plug.</p>
  </section>
</section>
<section class="detail" id="status_message_from_template/1">

  <div class="detail-header">
    <a href="#status_message_from_template/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">status_message_from_template(template)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L1736" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Generates a status message from the template name.</p><h2 id="status_message_from_template/1-examples" class="section-heading">
  <a href="#status_message_from_template/1-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">status_message_from_template</samp><samp class="p" data-group-id="1390442177-1">(</samp><samp class="s">&quot;404.html&quot;</samp><samp class="p" data-group-id="1390442177-1">)</samp><samp class="w">
</samp><samp class="s">&quot;Not Found&quot;</samp><samp class="w">
</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">status_message_from_template</samp><samp class="p" data-group-id="1390442177-2">(</samp><samp class="s">&quot;whatever.html&quot;</samp><samp class="p" data-group-id="1390442177-2">)</samp><samp class="w">
</samp><samp class="s">&quot;Internal Server Error&quot;</samp></code></pre>
  </section>
</section>
<section class="detail" id="text/2">

  <div class="detail-header">
    <a href="#text/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">text(conn, data)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L455" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> text(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/String.Chars.html#t:t/0">String.Chars.t</a>()) :: <a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>

      </div>

<p>Sends text response.</p><h2 id="text/2-examples" class="section-heading">
  <a href="#text/2-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<pre><code class="makeup elixir" translate="no"><samp class="gp unselectable">iex&gt; </samp><samp class="n">text</samp><samp class="p" data-group-id="2532473432-1">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="s">&quot;hello&quot;</samp><samp class="p" data-group-id="2532473432-1">)</samp><samp class="w">

</samp><samp class="gp unselectable">iex&gt; </samp><samp class="n">text</samp><samp class="p" data-group-id="2532473432-2">(</samp><samp class="n">conn</samp><samp class="p">,</samp><samp class="w"> </samp><samp class="ss">:implements_to_string</samp><samp class="p" data-group-id="2532473432-2">)</samp></code></pre>
  </section>
</section>
<section class="detail" id="view_module/2">

    <span id="view_module/1"></span>

  <div class="detail-header">
    <a href="#view_module/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">view_module(conn, format \\ nil)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L589" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> view_module(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>() | nil) :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()</pre>

      </div>

<p>Retrieves the current view for the given format.</p><p>If no format is given, takes the current one from the connection.</p>
  </section>
</section>
<section class="detail" id="view_template/1">

  <div class="detail-header">
    <a href="#view_template/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">view_template(conn)</h1>


        <a href="https://github.com/phoenixframework/phoenix/blob/v1.7.21/lib/phoenix/controller.ex#L347" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> view_template(<a href="https://hexdocs.pm/plug/1.15.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>() | nil</pre>

      </div>

<p>Returns the template name rendered in the view as a string
(or nil if no template was rendered).</p>
  </section>
</section>

        </div>
      </section>


  </body>
</html>
